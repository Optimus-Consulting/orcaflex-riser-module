"use strict";(self.webpackChunkorcaflex_riser_module=self.webpackChunkorcaflex_riser_module||[]).push([[858],{19(e,n,t){t.d(n,{o:()=>o});var s=t(5726),i=t(2945);function o(e={}){const{size:n=2e3,opacity:t=.6}=e,o=new s.PlaneGeometry(n,n,32,32),a=new s.MeshPhongMaterial({color:i.lm.water,transparent:!0,opacity:t,side:s.DoubleSide,shininess:100,specular:1118481}),r=new s.Mesh(o,a);return r.position.set(0,0,0),r.receiveShadow=!0,r.userData={type:"waterSurface",name:"Sea Surface"},r}},295(e,n,t){t.d(n,{C:()=>a});var s=t(4087),i=t(5008),o=t(6673);let a=class{httpClient=(0,s.inject)(i.Qq);externalApiService=null;setApiService(e){this.externalApiService=e}async calculateCatenary(e){return this.post("/api/orcaflex/calculate/catenary",e)}async calculateLazyWave(e){return this.post("/api/orcaflex/calculate/lazy-wave",e)}async parseYaml(e){return this.post("/api/orcaflex/parse",{content:e})}async parseVesselFromYaml(e){const n=e instanceof File?await e.text():e;return this.post("/api/orcaflex/parse-vessel",{content:n})}async generateYaml(e){return this.post("/api/orcaflex/generate",e)}async downloadYaml(e){return this.externalApiService?this.externalApiService.post("/api/orcaflex/generate/download",e,{responseType:"blob"}):(0,o.firstValueFrom)(this.httpClient.post("/api/orcaflex/generate/download",e,{responseType:"blob"}))}async validateModel(e){return this.post("/api/orcaflex/validate",{model:e})}async post(e,n){return this.externalApiService?await this.externalApiService.post(e,n):(0,o.firstValueFrom)(this.httpClient.post(e,n))}};a=function(e,n,t,s){var i,o=arguments.length,a=o<3?n:null===s?s=Object.getOwnPropertyDescriptor(n,t):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,n,t,s);else for(var r=e.length-1;r>=0;r--)(i=e[r])&&(a=(o<3?i(a):o>3?i(n,t,a):i(n,t))||a);return o>3&&a&&Object.defineProperty(n,t,a),a}([(0,s.Injectable)({providedIn:"root"})],a)},303(e,n,t){t.d(n,{Y:()=>c});var s=t(4087),i=t(7493),o=t(1795),a=t(3413),r=t(3574),l=t(8992),d=t(1008);let c=class{modelState=(0,s.inject)(a.W);lineTypes=this.modelState.lineTypes;buoyancyModules=this.modelState.buoyancyModules;selectedLineTypeId=(0,s.signal)(null);selectedBuoyancyId=(0,s.signal)(null);addingLineType=(0,s.signal)(!1);addingBuoyancy=(0,s.signal)(!1);newLineType=this.getDefaultNewLineType();newLineTypeODmm=355.6;newLineTypeIDmm=254;newBuoyancy=this.getDefaultNewBuoyancy();newBuoyancyODmm=1450;newBuoyancyLengthmm=1600;showLineTypesImportDialog=!1;showBuoyancyImportDialog=!1;formatDiameter(e){const n=39.37*e;return`${(1e3*e).toFixed(1)}mm (${n.toFixed(1)}")`}getWetMass(e){const n=this.modelState.environment().sea.waterDensity;return Math.round(100*(0,r.Ny)(e,n))/100}getPipeDensity(e){return Math.round((0,r.H5)(e))}selectLineType(e){this.selectedLineTypeId.set(this.selectedLineTypeId()===e?null:e),this.selectedBuoyancyId.set(null)}selectBuoyancy(e){this.selectedBuoyancyId.set(this.selectedBuoyancyId()===e?null:e),this.selectedLineTypeId.set(null)}updateLineType(e,n,t){this.modelState.updateLineType({...e,[n]:t})}updateDryMass(e,n){this.modelState.updateLineType({...e,dryMass:n})}updateWetMass(e,n){const t=this.modelState.environment().sea.waterDensity,s=(0,r.aW)(n,e.outerDiameter,t);this.modelState.updateLineType({...e,dryMass:s})}updatePipeDensity(e,n){const t=(0,r.od)(n,e.outerDiameter,e.innerDiameter);this.modelState.updateLineType({...e,dryMass:t,pipeDensity:n})}updateDragCoeff(e,n,t){this.modelState.updateLineType({...e,dragCoefficients:{...e.dragCoefficients,[n]:t}})}deleteLineType(e){this.modelState.deleteLineType(e)}startAddLineType(){this.addingLineType.set(!0),this.newLineType=this.getDefaultNewLineType(),this.newLineTypeODmm=355.6,this.newLineTypeIDmm=254}saveNewLineType(){if(!this.newLineType.name)return;const e={id:crypto.randomUUID(),name:this.newLineType.name||"New Line Type",outerDiameter:this.newLineTypeODmm/1e3,innerDiameter:this.newLineTypeIDmm/1e3,dryMass:this.newLineType.dryMass||184.23,bendingStiffness:124.87,axialStiffness:711200,torsionalStiffness:10,poissonRatio:.5,allowableTension:5e3,minBendRadius:3.675,dragCoefficients:{normal:1.2,axial:.008},addedMassCoefficients:{normal:1,axial:0}};this.modelState.addLineType(e),this.addingLineType.set(!1)}cancelAddLineType(){this.addingLineType.set(!1)}updateBuoyancy(e,n,t){this.modelState.updateBuoyancyModule({...e,[n]:t})}deleteBuoyancy(e){this.modelState.deleteBuoyancyModule(e)}getModuleBuoyancy(e){return Math.round((0,r.bl)(e))}getSectionLength(e){return Math.round(10*(0,r.MB)(e))/10}getBuoyancyPerMeter(e){return Math.round((0,r.hY)(e))}startAddBuoyancy(){this.addingBuoyancy.set(!0),this.newBuoyancy=this.getDefaultNewBuoyancy(),this.newBuoyancyODmm=1450,this.newBuoyancyLengthmm=1600}saveNewBuoyancy(){if(!this.newBuoyancy.name)return;const e={id:crypto.randomUUID(),name:this.newBuoyancy.name||"New Buoyancy",outerDiameter:this.newBuoyancyODmm/1e3,length:this.newBuoyancyLengthmm/1e3,dryMass:855.7,apparentMassInWater:-1220,dragCoefficient:.8,numberOfModules:this.newBuoyancy.numberOfModules||6,spacing:this.newBuoyancy.spacing||12};this.modelState.addBuoyancyModule(e),this.addingBuoyancy.set(!1)}cancelAddBuoyancy(){this.addingBuoyancy.set(!1)}getDefaultNewLineType(){return{name:"",outerDiameter:.3556,innerDiameter:.254,dryMass:184.23}}getDefaultNewBuoyancy(){return{name:"",outerDiameter:1.45,length:1.6,numberOfModules:6,spacing:12}}handleLineTypesImport(e){for(const n of e)this.modelState.addLineType(n);this.modelState.addLog("success",`Imported ${e.length} line type(s)`)}handleBuoyancyModulesImport(e){for(const n of e)this.modelState.addBuoyancyModule(n);this.modelState.addLog("success",`Imported ${e.length} buoyancy module(s)`)}};c=function(e,n,t,s){var i,o=arguments.length,a=o<3?n:null===s?s=Object.getOwnPropertyDescriptor(n,t):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,n,t,s);else for(var r=e.length-1;r>=0;r--)(i=e[r])&&(a=(o<3?i(a):o>3?i(n,t,a):i(n,t))||a);return o>3&&a&&Object.defineProperty(n,t,a),a}([(0,s.Component)({selector:"orcaflex-line-types-section",standalone:!0,imports:[i.CommonModule,o.FormsModule,l.c,d.Y],template:'\n    <div class="section-content">\n      \x3c!-- Line Types --\x3e\n      <div class="subsection-header">\n        <span>Line Types</span>\n        <div class="header-actions">\n          <button class="import-btn" (click)="showLineTypesImportDialog = true" title="Import from Excel">Import</button>\n          <button class="add-btn" (click)="startAddLineType()">+</button>\n        </div>\n      </div>\n\n      @for (lineType of lineTypes(); track lineType.id) {\n        <div\n          class="line-type-item"\n          [class.selected]="selectedLineTypeId() === lineType.id"\n        >\n          <div class="line-type-header" (click)="selectLineType(lineType.id)">\n            <span class="line-type-name">{{ lineType.name }}</span>\n            <button class="delete-btn" (click)="deleteLineType(lineType.id); $event.stopPropagation()">×</button>\n          </div>\n          <div class="line-type-summary">\n            OD: {{ formatDiameter(lineType.outerDiameter) }} | Dry Mass: {{ lineType.dryMass.toFixed(1) }} kg/m\n          </div>\n\n          @if (selectedLineTypeId() === lineType.id) {\n            <div class="line-type-editor" (click)="$event.stopPropagation()">\n              <div class="form-group">\n                <label>Name</label>\n                <input type="text" [ngModel]="lineType.name"\n                  (ngModelChange)="updateLineType(lineType, \'name\', $event)" />\n              </div>\n\n              \x3c!-- Geometry --\x3e\n              <div class="section-title">Geometry</div>\n              <div class="form-row">\n                <div class="form-group half">\n                  <label>Outer Diameter (mm)</label>\n                  <input type="number" [ngModel]="lineType.outerDiameter * 1000"\n                    (ngModelChange)="updateLineType(lineType, \'outerDiameter\', $event / 1000)" step="0.1" />\n                </div>\n                <div class="form-group half">\n                  <label>Inner Diameter (mm)</label>\n                  <input type="number" [ngModel]="lineType.innerDiameter * 1000"\n                    (ngModelChange)="updateLineType(lineType, \'innerDiameter\', $event / 1000)" step="0.1" />\n                </div>\n              </div>\n\n              \x3c!-- Mass Properties --\x3e\n              <div class="section-title">Mass Properties</div>\n              <div class="form-row">\n                <div class="form-group half">\n                  <label>Dry Mass (kg/m)</label>\n                  <input type="number" [ngModel]="lineType.dryMass"\n                    (ngModelChange)="updateDryMass(lineType, $event)" step="0.1" />\n                </div>\n                <div class="form-group half">\n                  <label>Wet Mass (kg/m)</label>\n                  <input type="number" [ngModel]="getWetMass(lineType)"\n                    (ngModelChange)="updateWetMass(lineType, $event)" step="0.1" />\n                </div>\n              </div>\n              <div class="form-group">\n                <label>Pipe Density (kg/m³)</label>\n                <input type="number" [ngModel]="getPipeDensity(lineType)"\n                  (ngModelChange)="updatePipeDensity(lineType, $event)" step="1"\n                  class="calculated-input" />\n                <span class="calc-hint">Auto-calculated from mass & geometry</span>\n              </div>\n\n              \x3c!-- Stiffness Properties --\x3e\n              <div class="section-title">Stiffness Properties</div>\n              <div class="form-row">\n                <div class="form-group half">\n                  <label>Bending EI (kN·m²)</label>\n                  <input type="number" [ngModel]="lineType.bendingStiffness"\n                    (ngModelChange)="updateLineType(lineType, \'bendingStiffness\', $event)" step="0.1" />\n                </div>\n                <div class="form-group half">\n                  <label>Axial EA (kN)</label>\n                  <input type="number" [ngModel]="lineType.axialStiffness"\n                    (ngModelChange)="updateLineType(lineType, \'axialStiffness\', $event)" step="100" />\n                </div>\n              </div>\n              <div class="form-row">\n                <div class="form-group half">\n                  <label>Torsional GJ (kN·m²)</label>\n                  <input type="number" [ngModel]="lineType.torsionalStiffness ?? 10"\n                    (ngModelChange)="updateLineType(lineType, \'torsionalStiffness\', $event)" step="0.1" />\n                </div>\n                <div class="form-group half">\n                  <label>Poisson Ratio</label>\n                  <input type="number" [ngModel]="lineType.poissonRatio ?? 0.5"\n                    (ngModelChange)="updateLineType(lineType, \'poissonRatio\', $event)" step="0.01" min="0" max="0.5" />\n                </div>\n              </div>\n\n              \x3c!-- Limits --\x3e\n              <div class="section-title">Limits</div>\n              <div class="form-row">\n                <div class="form-group half">\n                  <label>Allowable Tension (kN)</label>\n                  <input type="number" [ngModel]="lineType.allowableTension ?? 5000"\n                    (ngModelChange)="updateLineType(lineType, \'allowableTension\', $event)" step="100" />\n                </div>\n                <div class="form-group half">\n                  <label>Min Bend Radius (m)</label>\n                  <input type="number" [ngModel]="lineType.minBendRadius ?? 3"\n                    (ngModelChange)="updateLineType(lineType, \'minBendRadius\', $event)" step="0.1" />\n                </div>\n              </div>\n\n              \x3c!-- Coefficients --\x3e\n              <div class="section-title">Drag Coefficients</div>\n              <div class="form-row">\n                <div class="form-group half">\n                  <label>Normal</label>\n                  <input type="number" [ngModel]="lineType.dragCoefficients.normal"\n                    (ngModelChange)="updateDragCoeff(lineType, \'normal\', $event)" step="0.1" />\n                </div>\n                <div class="form-group half">\n                  <label>Axial</label>\n                  <input type="number" [ngModel]="lineType.dragCoefficients.axial"\n                    (ngModelChange)="updateDragCoeff(lineType, \'axial\', $event)" step="0.001" />\n                </div>\n              </div>\n            </div>\n          }\n        </div>\n      }\n\n      @if (addingLineType()) {\n        <div class="line-type-item new-item">\n          <div class="line-type-editor">\n            <div class="form-group">\n              <label>Name</label>\n              <input type="text" [(ngModel)]="newLineType.name" placeholder="Line type name" />\n            </div>\n            <div class="form-row">\n              <div class="form-group half">\n                <label>OD (mm)</label>\n                <input type="number" [(ngModel)]="newLineTypeODmm" step="0.1" />\n              </div>\n              <div class="form-group half">\n                <label>ID (mm)</label>\n                <input type="number" [(ngModel)]="newLineTypeIDmm" step="0.1" />\n              </div>\n            </div>\n            <div class="form-group">\n              <label>Dry Mass (kg/m)</label>\n              <input type="number" [(ngModel)]="newLineType.dryMass" step="0.1" />\n            </div>\n            <div class="action-buttons">\n              <button class="btn save" (click)="saveNewLineType()">Add</button>\n              <button class="btn cancel" (click)="cancelAddLineType()">Cancel</button>\n            </div>\n          </div>\n        </div>\n      }\n\n      \x3c!-- Buoyancy Modules --\x3e\n      <div class="subsection-header buoyancy">\n        <span>Buoyancy Modules</span>\n        <div class="header-actions">\n          <button class="import-btn" (click)="showBuoyancyImportDialog = true" title="Import from Excel">Import</button>\n          <button class="add-btn" (click)="startAddBuoyancy()">+</button>\n        </div>\n      </div>\n\n      @for (buoyancy of buoyancyModules(); track buoyancy.id) {\n        <div\n          class="buoyancy-item"\n          [class.selected]="selectedBuoyancyId() === buoyancy.id"\n        >\n          <div class="buoyancy-header" (click)="selectBuoyancy(buoyancy.id)">\n            <span class="buoyancy-name">{{ buoyancy.name }}</span>\n            <button class="delete-btn small" (click)="deleteBuoyancy(buoyancy.id); $event.stopPropagation()">×</button>\n          </div>\n          <div class="buoyancy-summary">\n            {{ buoyancy.numberOfModules }}x {{ (buoyancy.length * 1000).toFixed(0) }}mm @ {{ buoyancy.spacing }}m\n          </div>\n\n          @if (selectedBuoyancyId() === buoyancy.id) {\n            <div class="buoyancy-editor" (click)="$event.stopPropagation()">\n              <div class="form-group">\n                <label>Name</label>\n                <input type="text" [ngModel]="buoyancy.name"\n                  (ngModelChange)="updateBuoyancy(buoyancy, \'name\', $event)" />\n              </div>\n\n              <div class="section-title">Module Dimensions</div>\n              <div class="form-row">\n                <div class="form-group half">\n                  <label>OD (mm)</label>\n                  <input type="number" [ngModel]="buoyancy.outerDiameter * 1000"\n                    (ngModelChange)="updateBuoyancy(buoyancy, \'outerDiameter\', $event / 1000)" step="1" />\n                </div>\n                <div class="form-group half">\n                  <label>Length (mm)</label>\n                  <input type="number" [ngModel]="buoyancy.length * 1000"\n                    (ngModelChange)="updateBuoyancy(buoyancy, \'length\', $event / 1000)" step="10" />\n                </div>\n              </div>\n\n              <div class="section-title">Mass Properties (per module)</div>\n              <div class="form-row">\n                <div class="form-group half">\n                  <label>Mass in Air (kg)</label>\n                  <input type="number" [ngModel]="buoyancy.dryMass"\n                    (ngModelChange)="updateBuoyancy(buoyancy, \'dryMass\', $event)" step="0.1" />\n                </div>\n                <div class="form-group half">\n                  <label>Apparent Mass in Water (kg)</label>\n                  <input type="number" [ngModel]="buoyancy.apparentMassInWater"\n                    (ngModelChange)="updateBuoyancy(buoyancy, \'apparentMassInWater\', $event)" step="1" />\n                </div>\n              </div>\n              <div class="form-group">\n                <label>Net Buoyancy (N/module)</label>\n                <input type="number" [value]="getModuleBuoyancy(buoyancy)" disabled class="calculated-input" />\n                <span class="calc-hint">Calculated from apparent mass</span>\n              </div>\n\n              <div class="section-title">Installation</div>\n              <div class="form-row">\n                <div class="form-group half">\n                  <label>Number of Modules</label>\n                  <input type="number" [ngModel]="buoyancy.numberOfModules"\n                    (ngModelChange)="updateBuoyancy(buoyancy, \'numberOfModules\', $event)" min="1" step="1" />\n                </div>\n                <div class="form-group half">\n                  <label>Spacing (m)</label>\n                  <input type="number" [ngModel]="buoyancy.spacing"\n                    (ngModelChange)="updateBuoyancy(buoyancy, \'spacing\', $event)" step="0.5" min="0" />\n                </div>\n              </div>\n              <div class="form-row">\n                <div class="form-group half">\n                  <label>Section Length (m)</label>\n                  <input type="number" [value]="getSectionLength(buoyancy)" disabled class="calculated-input" />\n                </div>\n                <div class="form-group half">\n                  <label>Buoyancy/m (N/m)</label>\n                  <input type="number" [value]="getBuoyancyPerMeter(buoyancy)" disabled class="calculated-input" />\n                </div>\n              </div>\n            </div>\n          }\n        </div>\n      }\n\n      @if (addingBuoyancy()) {\n        <div class="buoyancy-item new-item">\n          <div class="buoyancy-editor">\n            <div class="form-group">\n              <label>Name</label>\n              <input type="text" [(ngModel)]="newBuoyancy.name" placeholder="Module name" />\n            </div>\n            <div class="form-row">\n              <div class="form-group half">\n                <label>OD (mm)</label>\n                <input type="number" [(ngModel)]="newBuoyancyODmm" step="1" />\n              </div>\n              <div class="form-group half">\n                <label>Length (mm)</label>\n                <input type="number" [(ngModel)]="newBuoyancyLengthmm" step="10" />\n              </div>\n            </div>\n            <div class="form-row">\n              <div class="form-group half">\n                <label>Number of Modules</label>\n                <input type="number" [(ngModel)]="newBuoyancy.numberOfModules" min="1" step="1" />\n              </div>\n              <div class="form-group half">\n                <label>Spacing (m)</label>\n                <input type="number" [(ngModel)]="newBuoyancy.spacing" step="0.5" />\n              </div>\n            </div>\n            <div class="action-buttons">\n              <button class="btn save" (click)="saveNewBuoyancy()">Add</button>\n              <button class="btn cancel" (click)="cancelAddBuoyancy()">Cancel</button>\n            </div>\n          </div>\n        </div>\n      }\n\n      \x3c!-- Import Dialogs --\x3e\n      <orcaflex-line-types-import-dialog\n        [(visible)]="showLineTypesImportDialog"\n        (import)="handleLineTypesImport($event)"\n      />\n      <orcaflex-buoyancy-modules-import-dialog\n        [(visible)]="showBuoyancyImportDialog"\n        (import)="handleBuoyancyModulesImport($event)"\n      />\n    </div>\n  ',styles:["\n    .section-content {\n      padding: 0;\n    }\n\n    .subsection-header {\n      display: flex;\n      justify-content: space-between;\n      align-items: center;\n      padding: 8px 12px;\n      background: var(--caris-bg-subtle, #f5f5f5);\n      border-bottom: 1px solid var(--caris-border-light, #eee);\n      font-size: 10px;\n      font-weight: 600;\n      text-transform: uppercase;\n      color: var(--caris-text-secondary, #666);\n    }\n\n    .subsection-header.buoyancy {\n      margin-top: 8px;\n    }\n\n    .header-actions {\n      display: flex;\n      gap: 4px;\n      align-items: center;\n    }\n\n    .import-btn {\n      padding: 2px 6px;\n      border: 1px solid var(--caris-primary, #1976d2);\n      border-radius: 3px;\n      background: transparent;\n      color: var(--caris-primary, #1976d2);\n      font-size: 9px;\n      cursor: pointer;\n      text-transform: none;\n      font-weight: 500;\n    }\n\n    .import-btn:hover {\n      background: var(--caris-primary, #1976d2);\n      color: white;\n    }\n\n    .section-title {\n      font-size: 10px;\n      font-weight: 600;\n      text-transform: uppercase;\n      color: var(--caris-text-secondary, #666);\n      margin: 12px 0 8px;\n      padding-top: 8px;\n      border-top: 1px solid var(--caris-border-light, #eee);\n    }\n\n    .section-title:first-of-type {\n      margin-top: 8px;\n      padding-top: 0;\n      border-top: none;\n    }\n\n    .add-btn {\n      width: 20px;\n      height: 20px;\n      border: 1px dashed var(--caris-border-light, #ccc);\n      border-radius: 3px;\n      background: transparent;\n      color: var(--caris-text-secondary, #666);\n      font-size: 14px;\n      cursor: pointer;\n    }\n\n    .add-btn:hover {\n      border-color: var(--caris-primary, #1976d2);\n      color: var(--caris-primary, #1976d2);\n    }\n\n    .line-type-item,\n    .buoyancy-item {\n      margin: 8px;\n      border: 1px solid var(--caris-border-light, #ddd);\n      border-radius: 4px;\n      overflow: hidden;\n      cursor: pointer;\n    }\n\n    .line-type-item:hover,\n    .buoyancy-item:hover {\n      border-color: var(--caris-primary, #1976d2);\n    }\n\n    .line-type-item.selected,\n    .buoyancy-item.selected {\n      border-color: var(--caris-primary, #1976d2);\n      background: var(--caris-bg-selected, #e3f2fd);\n    }\n\n    .line-type-item.new-item,\n    .buoyancy-item.new-item {\n      border-style: dashed;\n      cursor: default;\n    }\n\n    .line-type-header,\n    .buoyancy-header {\n      padding: 8px 12px;\n      display: flex;\n      justify-content: space-between;\n      align-items: center;\n    }\n\n    .line-type-name,\n    .buoyancy-name {\n      font-weight: 500;\n      font-size: 12px;\n    }\n\n    .line-type-summary,\n    .buoyancy-summary {\n      padding: 0 12px 8px;\n      font-size: 11px;\n      color: var(--caris-text-secondary, #666);\n    }\n\n    .delete-btn {\n      width: 20px;\n      height: 20px;\n      border: none;\n      background: transparent;\n      color: var(--caris-text-secondary, #999);\n      font-size: 16px;\n      cursor: pointer;\n      border-radius: 3px;\n    }\n\n    .delete-btn:hover {\n      background: #ffebee;\n      color: var(--caris-error, #f44336);\n    }\n\n    .delete-btn.small {\n      width: 18px;\n      height: 18px;\n      font-size: 14px;\n    }\n\n    .line-type-editor,\n    .buoyancy-editor {\n      padding: 12px;\n      border-top: 1px solid var(--caris-border-light, #eee);\n      background: var(--caris-bg-subtle, #fafafa);\n    }\n\n    .form-group {\n      margin-bottom: 10px;\n    }\n\n    .form-group:last-child {\n      margin-bottom: 0;\n    }\n\n    .form-group label {\n      display: block;\n      font-size: 10px;\n      color: var(--caris-text-secondary, #666);\n      margin-bottom: 2px;\n    }\n\n    .form-group input {\n      width: 100%;\n      padding: 5px 6px;\n      border: 1px solid var(--caris-border-light, #ddd);\n      border-radius: 4px;\n      font-size: 11px;\n      background: white;\n    }\n\n    .form-group input:focus {\n      outline: none;\n      border-color: var(--caris-primary, #1976d2);\n    }\n\n    .form-group input.calculated-input {\n      background: var(--caris-bg-subtle, #f9f9f9);\n    }\n\n    .calc-hint {\n      display: block;\n      font-size: 9px;\n      color: var(--caris-text-tertiary, #999);\n      margin-top: 2px;\n      font-style: italic;\n    }\n\n    .form-row {\n      display: flex;\n      gap: 8px;\n    }\n\n    .form-group.half {\n      flex: 1;\n    }\n\n    .action-buttons {\n      display: flex;\n      gap: 8px;\n      margin-top: 12px;\n    }\n\n    .btn {\n      flex: 1;\n      padding: 6px 12px;\n      border-radius: 4px;\n      font-size: 11px;\n      cursor: pointer;\n    }\n\n    .btn.save {\n      background: var(--caris-primary, #1976d2);\n      color: white;\n      border: none;\n    }\n\n    .btn.save:hover {\n      background: var(--caris-primary-dark, #1565c0);\n    }\n\n    .btn.cancel {\n      background: white;\n      border: 1px solid var(--caris-border-light, #ddd);\n      color: var(--caris-text-secondary, #666);\n    }\n\n    .btn.cancel:hover {\n      background: var(--caris-bg-subtle, #f5f5f5);\n    }\n  "]})],c)},1008(e,n,t){t.d(n,{Y:()=>u});var s=t(4087),i=t(7493),o=t(1795),a=t(5254),r=t(6882),l=t(5154),d=t(1711),c=function(e,n,t,s){var i,o=arguments.length,a=o<3?n:null===s?s=Object.getOwnPropertyDescriptor(n,t):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,n,t,s);else for(var r=e.length-1;r>=0;r--)(i=e[r])&&(a=(o<3?i(a):o>3?i(n,t,a):i(n,t))||a);return o>3&&a&&Object.defineProperty(n,t,a),a},p=function(e,n){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,n)};let u=class{visible=!1;visibleChange=new s.EventEmitter;import=new s.EventEmitter;rows=(0,s.signal)([{name:"",outerDiameter:1450,length:1600,dryMass:855.7,apparentMassInWater:-1220,numberOfModules:6,spacing:12}]);handlePaste(e){e.preventDefault();const n=e.clipboardData;if(!n)return;const t=n.getData("text");if(!t)return;const s=this.parseExcelData(t);s.length>0&&this.rows.set(s)}handleKeydown(e){!e.ctrlKey&&!e.metaKey||e.key}parseExcelData(e){const n=[],t=e.trim().split("\n");for(const e of t){const t=e.split(/\t|(?:  +)/);t.length>=1&&t[0]?.trim()&&n.push({name:t[0]?.trim()||"",outerDiameter:parseFloat(t[1])||1450,length:parseFloat(t[2])||1600,dryMass:parseFloat(t[3])||855.7,apparentMassInWater:parseFloat(t[4])||-1220,numberOfModules:parseInt(t[5])||6,spacing:parseFloat(t[6])||12})}return n}addRow(){const e=this.rows();this.rows.set([...e,{name:"",outerDiameter:1450,length:1600,dryMass:855.7,apparentMassInWater:-1220,numberOfModules:6,spacing:12}])}clearRows(){this.rows.set([{name:"",outerDiameter:1450,length:1600,dryMass:855.7,apparentMassInWater:-1220,numberOfModules:6,spacing:12}])}hasValidData(){return this.rows().some(e=>""!==e.name.trim())}getValidRowCount(){return this.rows().filter(e=>""!==e.name.trim()).length}onImport(){const e=this.rows().filter(e=>""!==e.name.trim()).map(e=>({id:crypto.randomUUID(),name:e.name.trim(),outerDiameter:e.outerDiameter/1e3,length:e.length/1e3,dryMass:e.dryMass,apparentMassInWater:e.apparentMassInWater,dragCoefficient:.8,numberOfModules:e.numberOfModules,spacing:e.spacing}));this.import.emit(e),this.close()}onCancel(){this.close()}close(){this.visible=!1,this.visibleChange.emit(!1),this.rows.set([{name:"",outerDiameter:1450,length:1600,dryMass:855.7,apparentMassInWater:-1220,numberOfModules:6,spacing:12}])}};c([(0,s.Input)(),p("design:type",Object)],u.prototype,"visible",void 0),c([(0,s.Output)(),p("design:type",Object)],u.prototype,"visibleChange",void 0),c([(0,s.Output)(),p("design:type",Object)],u.prototype,"import",void 0),u=c([(0,s.Component)({selector:"orcaflex-buoyancy-modules-import-dialog",standalone:!0,imports:[i.CommonModule,o.FormsModule,a.Ph,r.bG,l.tm,d.um],template:'\n    <p-dialog\n      header="Import Buoyancy Modules"\n      [visible]="visible"\n      [modal]="true"\n      [closable]="true"\n      [draggable]="false"\n      [resizable]="false"\n      [style]="{ width: \'900px\' }"\n      styleClass="import-dialog"\n      (onHide)="onCancel()"\n    >\n      <div class="dialog-content">\n        <div class="paste-instructions">\n          <p>Paste data from Excel with columns: <strong>Name, OD (mm), Length (mm), Mass in Air (kg), Apparent Mass (kg), Count, Spacing (m)</strong></p>\n          <p class="hint">Click in the table and press Ctrl+V (Cmd+V on Mac) to paste. Apparent mass is negative for buoyant modules.</p>\n        </div>\n\n        <div\n          class="table-container"\n          tabindex="0"\n          (paste)="handlePaste($event)"\n          (keydown)="handleKeydown($event)"\n        >\n          <p-table [value]="rows()" [tableStyle]="{ \'min-width\': \'100%\' }" [scrollable]="true" scrollHeight="300px">\n            <ng-template pTemplate="header">\n              <tr>\n                <th style="width: 16%">Name</th>\n                <th style="width: 12%">OD (mm)</th>\n                <th style="width: 12%">Length (mm)</th>\n                <th style="width: 14%">Mass Air (kg)</th>\n                <th style="width: 14%">Apparent (kg)</th>\n                <th style="width: 10%">Count</th>\n                <th style="width: 12%">Spacing (m)</th>\n              </tr>\n            </ng-template>\n            <ng-template pTemplate="body" let-row let-rowIndex="rowIndex">\n              <tr>\n                <td>\n                  <input\n                    type="text"\n                    pInputText\n                    [(ngModel)]="row.name"\n                    placeholder="Name"\n                    class="table-input"\n                  />\n                </td>\n                <td>\n                  <input\n                    type="number"\n                    pInputText\n                    [(ngModel)]="row.outerDiameter"\n                    placeholder="1450"\n                    class="table-input coord"\n                  />\n                </td>\n                <td>\n                  <input\n                    type="number"\n                    pInputText\n                    [(ngModel)]="row.length"\n                    placeholder="1600"\n                    class="table-input coord"\n                  />\n                </td>\n                <td>\n                  <input\n                    type="number"\n                    pInputText\n                    [(ngModel)]="row.dryMass"\n                    placeholder="855.7"\n                    class="table-input coord"\n                  />\n                </td>\n                <td>\n                  <input\n                    type="number"\n                    pInputText\n                    [(ngModel)]="row.apparentMassInWater"\n                    placeholder="-1220"\n                    class="table-input coord"\n                  />\n                </td>\n                <td>\n                  <input\n                    type="number"\n                    pInputText\n                    [(ngModel)]="row.numberOfModules"\n                    placeholder="6"\n                    class="table-input coord"\n                    min="1"\n                  />\n                </td>\n                <td>\n                  <input\n                    type="number"\n                    pInputText\n                    [(ngModel)]="row.spacing"\n                    placeholder="12"\n                    class="table-input coord"\n                  />\n                </td>\n              </tr>\n            </ng-template>\n            <ng-template pTemplate="emptymessage">\n              <tr>\n                <td colspan="7" class="empty-message">\n                  Paste Excel data here or add rows manually\n                </td>\n              </tr>\n            </ng-template>\n          </p-table>\n        </div>\n\n        <div class="row-actions">\n          <button class="action-btn add" (click)="addRow()">+ Add Row</button>\n          <button class="action-btn clear" (click)="clearRows()">Clear All</button>\n        </div>\n      </div>\n\n      <ng-template pTemplate="footer">\n        <div class="dialog-footer">\n          <button class="btn-secondary" (click)="onCancel()">Cancel</button>\n          <button class="btn-primary" (click)="onImport()" [disabled]="!hasValidData()">\n            Import {{ getValidRowCount() }} Module{{ getValidRowCount() !== 1 ? \'s\' : \'\' }}\n          </button>\n        </div>\n      </ng-template>\n    </p-dialog>\n  ',styles:["\n    :host ::ng-deep .import-dialog .p-dialog {\n      background: white;\n    }\n\n    :host ::ng-deep .import-dialog .p-dialog-header {\n      background: white;\n      border-bottom: 1px solid #eee;\n      padding: 16px 20px;\n    }\n\n    :host ::ng-deep .import-dialog .p-dialog-content {\n      background: white;\n      padding: 20px;\n    }\n\n    :host ::ng-deep .import-dialog .p-dialog-footer {\n      background: white;\n      border-top: 1px solid #eee;\n      padding: 16px 20px;\n    }\n\n    :host ::ng-deep .p-dialog-mask {\n      background: rgba(0, 0, 0, 0.5);\n    }\n\n    .dialog-content {\n      padding: 0;\n    }\n\n    .paste-instructions {\n      margin-bottom: 16px;\n      padding: 12px;\n      background: #f5f5f5;\n      border-radius: 4px;\n    }\n\n    .paste-instructions p {\n      margin: 0;\n      font-size: 12px;\n      color: #333;\n    }\n\n    .paste-instructions .hint {\n      margin-top: 4px;\n      font-size: 11px;\n      color: #666;\n    }\n\n    .table-container {\n      border: 2px dashed #ddd;\n      border-radius: 4px;\n      padding: 4px;\n      outline: none;\n      transition: border-color 0.2s;\n      background: white;\n    }\n\n    .table-container:focus {\n      border-color: #1976d2;\n    }\n\n    :host ::ng-deep .p-datatable {\n      background: white;\n    }\n\n    :host ::ng-deep .p-datatable .p-datatable-thead > tr > th {\n      background: #fafafa;\n      font-size: 10px;\n      font-weight: 600;\n      text-transform: uppercase;\n      color: #666;\n      padding: 8px 4px;\n      border: none;\n      border-bottom: 1px solid #eee;\n    }\n\n    :host ::ng-deep .p-datatable .p-datatable-tbody > tr {\n      background: white;\n    }\n\n    :host ::ng-deep .p-datatable .p-datatable-tbody > tr > td {\n      padding: 4px 2px;\n      border: none;\n      border-bottom: 1px solid #f0f0f0;\n      background: white;\n    }\n\n    .table-input {\n      width: 100%;\n      padding: 6px 4px;\n      border: 1px solid #ddd;\n      border-radius: 4px;\n      font-size: 11px;\n      background: white;\n    }\n\n    .table-input:focus {\n      outline: none;\n      border-color: #1976d2;\n    }\n\n    .table-input.coord {\n      text-align: right;\n    }\n\n    .empty-message {\n      text-align: center;\n      padding: 24px;\n      color: #999;\n      font-style: italic;\n      background: white;\n    }\n\n    .row-actions {\n      display: flex;\n      gap: 8px;\n      margin-top: 12px;\n    }\n\n    .action-btn {\n      padding: 6px 12px;\n      border: 1px solid #ddd;\n      border-radius: 4px;\n      background: white;\n      font-size: 11px;\n      cursor: pointer;\n    }\n\n    .action-btn:hover {\n      background: #f5f5f5;\n    }\n\n    .action-btn.add {\n      color: #1976d2;\n      border-color: #1976d2;\n    }\n\n    .action-btn.clear {\n      color: #666;\n    }\n\n    .dialog-footer {\n      display: flex;\n      justify-content: flex-end;\n      gap: 8px;\n    }\n\n    .btn-secondary {\n      padding: 8px 16px;\n      border: 1px solid #ddd;\n      border-radius: 4px;\n      background: white;\n      font-size: 12px;\n      cursor: pointer;\n    }\n\n    .btn-secondary:hover {\n      background: #f5f5f5;\n    }\n\n    .btn-primary {\n      padding: 8px 16px;\n      border: none;\n      border-radius: 4px;\n      background: #1976d2;\n      color: white;\n      font-size: 12px;\n      cursor: pointer;\n    }\n\n    .btn-primary:hover:not(:disabled) {\n      background: #1565c0;\n    }\n\n    .btn-primary:disabled {\n      background: #ddd;\n      cursor: not-allowed;\n    }\n  "]})],u)},1019(e,n,t){t.d(n,{D:()=>o});var s=t(5726),i=t(2945);function o(e={}){const{size:n=1e3,divisions:t=20,colorCenter:o=i.lm.grid,colorGrid:a=13421772}=e,r=new s.GridHelper(n,t,o,a);return r.rotation.x=Math.PI/2,r.position.set(0,0,0),r}},1142(e,n,t){t.d(n,{B:()=>p});var s=t(4087),i=t(7493),o=t(3413),a=t(295),r=t(3591),l=t(2288),d=t(8003),c=t(3574);let p=class{modelState=(0,s.inject)(o.W);apiService=(0,s.inject)(a.C);showGenerateDialog=!1;expandedSections={environment:!0,vessel:!0,lineTypes:!1,risers:!0,results:!0,logs:!1};ngOnInit(){this.modelState.addLog("info","OrcaFlex Riser Module initialized")}ngOnDestroy(){}toggleSection(e){this.expandedSections[e]=!this.expandedSections[e]}async calculateRiser(e){console.log("calculateRiser called",e),this.modelState.setCalculating(!0),this.modelState.addLog("info",`Calculating riser "${e.name}"...`);try{if("catenary"===e.geometry.type){const n=this.modelState.lineTypes().find(n=>n.id===e.lineTypeId);if(!n)throw new Error("Line type not found");const t=this.modelState.environment(),s=t.sea.waterDepth,i=s-Math.abs(e.geometry.hangoffPoint.z),o=e.contents?.find(n=>n.id===e.activeContentId),a=o?.density??0,r={method:"point_angle",weight:(0,c.uU)(n,a,t.sea.waterDensity),height:i,departure_angle:e.geometry.departureAngle,num_points:100},l=await this.apiService.calculateCatenary(r),d=(l.points||[]).map(e=>({x:e.x,y:e.z,s:0,angle:0}));console.log("Catenary result:",l),console.log("Mapped points:",d.length,d.slice(0,3)),this.modelState.updateRiser({...e,calculationResults:{totalLength:l.arc_length,tdpPosition:{x:l.horizontal_distance,y:0,z:-s},maxTension:l.horizontal_tension/Math.cos(l.end_angle_rad),minTension:l.horizontal_tension,points:d}}),this.modelState.addLog("success",`Riser "${e.name}" calculated successfully`)}else if("lazy-wave"===e.geometry.type){const n=this.modelState.lineTypes().find(n=>n.id===e.lineTypeId),t=this.modelState.model().buoyancyModules.find(n=>n.id===e.buoyancyModuleId);if(!n)throw new Error("Line type not found");const s=this.modelState.environment(),i=e.geometry,o=this.modelState.vessels().find(n=>n.id===e.vesselId),a=o?.connectionPoints.find(n=>n.id===e.connectionPointId),r=Math.abs(a?.z??0),l=s.sea.waterDepth-r,d=e.contents?.find(n=>n.id===e.activeContentId),p=d?.density??0,u={water_depth:l,line_weight:(0,c.uU)(n,p,s.sea.waterDensity),buoyancy_weight:t?(0,c.hY)(t):0,sag:i.sagBend,hog:i.hogBend,departure_angle:i.departureAngle};console.log("Lazy wave request:",u);const h=await this.apiService.calculateLazyWave(u);console.log("Lazy wave API result:",h),console.log("Lazy wave points count:",h.points?.length||0);const m=h.buoyancy_section_start||h.results?.buoyancy_section_start,g=h.buoyancy_section_end||h.results?.buoyancy_section_end;this.modelState.updateRiser({...e,calculationResults:{totalLength:h.tdp_length||500,tdpPosition:{x:h.tdp_horizontal_distance||200,y:0,z:-s.sea.waterDepth},maxTension:h.horizontal_tension||5e4,minTension:.3*(h.horizontal_tension||5e4),sagBendRadius:100,hogBendRadius:100,points:h.points||[],buoyancyStart:m,buoyancyEnd:g}}),this.modelState.addLog("success",`Lazy wave riser "${e.name}" calculated with ${h.points?.length||0} points`)}}catch(e){const n=e instanceof Error?e.message:"Unknown error";this.modelState.addLog("error",`Calculation failed: ${n}`)}finally{this.modelState.setCalculating(!1)}}};p=function(e,n,t,s){var i,o=arguments.length,a=o<3?n:null===s?s=Object.getOwnPropertyDescriptor(n,t):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,n,t,s);else for(var r=e.length-1;r>=0;r--)(i=e[r])&&(a=(o<3?i(a):o>3?i(n,t,a):i(n,t))||a);return o>3&&a&&Object.defineProperty(n,t,a),a}([(0,s.Component)({selector:"orcaflex-riser-module",standalone:!0,imports:[i.CommonModule,r.aG,r.$d,r.Y0,r.L5,r.rW,r.i_,l.N,d.J],template:'\n    <div class="orcaflex-workspace">\n      \x3c!-- Left Sidebar --\x3e\n      <aside class="sidebar left">\n        <div class="sidebar-section">\n          <div class="section-header" (click)="toggleSection(\'environment\')">\n            <span class="section-title">Environment</span>\n            <span class="toggle-icon">{{ expandedSections.environment ? \'−\' : \'+\' }}</span>\n          </div>\n          @if (expandedSections.environment) {\n            <orcaflex-environment-section />\n          }\n        </div>\n\n        <div class="sidebar-section">\n          <div class="section-header" (click)="toggleSection(\'vessel\')">\n            <span class="section-title">Vessel</span>\n            <span class="toggle-icon">{{ expandedSections.vessel ? \'−\' : \'+\' }}</span>\n          </div>\n          @if (expandedSections.vessel) {\n            <orcaflex-vessel-section />\n          }\n        </div>\n\n        <div class="sidebar-section">\n          <div class="section-header" (click)="toggleSection(\'lineTypes\')">\n            <span class="section-title">Line Types</span>\n            <span class="toggle-icon">{{ expandedSections.lineTypes ? \'−\' : \'+\' }}</span>\n          </div>\n          @if (expandedSections.lineTypes) {\n            <orcaflex-line-types-section />\n          }\n        </div>\n      </aside>\n\n      \x3c!-- Main Content - 3D View --\x3e\n      <main class="main-content">\n        <div class="view-container">\n          <orcaflex-three-view />\n        </div>\n\n        \x3c!-- Status bar --\x3e\n        <div class="status-bar">\n          <div class="status-left">\n            <span class="status-item">\n              Water Depth: {{ modelState.environment().sea.waterDepth }}m\n            </span>\n            <span class="status-item">\n              Risers: {{ modelState.riserCount() }}\n            </span>\n            @if (modelState.isCalculating()) {\n              <span class="status-item calculating">\n                Calculating...\n              </span>\n            }\n            @if (modelState.isDirty()) {\n              <span class="status-item modified">\n                Modified\n              </span>\n            }\n          </div>\n          <div class="status-right">\n            <button class="generate-btn" (click)="showGenerateDialog = true">\n              Generate OrcaFlex Models\n            </button>\n          </div>\n        </div>\n      </main>\n\n      \x3c!-- Right Sidebar --\x3e\n      <aside class="sidebar right">\n        <div class="sidebar-section">\n          <div class="section-header" (click)="toggleSection(\'risers\')">\n            <span class="section-title">Risers</span>\n            <span class="toggle-icon">{{ expandedSections.risers ? \'−\' : \'+\' }}</span>\n          </div>\n          @if (expandedSections.risers) {\n            <orcaflex-risers-section (onCalculateRequest)="calculateRiser($event)" />\n          }\n        </div>\n\n        <div class="sidebar-section">\n          <div class="section-header" (click)="toggleSection(\'results\')">\n            <span class="section-title">Results</span>\n            <span class="toggle-icon">{{ expandedSections.results ? \'−\' : \'+\' }}</span>\n          </div>\n          @if (expandedSections.results) {\n            <orcaflex-results-section />\n          }\n        </div>\n\n        <div class="sidebar-section">\n          <div class="section-header" (click)="toggleSection(\'logs\')">\n            <span class="section-title">Logs</span>\n            <span class="toggle-icon">{{ expandedSections.logs ? \'−\' : \'+\' }}</span>\n          </div>\n          @if (expandedSections.logs) {\n            <orcaflex-logs-section />\n          }\n        </div>\n      </aside>\n\n      \x3c!-- Generate OrcaFlex Dialog --\x3e\n      <orcaflex-generate-dialog\n        [(visible)]="showGenerateDialog"\n      />\n    </div>\n  ',styles:["\n    :host {\n      display: block;\n      width: 100%;\n      height: 100%;\n    }\n\n    .orcaflex-workspace {\n      display: flex;\n      height: 100%;\n      background: var(--caris-bg-workspace, #f5f5f5);\n    }\n\n    .sidebar {\n      width: 280px;\n      background: var(--caris-bg-sidebar, #fff);\n      border-right: 1px solid var(--caris-border-light, #e0e0e0);\n      overflow-y: auto;\n      flex-shrink: 0;\n    }\n\n    .sidebar.right {\n      border-right: none;\n      border-left: 1px solid var(--caris-border-light, #e0e0e0);\n    }\n\n    .sidebar-section {\n      border-bottom: 1px solid var(--caris-border-light, #e0e0e0);\n    }\n\n    .section-header {\n      display: flex;\n      justify-content: space-between;\n      align-items: center;\n      padding: 12px 16px;\n      background: var(--caris-bg-section-header, #fafafa);\n      cursor: pointer;\n      user-select: none;\n    }\n\n    .section-header:hover {\n      background: var(--caris-bg-hover, #f0f0f0);\n    }\n\n    .section-title {\n      font-size: 12px;\n      font-weight: 600;\n      text-transform: uppercase;\n      color: var(--caris-text-secondary, #666);\n    }\n\n    .toggle-icon {\n      color: var(--caris-text-tertiary, #999);\n      font-weight: bold;\n    }\n\n    .main-content {\n      flex: 1;\n      display: flex;\n      flex-direction: column;\n      min-width: 0;\n    }\n\n    .view-container {\n      flex: 1;\n      position: relative;\n    }\n\n    .status-bar {\n      display: flex;\n      justify-content: space-between;\n      align-items: center;\n      padding: 8px 16px;\n      background: var(--caris-bg-statusbar, #263238);\n      color: var(--caris-text-statusbar, #b0bec5);\n      font-size: 11px;\n    }\n\n    .status-left {\n      display: flex;\n      gap: 16px;\n    }\n\n    .status-right {\n      display: flex;\n      gap: 8px;\n    }\n\n    .status-item {\n      display: flex;\n      align-items: center;\n      gap: 4px;\n    }\n\n    .status-item.calculating {\n      color: var(--caris-warning, #ffc107);\n    }\n\n    .status-item.modified {\n      color: var(--caris-accent, #ff9800);\n    }\n\n    .generate-btn {\n      padding: 6px 14px;\n      border: none;\n      border-radius: 4px;\n      background: #4caf50;\n      color: white;\n      font-size: 11px;\n      font-weight: 500;\n      cursor: pointer;\n      transition: background 0.2s;\n    }\n\n    .generate-btn:hover {\n      background: #43a047;\n    }\n  "]})],p)},1463(e,n,t){t.d(n,{L:()=>c});var s=t(4087),i=t(7493),o=t(1795),a=t(3413),r=t(3574),l=function(e,n,t,s){var i,o=arguments.length,a=o<3?n:null===s?s=Object.getOwnPropertyDescriptor(n,t):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,n,t,s);else for(var r=e.length-1;r>=0;r--)(i=e[r])&&(a=(o<3?i(a):o>3?i(n,t,a):i(n,t))||a);return o>3&&a&&Object.defineProperty(n,t,a),a};const d=[4886745,3046706,9127187,16088064,10233776,48340];let c=class{modelState=(0,s.inject)(a.W);risers=this.modelState.risers;vessels=this.modelState.vessels;lineTypes=this.modelState.lineTypes;buoyancyModules=this.modelState.buoyancyModules;selectedRiserId=this.modelState.selectedRiserId;onCalculateRequest=new s.EventEmitter;selectRiser(e){this.modelState.selectRiser(this.selectedRiserId()===e?null:e)}getConnectionPoints(e){const n=this.vessels().find(n=>n.id===e);return n?.connectionPoints??[]}getColorHex(e){return"#"+(e??4886745).toString(16).padStart(6,"0")}addRiser(){const e=this.risers().length+1,n=this.vessels()[0],t={id:crypto.randomUUID(),name:`Riser ${e}`,lineTypeId:this.lineTypes()[0]?.id??"",vesselId:n?.id??"",connectionPointId:n?.connectionPoints[0]?.id??"",geometry:{type:"catenary",hangoffPoint:{x:50,y:0,z:-10},azimuth:180,departureAngle:80},contents:[...r.XT],activeContentId:"empty"};this.modelState.addRiser(t),this.modelState.selectRiser(t.id)}deleteRiser(e){this.modelState.deleteRiser(e)}updateRiserName(e,n){this.modelState.updateRiser({...e,name:n})}updateRiserVessel(e,n){const t=this.vessels().find(e=>e.id===n),s=t?.connectionPoints[0]?.id??"";this.modelState.updateRiser({...e,vesselId:n,connectionPointId:s})}updateRiserConnectionPoint(e,n){this.modelState.updateRiser({...e,connectionPointId:n})}updateRiserLineType(e,n){this.modelState.updateRiser({...e,lineTypeId:n})}updateRiserBuoyancy(e,n){this.modelState.updateRiser({...e,buoyancyModuleId:n})}addContent(e){const n=e.contents.length%d.length,t={id:crypto.randomUUID(),name:`Content ${e.contents.length+1}`,density:0,color:d[n]};this.modelState.updateRiser({...e,contents:[...e.contents,t]})}removeContent(e,n){if(e.contents.length<=1)return;const t=e.contents.filter(e=>e.id!==n),s=e.activeContentId===n?t[0]?.id:e.activeContentId;this.modelState.updateRiser({...e,contents:t,activeContentId:s})}selectContent(e,n){this.modelState.updateRiser({...e,activeContentId:n})}updateContentName(e,n,t){const s=e.contents.map(e=>e.id===n?{...e,name:t}:e);this.modelState.updateRiser({...e,contents:s})}updateContentDensity(e,n,t){const s=e.contents.map(e=>e.id===n?{...e,density:t}:e);this.modelState.updateRiser({...e,contents:s})}setRiserType(e,n){if(n===e.geometry.type)return;let t;t="catenary"===n?{type:"catenary",hangoffPoint:e.geometry.hangoffPoint,azimuth:e.geometry.azimuth,departureAngle:e.geometry.departureAngle}:{type:"lazy-wave",hangoffPoint:e.geometry.hangoffPoint,azimuth:e.geometry.azimuth,departureAngle:e.geometry.departureAngle,sagBend:30,hogBend:50},this.modelState.updateRiser({...e,geometry:t,calculationResults:void 0})}updateGeometry(e,n,t){this.modelState.updateRiser({...e,geometry:{...e.geometry,[n]:t},calculationResults:void 0})}calculateRiser(e){console.log("RiserSection: calculateRiser clicked, emitting",e.name),this.onCalculateRequest.emit(e)}asCatenary(e){return e}asLazyWave(e){return e}};l([(0,s.Output)(),function(e,n){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,n)}("design:type",Object)],c.prototype,"onCalculateRequest",void 0),c=l([(0,s.Component)({selector:"orcaflex-risers-section",standalone:!0,imports:[i.CommonModule,o.FormsModule],template:'\n    <div class="section-content">\n      <div class="toolbar">\n        <button class="add-btn" (click)="addRiser()">\n          <span class="icon">+</span> Add Riser\n        </button>\n      </div>\n\n      @for (riser of risers(); track riser.id) {\n        <div\n          class="riser-item"\n          [class.selected]="selectedRiserId() === riser.id"\n        >\n          <div class="riser-header" (click)="selectRiser(riser.id)">\n            <span class="riser-name">{{ riser.name }}</span>\n            <div class="header-right">\n              <span class="riser-type" [class.catenary]="riser.geometry.type === \'catenary\'"\n                [class.lazy-wave]="riser.geometry.type === \'lazy-wave\'">\n                {{ riser.geometry.type }}\n              </span>\n              <button class="delete-btn" (click)="deleteRiser(riser.id); $event.stopPropagation()">×</button>\n            </div>\n          </div>\n\n          <div class="riser-info">\n            <span class="info-item">\n              {{ riser.geometry.departureAngle }}° | {{ riser.geometry.azimuth }}°\n            </span>\n            @if (riser.calculationResults) {\n              <span class="info-item calculated">\n                {{ riser.calculationResults.totalLength | number:\'1.0-0\' }}m\n              </span>\n            } @else {\n              <span class="info-item pending">Not calculated</span>\n            }\n          </div>\n\n          @if (selectedRiserId() === riser.id) {\n            <div class="riser-editor" (click)="$event.stopPropagation()">\n              \x3c!-- Basic Info --\x3e\n              <div class="form-group">\n                <label>Name</label>\n                <input type="text" [ngModel]="riser.name"\n                  (ngModelChange)="updateRiserName(riser, $event)" />\n              </div>\n\n              \x3c!-- Connection --\x3e\n              <div class="subsection-title">Connection</div>\n              <div class="form-row">\n                <div class="form-group half">\n                  <label>Vessel</label>\n                  <select [ngModel]="riser.vesselId"\n                    (ngModelChange)="updateRiserVessel(riser, $event)">\n                    @for (vessel of vessels(); track vessel.id) {\n                      <option [value]="vessel.id">{{ vessel.name }}</option>\n                    }\n                  </select>\n                </div>\n                <div class="form-group half">\n                  <label>Connection Point</label>\n                  <select [ngModel]="riser.connectionPointId"\n                    (ngModelChange)="updateRiserConnectionPoint(riser, $event)">\n                    @for (cp of getConnectionPoints(riser.vesselId); track cp.id) {\n                      <option [value]="cp.id">{{ cp.name }}</option>\n                    }\n                  </select>\n                </div>\n              </div>\n\n              \x3c!-- Line Type --\x3e\n              <div class="form-group">\n                <label>Line Type</label>\n                <select [ngModel]="riser.lineTypeId"\n                  (ngModelChange)="updateRiserLineType(riser, $event)">\n                  @for (lt of lineTypes(); track lt.id) {\n                    <option [value]="lt.id">{{ lt.name }}</option>\n                  }\n                </select>\n              </div>\n\n              \x3c!-- Contents Section --\x3e\n              <div class="subsection-title">Contents</div>\n              <div class="contents-list">\n                @for (content of riser.contents; track content.id; let i = $index) {\n                  <div class="content-item" [class.active]="riser.activeContentId === content.id">\n                    <div class="content-color" [style.background-color]="getColorHex(content.color)"></div>\n                    <div class="content-info">\n                      <input type="text" class="content-name" [ngModel]="content.name"\n                        (ngModelChange)="updateContentName(riser, content.id, $event)" />\n                      <div class="content-density">\n                        <input type="number" [ngModel]="content.density"\n                          (ngModelChange)="updateContentDensity(riser, content.id, $event)"\n                          step="1" min="0" />\n                        <span class="unit">kg/m³</span>\n                      </div>\n                    </div>\n                    <div class="content-actions">\n                      <button class="select-btn"\n                        [class.selected]="riser.activeContentId === content.id"\n                        (click)="selectContent(riser, content.id)"\n                        title="Use for calculation">\n                        {{ riser.activeContentId === content.id ? \'✓\' : \'○\' }}\n                      </button>\n                      <button class="remove-btn"\n                        (click)="removeContent(riser, content.id)"\n                        [disabled]="riser.contents.length <= 1"\n                        title="Remove content">×</button>\n                    </div>\n                  </div>\n                }\n                <button class="add-content-btn" (click)="addContent(riser)">\n                  + Add Content\n                </button>\n              </div>\n\n              \x3c!-- Riser Type --\x3e\n              <div class="subsection-title">Geometry</div>\n              <div class="type-selector">\n                <button\n                  class="type-btn"\n                  [class.active]="riser.geometry.type === \'catenary\'"\n                  (click)="setRiserType(riser, \'catenary\'); $event.stopPropagation()"\n                >\n                  Catenary\n                </button>\n                <button\n                  class="type-btn"\n                  [class.active]="riser.geometry.type === \'lazy-wave\'"\n                  (click)="setRiserType(riser, \'lazy-wave\'); $event.stopPropagation()"\n                >\n                  Lazy Wave\n                </button>\n              </div>\n\n              \x3c!-- Common Geometry --\x3e\n              <div class="form-row">\n                <div class="form-group half">\n                  <label>Azimuth (°)</label>\n                  <input type="number" [ngModel]="riser.geometry.azimuth"\n                    (ngModelChange)="updateGeometry(riser, \'azimuth\', $event)"\n                    min="0" max="360" step="5" />\n                </div>\n                <div class="form-group half">\n                  <label>Departure Angle (°)</label>\n                  <input type="number" [ngModel]="riser.geometry.departureAngle"\n                    (ngModelChange)="updateGeometry(riser, \'departureAngle\', $event)"\n                    min="0" max="90" step="1" />\n                </div>\n              </div>\n\n              \x3c!-- Catenary-specific --\x3e\n              @if (riser.geometry.type === \'catenary\') {\n                <div class="form-group">\n                  <label>Layback (m) - optional</label>\n                  <input type="number" [ngModel]="asCatenary(riser.geometry).layback"\n                    (ngModelChange)="updateGeometry(riser, \'layback\', $event)"\n                    min="0" step="10" />\n                </div>\n              }\n\n              \x3c!-- Lazy Wave-specific --\x3e\n              @if (riser.geometry.type === \'lazy-wave\') {\n                <div class="form-row">\n                  <div class="form-group half">\n                    <label>Sag Bend (m)</label>\n                    <input type="number" [ngModel]="asLazyWave(riser.geometry).sagBend"\n                      (ngModelChange)="updateGeometry(riser, \'sagBend\', $event)"\n                      min="0" step="1" />\n                  </div>\n                  <div class="form-group half">\n                    <label>Hog Bend (m)</label>\n                    <input type="number" [ngModel]="asLazyWave(riser.geometry).hogBend"\n                      (ngModelChange)="updateGeometry(riser, \'hogBend\', $event)"\n                      min="0" step="1" />\n                  </div>\n                </div>\n\n                <div class="form-group">\n                  <label>Buoyancy Module</label>\n                  <select [ngModel]="riser.buoyancyModuleId"\n                    (ngModelChange)="updateRiserBuoyancy(riser, $event)">\n                    <option [value]="undefined">None</option>\n                    @for (bm of buoyancyModules(); track bm.id) {\n                      <option [value]="bm.id">{{ bm.name }}</option>\n                    }\n                  </select>\n                </div>\n              }\n\n              \x3c!-- Results Summary --\x3e\n              @if (riser.calculationResults) {\n                <div class="results-summary">\n                  <div class="result-row">\n                    <span class="label">Total Length:</span>\n                    <span class="value">{{ riser.calculationResults.totalLength | number:\'1.1-1\' }} m</span>\n                  </div>\n                  <div class="result-row">\n                    <span class="label">TDP Position:</span>\n                    <span class="value">\n                      ({{ riser.calculationResults.tdpPosition.x | number:\'1.0-0\' }},\n                       {{ riser.calculationResults.tdpPosition.y | number:\'1.0-0\' }})\n                    </span>\n                  </div>\n                  <div class="result-row">\n                    <span class="label">Max Tension:</span>\n                    <span class="value">{{ riser.calculationResults.maxTension | number:\'1.0-0\' }} N</span>\n                  </div>\n                </div>\n              }\n\n              \x3c!-- Actions --\x3e\n              <div class="riser-actions">\n                <button class="action-btn primary" (click)="calculateRiser(riser); $event.stopPropagation()">\n                  Calculate\n                </button>\n              </div>\n            </div>\n          }\n        </div>\n      }\n\n      @if (risers().length === 0) {\n        <div class="empty-state">\n          <p>No risers defined</p>\n          <p class="hint">Click "Add Riser" to create one</p>\n        </div>\n      }\n    </div>\n  ',styles:["\n    .section-content {\n      padding: 8px;\n    }\n\n    .toolbar {\n      margin-bottom: 12px;\n    }\n\n    .add-btn {\n      width: 100%;\n      padding: 8px 12px;\n      background: var(--caris-primary, #1976d2);\n      color: white;\n      border: none;\n      border-radius: 4px;\n      font-size: 12px;\n      cursor: pointer;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      gap: 6px;\n    }\n\n    .add-btn:hover {\n      background: var(--caris-primary-dark, #1565c0);\n    }\n\n    .icon {\n      font-weight: bold;\n    }\n\n    .riser-item {\n      border: 1px solid var(--caris-border-light, #ddd);\n      border-radius: 4px;\n      margin-bottom: 8px;\n      transition: all 0.2s;\n      overflow: hidden;\n    }\n\n    .riser-item:hover {\n      border-color: var(--caris-primary, #1976d2);\n    }\n\n    .riser-item.selected {\n      border-color: var(--caris-primary, #1976d2);\n      background: var(--caris-bg-selected, #e3f2fd);\n    }\n\n    .riser-header {\n      padding: 8px 12px;\n      display: flex;\n      justify-content: space-between;\n      align-items: center;\n      cursor: pointer;\n    }\n\n    .riser-header:hover {\n      background: rgba(0, 0, 0, 0.02);\n    }\n\n    .header-right {\n      display: flex;\n      align-items: center;\n      gap: 8px;\n    }\n\n    .riser-name {\n      font-weight: 500;\n      font-size: 12px;\n    }\n\n    .riser-type {\n      font-size: 9px;\n      padding: 2px 6px;\n      background: var(--caris-bg-subtle, #f0f0f0);\n      border-radius: 10px;\n      text-transform: uppercase;\n      font-weight: 600;\n    }\n\n    .riser-type.catenary {\n      background: #e3f2fd;\n      color: #1976d2;\n    }\n\n    .riser-type.lazy-wave {\n      background: #fff3e0;\n      color: #f57c00;\n    }\n\n    .delete-btn {\n      width: 18px;\n      height: 18px;\n      border: none;\n      background: transparent;\n      color: var(--caris-text-tertiary, #bbb);\n      font-size: 16px;\n      cursor: pointer;\n      border-radius: 3px;\n    }\n\n    .delete-btn:hover {\n      background: #ffebee;\n      color: var(--caris-error, #f44336);\n    }\n\n    .riser-info {\n      padding: 4px 12px 8px;\n      display: flex;\n      justify-content: space-between;\n      font-size: 11px;\n      color: var(--caris-text-secondary, #666);\n    }\n\n    .info-item.calculated {\n      color: var(--caris-success, #4caf50);\n      font-weight: 500;\n    }\n\n    .info-item.pending {\n      color: var(--caris-text-tertiary, #999);\n      font-style: italic;\n    }\n\n    .riser-editor {\n      padding: 12px;\n      border-top: 1px solid var(--caris-border-light, #eee);\n      background: var(--caris-bg-subtle, #fafafa);\n    }\n\n    .form-group {\n      margin-bottom: 10px;\n    }\n\n    .form-group label {\n      display: block;\n      font-size: 10px;\n      color: var(--caris-text-secondary, #666);\n      margin-bottom: 2px;\n    }\n\n    .form-group input,\n    .form-group select {\n      width: 100%;\n      padding: 5px 6px;\n      border: 1px solid var(--caris-border-light, #ddd);\n      border-radius: 4px;\n      font-size: 11px;\n      background: white;\n    }\n\n    .form-group input:focus,\n    .form-group select:focus {\n      outline: none;\n      border-color: var(--caris-primary, #1976d2);\n    }\n\n    .form-row {\n      display: flex;\n      gap: 8px;\n    }\n\n    .form-group.half {\n      flex: 1;\n    }\n\n    .subsection-title {\n      font-size: 10px;\n      font-weight: 600;\n      text-transform: uppercase;\n      color: var(--caris-text-secondary, #666);\n      margin: 12px 0 8px 0;\n      padding-top: 8px;\n      border-top: 1px solid var(--caris-border-light, #eee);\n    }\n\n    /* Contents section styles */\n    .contents-list {\n      display: flex;\n      flex-direction: column;\n      gap: 6px;\n    }\n\n    .content-item {\n      display: flex;\n      align-items: center;\n      gap: 8px;\n      padding: 6px 8px;\n      background: white;\n      border: 1px solid var(--caris-border-light, #ddd);\n      border-radius: 4px;\n    }\n\n    .content-item.active {\n      border-color: var(--caris-primary, #1976d2);\n      background: #e3f2fd;\n    }\n\n    .content-color {\n      width: 12px;\n      height: 24px;\n      border-radius: 2px;\n      flex-shrink: 0;\n    }\n\n    .content-info {\n      flex: 1;\n      display: flex;\n      flex-direction: column;\n      gap: 2px;\n    }\n\n    .content-name {\n      border: none !important;\n      background: transparent !important;\n      padding: 2px 4px !important;\n      font-size: 11px !important;\n      font-weight: 500;\n    }\n\n    .content-name:focus {\n      background: white !important;\n      border: 1px solid var(--caris-primary, #1976d2) !important;\n    }\n\n    .content-density {\n      display: flex;\n      align-items: center;\n      gap: 4px;\n    }\n\n    .content-density input {\n      width: 60px !important;\n      padding: 2px 4px !important;\n      font-size: 10px !important;\n      text-align: right;\n    }\n\n    .content-density .unit {\n      font-size: 9px;\n      color: var(--caris-text-tertiary, #999);\n    }\n\n    .content-actions {\n      display: flex;\n      gap: 4px;\n    }\n\n    .select-btn {\n      width: 20px;\n      height: 20px;\n      border: 1px solid var(--caris-border-light, #ddd);\n      border-radius: 50%;\n      background: white;\n      font-size: 10px;\n      cursor: pointer;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n    }\n\n    .select-btn.selected {\n      background: var(--caris-primary, #1976d2);\n      color: white;\n      border-color: var(--caris-primary, #1976d2);\n    }\n\n    .remove-btn {\n      width: 20px;\n      height: 20px;\n      border: none;\n      background: transparent;\n      color: var(--caris-text-tertiary, #bbb);\n      font-size: 14px;\n      cursor: pointer;\n      border-radius: 3px;\n    }\n\n    .remove-btn:hover:not(:disabled) {\n      background: #ffebee;\n      color: var(--caris-error, #f44336);\n    }\n\n    .remove-btn:disabled {\n      opacity: 0.3;\n      cursor: not-allowed;\n    }\n\n    .add-content-btn {\n      padding: 6px;\n      border: 1px dashed var(--caris-border-light, #ccc);\n      border-radius: 4px;\n      background: transparent;\n      font-size: 10px;\n      color: var(--caris-text-secondary, #666);\n      cursor: pointer;\n    }\n\n    .add-content-btn:hover {\n      border-color: var(--caris-primary, #1976d2);\n      color: var(--caris-primary, #1976d2);\n    }\n\n    .type-selector {\n      display: flex;\n      gap: 4px;\n      margin-bottom: 12px;\n    }\n\n    .type-btn {\n      flex: 1;\n      padding: 6px 12px;\n      border: 1px solid var(--caris-border-light, #ddd);\n      border-radius: 4px;\n      background: white;\n      font-size: 11px;\n      cursor: pointer;\n    }\n\n    .type-btn:hover {\n      background: var(--caris-bg-hover, #f0f0f0);\n    }\n\n    .type-btn.active {\n      background: var(--caris-primary, #1976d2);\n      color: white;\n      border-color: var(--caris-primary, #1976d2);\n    }\n\n    .results-summary {\n      margin-top: 12px;\n      padding: 10px;\n      background: white;\n      border: 1px solid var(--caris-border-light, #eee);\n      border-radius: 4px;\n    }\n\n    .result-row {\n      display: flex;\n      justify-content: space-between;\n      font-size: 11px;\n      padding: 3px 0;\n    }\n\n    .result-row .label {\n      color: var(--caris-text-secondary, #666);\n    }\n\n    .result-row .value {\n      font-weight: 500;\n      font-family: monospace;\n    }\n\n    .riser-actions {\n      margin-top: 12px;\n      display: flex;\n      gap: 8px;\n    }\n\n    .action-btn {\n      flex: 1;\n      padding: 8px 12px;\n      border: 1px solid var(--caris-border-light, #ddd);\n      border-radius: 4px;\n      background: white;\n      font-size: 11px;\n      cursor: pointer;\n    }\n\n    .action-btn:hover {\n      background: var(--caris-bg-subtle, #f5f5f5);\n    }\n\n    .action-btn.primary {\n      background: var(--caris-primary, #1976d2);\n      color: white;\n      border-color: var(--caris-primary, #1976d2);\n    }\n\n    .action-btn.primary:hover {\n      background: var(--caris-primary-dark, #1565c0);\n    }\n\n    .empty-state {\n      text-align: center;\n      padding: 24px;\n      color: var(--caris-text-secondary, #999);\n    }\n\n    .empty-state p {\n      margin: 0 0 4px 0;\n      font-size: 12px;\n    }\n\n    .empty-state .hint {\n      font-size: 11px;\n      color: var(--caris-text-tertiary, #bbb);\n    }\n  "]})],c)},2288(e,n,t){t.d(n,{N:()=>s.N});var s=t(4677)},2563(e,n,t){t.d(n,{s:()=>i});var s=t(5726);class i extends s.Object3D{animating=!1;controls=null;camera;dim=128;turnRate=2*Math.PI;interactiveObjects=[];raycaster=new s.Raycaster;mouse=new s.Vector2;dummy=new s.Object3D;posXAxisHelper;posYAxisHelper;posZAxisHelper;negXAxisHelper;negYAxisHelper;negZAxisHelper;point=new s.Vector3;targetPosition=new s.Vector3;targetQuaternion=new s.Quaternion;q1=new s.Quaternion;q2=new s.Quaternion;radius=0;editorCamera;constructor(e){super(),this.editorCamera=e;const n=new s.Color("#ff3653"),t=new s.Color("#8adb00"),i=new s.Color("#2c8fff");this.camera=new s.OrthographicCamera(-2,2,2,-2,0,4),this.camera.position.set(0,0,2);const o=new s.BoxGeometry(.8,.05,.05).translate(.4,0,0),a=new s.Mesh(o,this.getAxisMaterial(n)),r=new s.Mesh(o,this.getAxisMaterial(t)),l=new s.Mesh(o,this.getAxisMaterial(i));r.rotation.z=Math.PI/2,l.rotation.y=-Math.PI/2,this.add(a),this.add(l),this.add(r),this.posXAxisHelper=new s.Sprite(this.getSpriteMaterial(n,"X")),this.posXAxisHelper.userData.type="posX",this.posYAxisHelper=new s.Sprite(this.getSpriteMaterial(t,"Y")),this.posYAxisHelper.userData.type="posY",this.posZAxisHelper=new s.Sprite(this.getSpriteMaterial(i,"Z")),this.posZAxisHelper.userData.type="posZ",this.negXAxisHelper=new s.Sprite(this.getSpriteMaterial(n)),this.negXAxisHelper.userData.type="negX",this.negYAxisHelper=new s.Sprite(this.getSpriteMaterial(t)),this.negYAxisHelper.userData.type="negY",this.negZAxisHelper=new s.Sprite(this.getSpriteMaterial(i)),this.negZAxisHelper.userData.type="negZ",this.posXAxisHelper.position.x=1,this.posYAxisHelper.position.y=1,this.posZAxisHelper.position.z=1,this.negXAxisHelper.position.x=-1,this.negXAxisHelper.scale.setScalar(.8),this.negYAxisHelper.position.y=-1,this.negYAxisHelper.scale.setScalar(.8),this.negZAxisHelper.position.z=-1,this.negZAxisHelper.scale.setScalar(.8),this.add(this.posXAxisHelper),this.add(this.posYAxisHelper),this.add(this.posZAxisHelper),this.add(this.negXAxisHelper),this.add(this.negYAxisHelper),this.add(this.negZAxisHelper),this.interactiveObjects.push(this.posXAxisHelper),this.interactiveObjects.push(this.posYAxisHelper),this.interactiveObjects.push(this.posZAxisHelper),this.interactiveObjects.push(this.negXAxisHelper),this.interactiveObjects.push(this.negYAxisHelper),this.interactiveObjects.push(this.negZAxisHelper)}render(e,n,t){this.updateOpacity();const s=n-this.dim,i=e.autoClear;e.autoClear=!1,e.setViewport(s,0,this.dim,this.dim),e.clearDepth(),e.render(this,this.camera),e.autoClear=i}renderToCanvas(e){this.updateOpacity(),e.render(this,this.camera)}updateOpacity(){this.quaternion.copy(this.editorCamera.quaternion).invert(),this.updateMatrixWorld(),this.point.set(0,0,1),this.point.applyQuaternion(this.editorCamera.quaternion),this.point.x>=0?(this.posXAxisHelper.material.opacity=1,this.negXAxisHelper.material.opacity=.5):(this.posXAxisHelper.material.opacity=.5,this.negXAxisHelper.material.opacity=1),this.point.y>=0?(this.posYAxisHelper.material.opacity=1,this.negYAxisHelper.material.opacity=.5):(this.posYAxisHelper.material.opacity=.5,this.negYAxisHelper.material.opacity=1),this.point.z>=0?(this.posZAxisHelper.material.opacity=1,this.negZAxisHelper.material.opacity=.5):(this.posZAxisHelper.material.opacity=.5,this.negZAxisHelper.material.opacity=1)}handleClick(e,n){if(this.animating)return!1;const t=n.getBoundingClientRect(),s=t.right-this.dim,i=t.bottom-this.dim;if(e.clientX<s||e.clientY<i)return!1;this.mouse.x=(e.clientX-s)/this.dim*2-1,this.mouse.y=-(e.clientY-i)/this.dim*2+1,this.raycaster.setFromCamera(this.mouse,this.camera);const o=this.raycaster.intersectObjects(this.interactiveObjects);if(o.length>0){const e=o[0].object;return this.controls&&(this.prepareAnimationData(e,this.controls.center),this.animating=!0),!0}return!1}update(e){if(!this.animating)return;const n=e*this.turnRate,t=this.controls?.center||new s.Vector3;this.q1.rotateTowards(this.q2,n),(this.editorCamera instanceof s.PerspectiveCamera||this.editorCamera instanceof s.OrthographicCamera)&&(this.editorCamera.position.set(0,0,1).applyQuaternion(this.q1).multiplyScalar(this.radius).add(t),this.editorCamera.quaternion.rotateTowards(this.targetQuaternion,n)),0===this.q1.angleTo(this.q2)&&(this.animating=!1)}setDimension(e){this.dim=e}prepareAnimationData(e,n){switch(e.userData.type){case"posX":this.targetPosition.set(1,0,0),this.targetQuaternion.setFromEuler(new s.Euler(0,.5*Math.PI,0));break;case"posY":this.targetPosition.set(0,1,0),this.targetQuaternion.setFromEuler(new s.Euler(.5*-Math.PI,0,0));break;case"posZ":this.targetPosition.set(0,0,1),this.targetQuaternion.setFromEuler(new s.Euler);break;case"negX":this.targetPosition.set(-1,0,0),this.targetQuaternion.setFromEuler(new s.Euler(0,.5*-Math.PI,0));break;case"negY":this.targetPosition.set(0,-1,0),this.targetQuaternion.setFromEuler(new s.Euler(.5*Math.PI,0,0));break;case"negZ":this.targetPosition.set(0,0,-1),this.targetQuaternion.setFromEuler(new s.Euler(0,Math.PI,0));break;default:console.error("ViewHelper: Invalid axis.")}this.radius=this.editorCamera.position.distanceTo(n),this.targetPosition.multiplyScalar(this.radius).add(n),this.dummy.position.copy(n),this.dummy.lookAt(this.editorCamera.position),this.q1.copy(this.dummy.quaternion),this.dummy.lookAt(this.targetPosition),this.q2.copy(this.dummy.quaternion)}getAxisMaterial(e){return new s.MeshBasicMaterial({color:e,toneMapped:!1})}getSpriteMaterial(e,n=null){const t=document.createElement("canvas");t.width=64,t.height=64;const i=t.getContext("2d");i.beginPath(),i.arc(32,32,16,0,2*Math.PI),i.closePath(),i.fillStyle=e.getStyle(),i.fill(),null!==n&&(i.font="24px Arial",i.textAlign="center",i.fillStyle="#000000",i.fillText(n,32,41));const o=new s.CanvasTexture(t);return new s.SpriteMaterial({map:o,toneMapped:!1,transparent:!0})}dispose(){this.traverse(e=>{e instanceof s.Mesh&&(e.geometry.dispose(),e.material instanceof s.Material&&e.material.dispose()),e instanceof s.Sprite&&(e.material.map&&e.material.map.dispose(),e.material.dispose())})}}},2873(e,n,t){t.d(n,{i:()=>a});var s=t(4087),i=t(7493),o=t(3413);let a=class{modelState=(0,s.inject)(o.W);logs=this.modelState.logs;formatTime(e){return new Date(e).toLocaleTimeString("en-US",{hour12:!1,hour:"2-digit",minute:"2-digit",second:"2-digit"})}clearLogs(){this.modelState.clearLogs()}};a=function(e,n,t,s){var i,o=arguments.length,a=o<3?n:null===s?s=Object.getOwnPropertyDescriptor(n,t):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,n,t,s);else for(var r=e.length-1;r>=0;r--)(i=e[r])&&(a=(o<3?i(a):o>3?i(n,t,a):i(n,t))||a);return o>3&&a&&Object.defineProperty(n,t,a),a}([(0,s.Component)({selector:"orcaflex-logs-section",standalone:!0,imports:[i.CommonModule],template:'\n    <div class="section-content">\n      <div class="toolbar">\n        <button class="clear-btn" (click)="clearLogs()" [disabled]="logs().length === 0">\n          Clear Logs\n        </button>\n      </div>\n\n      <div class="logs-container">\n        @for (log of logs(); track log.id) {\n          <div class="log-entry" [class]="log.level">\n            <span class="timestamp">{{ formatTime(log.timestamp) }}</span>\n            <span class="level-badge">{{ log.level }}</span>\n            <span class="message">{{ log.message }}</span>\n            @if (log.details) {\n              <div class="details">{{ log.details }}</div>\n            }\n          </div>\n        }\n\n        @if (logs().length === 0) {\n          <div class="empty-state">\n            No log entries\n          </div>\n        }\n      </div>\n    </div>\n  ',styles:["\n    .section-content {\n      padding: 8px;\n    }\n\n    .toolbar {\n      margin-bottom: 8px;\n    }\n\n    .clear-btn {\n      padding: 4px 8px;\n      font-size: 11px;\n      border: 1px solid var(--caris-border-light, #ddd);\n      border-radius: 4px;\n      background: white;\n      cursor: pointer;\n    }\n\n    .clear-btn:hover:not(:disabled) {\n      background: var(--caris-bg-subtle, #f5f5f5);\n    }\n\n    .clear-btn:disabled {\n      opacity: 0.5;\n      cursor: not-allowed;\n    }\n\n    .logs-container {\n      max-height: 300px;\n      overflow-y: auto;\n      border: 1px solid var(--caris-border-light, #eee);\n      border-radius: 4px;\n      background: var(--caris-bg-subtle, #fafafa);\n    }\n\n    .log-entry {\n      padding: 6px 8px;\n      border-bottom: 1px solid var(--caris-border-light, #eee);\n      font-size: 11px;\n      font-family: monospace;\n    }\n\n    .log-entry:last-child {\n      border-bottom: none;\n    }\n\n    .timestamp {\n      color: var(--caris-text-tertiary, #999);\n      margin-right: 8px;\n    }\n\n    .level-badge {\n      display: inline-block;\n      padding: 1px 4px;\n      border-radius: 3px;\n      font-size: 10px;\n      text-transform: uppercase;\n      margin-right: 8px;\n    }\n\n    .log-entry.info .level-badge {\n      background: #e3f2fd;\n      color: #1976d2;\n    }\n\n    .log-entry.success .level-badge {\n      background: #e8f5e9;\n      color: #388e3c;\n    }\n\n    .log-entry.warning .level-badge {\n      background: #fff3e0;\n      color: #f57c00;\n    }\n\n    .log-entry.error .level-badge {\n      background: #ffebee;\n      color: #d32f2f;\n    }\n\n    .message {\n      color: var(--caris-text-primary, #333);\n    }\n\n    .details {\n      margin-top: 4px;\n      padding: 4px 8px;\n      background: rgba(0,0,0,0.03);\n      border-radius: 2px;\n      color: var(--caris-text-secondary, #666);\n      white-space: pre-wrap;\n      word-break: break-all;\n    }\n\n    .empty-state {\n      padding: 20px;\n      text-align: center;\n      color: var(--caris-text-tertiary, #bbb);\n      font-size: 12px;\n    }\n  "]})],a)},2939(e,n,t){t.d(n,{$:()=>c});var s=t(4087),i=t(7493),o=t(1795),a=t(3413),r=t(295),l=t(3574),d=t(4532);let c=class{modelState=(0,s.inject)(a.W);apiService=(0,s.inject)(r.C);vessels=this.modelState.vessels;selectedVesselId=this.modelState.selectedVesselId;importing=(0,s.signal)(!1);editingCpIdx=(0,s.signal)(null);editingCp={id:"",name:"",x:0,y:0,z:0};showImportDialog=!1;importTargetVesselId=null;selectVessel(e){this.modelState.selectVessel(this.selectedVesselId()===e?null:e)}addVessel(){const e=this.vessels().length+1,n={...l.ts,id:crypto.randomUUID(),name:`Vessel ${e}`,connectionPoints:[{id:crypto.randomUUID(),name:"CP1",x:0,y:0,z:-10}]};this.modelState.addVessel(n),this.modelState.selectVessel(n.id)}deleteVessel(e){this.modelState.deleteVessel(e)}async onFileSelected(e){const n=e.target;if(!n.files?.length)return;const t=n.files[0];this.importing.set(!0);try{const e=await this.apiService.parseVesselFromYaml(t);if(e.vessels&&e.vessels.length>0){for(const n of e.vessels){const e={id:crypto.randomUUID(),name:n.name,length:n.length||250,breadth:n.breadth||50,depth:n.depth||30,draft:n.draft||15,position:{x:n.initialX||0,y:n.initialY||0,z:n.initialZ||0},orientation:{heading:n.initialHeading||0,roll:n.initialHeel||0,pitch:n.initialTrim||0},connectionPoints:(n.connectionPoints||[]).map(e=>({id:crypto.randomUUID(),name:e.name||"CP",x:e.x||0,y:e.y||0,z:e.z||0}))};this.modelState.addVessel(e)}this.modelState.addLog("success",`Imported ${e.vessels.length} vessel(s) from YAML`)}else this.modelState.addLog("warning","No vessels found in YAML file")}catch(e){const n=e instanceof Error?e.message:"Unknown error";this.modelState.addLog("error",`Failed to import vessel: ${n}`)}finally{this.importing.set(!1),n.value=""}}updateVesselName(e,n){this.modelState.updateVessel({...e,name:n})}updateVesselDimension(e,n,t){this.modelState.updateVessel({...e,[n]:t})}updateVesselPosition(e,n,t){this.modelState.updateVessel({...e,position:{...e.position,[n]:t}})}updateVesselOrientation(e,n,t){this.modelState.updateVessel({...e,orientation:{...e.orientation,[n]:t}})}addConnectionPoint(e){const n=e.connectionPoints.length+1,t={id:crypto.randomUUID(),name:`CP${n}`,x:0,y:0,z:-10};this.modelState.updateVessel({...e,connectionPoints:[...e.connectionPoints,t]})}startCpEdit(e,n){this.editingCpIdx.set(e),this.editingCp={...n}}saveCpEdit(e,n){const t=[...e.connectionPoints];t[n]={...this.editingCp},this.modelState.updateVessel({...e,connectionPoints:t}),this.editingCpIdx.set(null)}cancelCpEdit(){this.editingCpIdx.set(null)}deleteCp(e,n){const t=e.connectionPoints.filter((e,t)=>t!==n);this.modelState.updateVessel({...e,connectionPoints:t})}openImportDialog(e){this.importTargetVesselId=e.id,this.showImportDialog=!0}handleConnectionPointsImport(e){if(!this.importTargetVesselId)return;const n=this.vessels().find(e=>e.id===this.importTargetVesselId);n&&(this.modelState.updateVessel({...n,connectionPoints:[...n.connectionPoints,...e]}),this.modelState.addLog("success",`Imported ${e.length} connection point(s)`),this.importTargetVesselId=null)}};c=function(e,n,t,s){var i,o=arguments.length,a=o<3?n:null===s?s=Object.getOwnPropertyDescriptor(n,t):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,n,t,s);else for(var r=e.length-1;r>=0;r--)(i=e[r])&&(a=(o<3?i(a):o>3?i(n,t,a):i(n,t))||a);return o>3&&a&&Object.defineProperty(n,t,a),a}([(0,s.Component)({selector:"orcaflex-vessel-section",standalone:!0,imports:[i.CommonModule,o.FormsModule,d.q],template:'\n    <div class="section-content">\n      \x3c!-- Toolbar --\x3e\n      <div class="toolbar">\n        <button class="toolbar-btn" (click)="addVessel()" title="Add new vessel">\n          <span class="icon">+</span> Add\n        </button>\n        <button class="toolbar-btn" (click)="fileInput.click()" title="Import vessel from OrcaFlex YAML">\n          Import\n        </button>\n        <input\n          #fileInput\n          type="file"\n          accept=".yml,.yaml"\n          style="display: none"\n          (change)="onFileSelected($event)"\n        />\n      </div>\n\n      \x3c!-- Vessel List --\x3e\n      @for (vessel of vessels(); track vessel.id) {\n        <div\n          class="vessel-item"\n          [class.selected]="selectedVesselId() === vessel.id"\n        >\n          <div class="vessel-header" (click)="selectVessel(vessel.id)">\n            <span class="vessel-name">{{ vessel.name }}</span>\n            <button class="delete-btn" (click)="deleteVessel(vessel.id); $event.stopPropagation()" title="Delete vessel">×</button>\n          </div>\n          <div class="vessel-dims">\n            {{ vessel.length }}m × {{ vessel.breadth }}m × {{ vessel.depth }}m\n          </div>\n\n          @if (selectedVesselId() === vessel.id) {\n            <div class="vessel-details" (click)="$event.stopPropagation()">\n              \x3c!-- Name --\x3e\n              <div class="form-group">\n                <label>Name</label>\n                <input type="text" [ngModel]="vessel.name"\n                  (ngModelChange)="updateVesselName(vessel, $event)" />\n              </div>\n\n              \x3c!-- Dimensions --\x3e\n              <div class="form-row">\n                <div class="form-group third">\n                  <label>Length (m)</label>\n                  <input type="number" [ngModel]="vessel.length"\n                    (ngModelChange)="updateVesselDimension(vessel, \'length\', $event)" />\n                </div>\n                <div class="form-group third">\n                  <label>Breadth (m)</label>\n                  <input type="number" [ngModel]="vessel.breadth"\n                    (ngModelChange)="updateVesselDimension(vessel, \'breadth\', $event)" />\n                </div>\n                <div class="form-group third">\n                  <label>Depth (m)</label>\n                  <input type="number" [ngModel]="vessel.depth"\n                    (ngModelChange)="updateVesselDimension(vessel, \'depth\', $event)" />\n                </div>\n              </div>\n\n              <div class="form-group">\n                <label>Draft (m)</label>\n                <input type="number" [ngModel]="vessel.draft"\n                  (ngModelChange)="updateVesselDimension(vessel, \'draft\', $event)" />\n              </div>\n\n              \x3c!-- Position --\x3e\n              <div class="subsection-title">Position</div>\n              <div class="form-row">\n                <div class="form-group third">\n                  <label>X</label>\n                  <input type="number" [ngModel]="vessel.position.x"\n                    (ngModelChange)="updateVesselPosition(vessel, \'x\', $event)" />\n                </div>\n                <div class="form-group third">\n                  <label>Y</label>\n                  <input type="number" [ngModel]="vessel.position.y"\n                    (ngModelChange)="updateVesselPosition(vessel, \'y\', $event)" />\n                </div>\n                <div class="form-group third">\n                  <label>Z</label>\n                  <input type="number" [ngModel]="vessel.position.z"\n                    (ngModelChange)="updateVesselPosition(vessel, \'z\', $event)" />\n                </div>\n              </div>\n\n              \x3c!-- Orientation --\x3e\n              <div class="subsection-title">Orientation</div>\n              <div class="form-row">\n                <div class="form-group third">\n                  <label>Heading (°)</label>\n                  <input type="number" [ngModel]="vessel.orientation.heading"\n                    (ngModelChange)="updateVesselOrientation(vessel, \'heading\', $event)" />\n                </div>\n                <div class="form-group third">\n                  <label>Roll (°)</label>\n                  <input type="number" [ngModel]="vessel.orientation.roll"\n                    (ngModelChange)="updateVesselOrientation(vessel, \'roll\', $event)" />\n                </div>\n                <div class="form-group third">\n                  <label>Pitch (°)</label>\n                  <input type="number" [ngModel]="vessel.orientation.pitch"\n                    (ngModelChange)="updateVesselOrientation(vessel, \'pitch\', $event)" />\n                </div>\n              </div>\n\n              \x3c!-- Connection Points --\x3e\n              <div class="connection-points">\n                <div class="cp-header">\n                  <span>Connection Points</span>\n                  <div class="cp-actions">\n                    <button class="import-cp-btn" (click)="openImportDialog(vessel); $event.stopPropagation()" title="Import from Excel">\n                      Import\n                    </button>\n                    <button class="add-cp-btn" (click)="addConnectionPoint(vessel); $event.stopPropagation()">+</button>\n                  </div>\n                </div>\n                @for (cp of vessel.connectionPoints; track cp.id; let idx = $index) {\n                  <div class="cp-row" [class.editing]="editingCpIdx() === idx">\n                    @if (editingCpIdx() === idx) {\n                      <input type="text" class="cp-input name" [(ngModel)]="editingCp.name" placeholder="Name" />\n                      <input type="number" class="cp-input coord" [(ngModel)]="editingCp.x" placeholder="X" />\n                      <input type="number" class="cp-input coord" [(ngModel)]="editingCp.y" placeholder="Y" />\n                      <input type="number" class="cp-input coord" [(ngModel)]="editingCp.z" placeholder="Z" />\n                      <button class="icon-btn save" (click)="saveCpEdit(vessel, idx); $event.stopPropagation()">✓</button>\n                      <button class="icon-btn cancel" (click)="cancelCpEdit(); $event.stopPropagation()">✕</button>\n                    } @else {\n                      <span class="cp-name">{{ cp.name }}</span>\n                      <span class="cp-coords">({{ cp.x }}, {{ cp.y }}, {{ cp.z }})</span>\n                      <button class="icon-btn edit" (click)="startCpEdit(idx, cp); $event.stopPropagation()">✎</button>\n                      <button class="icon-btn delete" (click)="deleteCp(vessel, idx); $event.stopPropagation()">×</button>\n                    }\n                  </div>\n                }\n                @if (vessel.connectionPoints.length === 0) {\n                  <div class="no-cp">No connection points defined</div>\n                }\n              </div>\n            </div>\n          }\n        </div>\n      }\n\n      @if (vessels().length === 0) {\n        <div class="empty-state">\n          <p>No vessels defined</p>\n          <p class="hint">Add a vessel or import from OrcaFlex YAML</p>\n        </div>\n      }\n\n      \x3c!-- Import status --\x3e\n      @if (importing()) {\n        <div class="import-status">\n          Importing vessel from YAML...\n        </div>\n      }\n\n      \x3c!-- Connection Points Import Dialog --\x3e\n      <orcaflex-connection-points-import-dialog\n        [(visible)]="showImportDialog"\n        (import)="handleConnectionPointsImport($event)"\n      />\n    </div>\n  ',styles:["\n    .section-content {\n      padding: 8px;\n    }\n\n    .toolbar {\n      display: flex;\n      gap: 8px;\n      margin-bottom: 12px;\n    }\n\n    .toolbar-btn {\n      flex: 1;\n      padding: 6px 12px;\n      border: 1px solid var(--caris-border-light, #ddd);\n      border-radius: 4px;\n      background: white;\n      font-size: 11px;\n      cursor: pointer;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      gap: 4px;\n    }\n\n    .toolbar-btn:hover {\n      background: var(--caris-bg-subtle, #f5f5f5);\n      border-color: var(--caris-primary, #1976d2);\n    }\n\n    .toolbar-btn .icon {\n      font-weight: bold;\n    }\n\n    .vessel-item {\n      border: 1px solid var(--caris-border-light, #ddd);\n      border-radius: 4px;\n      margin-bottom: 8px;\n      cursor: pointer;\n      transition: border-color 0.2s;\n      overflow: hidden;\n    }\n\n    .vessel-item:hover {\n      border-color: var(--caris-primary, #1976d2);\n    }\n\n    .vessel-item.selected {\n      border-color: var(--caris-primary, #1976d2);\n      background: var(--caris-bg-selected, #e3f2fd);\n    }\n\n    .vessel-header {\n      padding: 8px 12px;\n      display: flex;\n      justify-content: space-between;\n      align-items: center;\n    }\n\n    .vessel-name {\n      font-weight: 500;\n      font-size: 12px;\n    }\n\n    .delete-btn {\n      width: 20px;\n      height: 20px;\n      border: none;\n      background: transparent;\n      color: var(--caris-text-secondary, #999);\n      font-size: 16px;\n      cursor: pointer;\n      border-radius: 3px;\n    }\n\n    .delete-btn:hover {\n      background: #ffebee;\n      color: var(--caris-error, #f44336);\n    }\n\n    .vessel-dims {\n      padding: 0 12px 8px;\n      font-size: 11px;\n      color: var(--caris-text-secondary, #666);\n    }\n\n    .vessel-details {\n      padding: 12px;\n      border-top: 1px solid var(--caris-border-light, #eee);\n      background: var(--caris-bg-subtle, #fafafa);\n    }\n\n    .form-group {\n      margin-bottom: 10px;\n    }\n\n    .form-group label {\n      display: block;\n      font-size: 10px;\n      color: var(--caris-text-secondary, #666);\n      margin-bottom: 2px;\n    }\n\n    .form-group input {\n      width: 100%;\n      padding: 5px 6px;\n      border: 1px solid var(--caris-border-light, #ddd);\n      border-radius: 4px;\n      font-size: 12px;\n      background: white;\n    }\n\n    .form-group input:focus {\n      outline: none;\n      border-color: var(--caris-primary, #1976d2);\n    }\n\n    .form-row {\n      display: flex;\n      gap: 6px;\n    }\n\n    .form-group.third {\n      flex: 1;\n    }\n\n    .subsection-title {\n      font-size: 10px;\n      font-weight: 600;\n      text-transform: uppercase;\n      color: var(--caris-text-secondary, #666);\n      margin: 12px 0 6px 0;\n      padding-top: 8px;\n      border-top: 1px solid var(--caris-border-light, #eee);\n    }\n\n    .connection-points {\n      margin-top: 12px;\n      padding-top: 8px;\n      border-top: 1px solid var(--caris-border-light, #eee);\n    }\n\n    .cp-header {\n      display: flex;\n      justify-content: space-between;\n      align-items: center;\n      font-size: 10px;\n      font-weight: 600;\n      text-transform: uppercase;\n      color: var(--caris-text-secondary, #666);\n      margin-bottom: 8px;\n    }\n\n    .cp-actions {\n      display: flex;\n      gap: 4px;\n      align-items: center;\n    }\n\n    .import-cp-btn {\n      padding: 2px 6px;\n      border: 1px solid var(--caris-primary, #1976d2);\n      border-radius: 3px;\n      background: transparent;\n      color: var(--caris-primary, #1976d2);\n      font-size: 9px;\n      cursor: pointer;\n      text-transform: none;\n      font-weight: 500;\n    }\n\n    .import-cp-btn:hover {\n      background: var(--caris-primary, #1976d2);\n      color: white;\n    }\n\n    .add-cp-btn {\n      width: 20px;\n      height: 20px;\n      border: 1px dashed var(--caris-border-light, #ddd);\n      border-radius: 3px;\n      background: transparent;\n      color: var(--caris-text-secondary, #666);\n      font-size: 14px;\n      cursor: pointer;\n    }\n\n    .add-cp-btn:hover {\n      border-color: var(--caris-primary, #1976d2);\n      color: var(--caris-primary, #1976d2);\n    }\n\n    .cp-row {\n      display: flex;\n      align-items: center;\n      gap: 6px;\n      padding: 4px 0;\n      font-size: 11px;\n    }\n\n    .cp-row.editing {\n      padding: 6px 0;\n    }\n\n    .cp-name {\n      flex: 1;\n      font-weight: 500;\n    }\n\n    .cp-coords {\n      color: var(--caris-text-secondary, #666);\n      font-family: monospace;\n      font-size: 10px;\n    }\n\n    .cp-input {\n      padding: 3px 4px;\n      border: 1px solid var(--caris-border-light, #ddd);\n      border-radius: 3px;\n      font-size: 10px;\n    }\n\n    .cp-input.name {\n      width: 60px;\n    }\n\n    .cp-input.coord {\n      width: 40px;\n      text-align: right;\n    }\n\n    .icon-btn {\n      width: 18px;\n      height: 18px;\n      padding: 0;\n      border: none;\n      border-radius: 3px;\n      background: transparent;\n      cursor: pointer;\n      font-size: 12px;\n      line-height: 1;\n    }\n\n    .icon-btn:hover {\n      background: var(--caris-bg-hover, #f0f0f0);\n    }\n\n    .icon-btn.edit {\n      color: var(--caris-primary, #1976d2);\n    }\n\n    .icon-btn.delete {\n      color: var(--caris-error, #f44336);\n    }\n\n    .icon-btn.save {\n      color: var(--caris-success, #4caf50);\n    }\n\n    .icon-btn.cancel {\n      color: var(--caris-text-secondary, #666);\n    }\n\n    .no-cp {\n      font-size: 11px;\n      color: var(--caris-text-tertiary, #999);\n      font-style: italic;\n      padding: 4px 0;\n    }\n\n    .empty-state {\n      text-align: center;\n      padding: 24px;\n      color: var(--caris-text-secondary, #999);\n    }\n\n    .empty-state p {\n      margin: 0 0 4px 0;\n      font-size: 12px;\n    }\n\n    .empty-state .hint {\n      font-size: 11px;\n      color: var(--caris-text-tertiary, #bbb);\n    }\n\n    .import-status {\n      text-align: center;\n      padding: 8px;\n      background: var(--caris-bg-subtle, #f5f5f5);\n      border-radius: 4px;\n      font-size: 11px;\n      color: var(--caris-text-secondary, #666);\n    }\n  "]})],c)},2945(e,n,t){t.d(n,{D_:()=>o,hr:()=>i,lP:()=>s,lm:()=>a});const s={min:{x:-200,y:-100,z:-300},max:{x:400,y:100,z:50}},i={side:{position:{x:500,y:0,z:0},up:{x:0,y:0,z:1}},top:{position:{x:0,y:0,z:500},up:{x:0,y:1,z:0}},front:{position:{x:0,y:-500,z:0},up:{x:0,y:0,z:1}},iso:{position:{x:400,y:-400,z:300},up:{x:0,y:0,z:1}}},o=[16739125,48340,5025616,16750592,10233776,2201331],a={water:27028,seabed:9139029,vessel:8421504,vesselCOG:16724838,cdp:255,tdp:16771899,grid:8947848,catenary:16711680,buoyancy:65280}},3413(e,n,t){t.d(n,{W:()=>o});var s=t(4087),i=t(3574);let o=class{_model=(0,s.signal)(this.createEmptyModel());_selectedRiserId=(0,s.signal)(null);_selectedVesselId=(0,s.signal)(null);_isCalculating=(0,s.signal)(!1);_isDirty=(0,s.signal)(!1);_undoStack=(0,s.signal)([]);_redoStack=(0,s.signal)([]);MAX_HISTORY=50;_logs=(0,s.signal)([]);_validationResult=(0,s.signal)(null);model=this._model.asReadonly();selectedRiserId=this._selectedRiserId.asReadonly();selectedVesselId=this._selectedVesselId.asReadonly();isCalculating=this._isCalculating.asReadonly();isDirty=this._isDirty.asReadonly();logs=this._logs.asReadonly();validationResult=this._validationResult.asReadonly();environment=(0,s.computed)(()=>this._model().environment);vessels=(0,s.computed)(()=>this._model().vessels);lineTypes=(0,s.computed)(()=>this._model().lineTypes);buoyancyModules=(0,s.computed)(()=>this._model().buoyancyModules);risers=(0,s.computed)(()=>this._model().risers);selectedRiser=(0,s.computed)(()=>{const e=this._selectedRiserId();return e?this._model().risers.find(n=>n.id===e)??null:null});selectedVessel=(0,s.computed)(()=>{const e=this._selectedVesselId();return e?this._model().vessels.find(n=>n.id===e)??null:null});canUndo=(0,s.computed)(()=>this._undoStack().length>0);canRedo=(0,s.computed)(()=>this._redoStack().length>0);riserCount=(0,s.computed)(()=>this._model().risers.length);vesselCount=(0,s.computed)(()=>this._model().vessels.length);newModel(){this._model.set(this.createEmptyModel()),this._selectedRiserId.set(null),this._selectedVesselId.set(null),this._undoStack.set([]),this._redoStack.set([]),this._isDirty.set(!1),this.addLog("info","New model created")}loadModel(e){this._model.set(e),this._selectedRiserId.set(null),this._selectedVesselId.set(null),this._undoStack.set([]),this._redoStack.set([]),this._isDirty.set(!1),this.addLog("success",`Model "${e.name}" loaded`)}updateEnvironment(e){const n=this._model().environment;this.pushUndoAction({type:"UPDATE_ENVIRONMENT",previous:n,current:e}),this._model.update(n=>({...n,environment:e,updatedAt:new Date})),this._isDirty.set(!0)}addVessel(e){this.pushUndoAction({type:"ADD_VESSEL",vessel:e}),this._model.update(n=>({...n,vessels:[...n.vessels,e],updatedAt:new Date})),this._isDirty.set(!0),this.addLog("info",`Vessel "${e.name}" added`)}updateVessel(e){const n=this._model().vessels.find(n=>n.id===e.id);n&&this.pushUndoAction({type:"UPDATE_VESSEL",previous:n,current:e}),this._model.update(n=>({...n,vessels:n.vessels.map(n=>n.id===e.id?e:n),updatedAt:new Date})),this._isDirty.set(!0)}deleteVessel(e){const n=this._model().vessels.find(n=>n.id===e);n&&(this.pushUndoAction({type:"DELETE_VESSEL",vessel:n}),this._model.update(n=>({...n,vessels:n.vessels.filter(n=>n.id!==e),updatedAt:new Date})),this._selectedVesselId()===e&&this._selectedVesselId.set(null),this._isDirty.set(!0),this.addLog("info",`Vessel "${n.name}" deleted`))}addLineType(e){this.pushUndoAction({type:"ADD_LINE_TYPE",lineType:e}),this._model.update(n=>({...n,lineTypes:[...n.lineTypes,e],updatedAt:new Date})),this._isDirty.set(!0),this.addLog("info",`Line type "${e.name}" added`)}updateLineType(e){const n=this._model().lineTypes.find(n=>n.id===e.id);n&&this.pushUndoAction({type:"UPDATE_LINE_TYPE",previous:n,current:e}),this._model.update(n=>({...n,lineTypes:n.lineTypes.map(n=>n.id===e.id?e:n),updatedAt:new Date})),this._isDirty.set(!0)}deleteLineType(e){const n=this._model().lineTypes.find(n=>n.id===e);n&&(this.pushUndoAction({type:"DELETE_LINE_TYPE",lineType:n}),this._model.update(n=>({...n,lineTypes:n.lineTypes.filter(n=>n.id!==e),updatedAt:new Date})),this._isDirty.set(!0),this.addLog("info",`Line type "${n.name}" deleted`))}addBuoyancyModule(e){this._model.update(n=>({...n,buoyancyModules:[...n.buoyancyModules,e],updatedAt:new Date})),this._isDirty.set(!0),this.addLog("info",`Buoyancy module "${e.name}" added`)}updateBuoyancyModule(e){this._model.update(n=>({...n,buoyancyModules:n.buoyancyModules.map(n=>n.id===e.id?e:n),updatedAt:new Date})),this._isDirty.set(!0)}deleteBuoyancyModule(e){const n=this._model().buoyancyModules.find(n=>n.id===e);n&&(this._model.update(n=>({...n,buoyancyModules:n.buoyancyModules.filter(n=>n.id!==e),updatedAt:new Date})),this._isDirty.set(!0),this.addLog("info",`Buoyancy module "${n.name}" deleted`))}addRiser(e){this.pushUndoAction({type:"ADD_RISER",riser:e}),this._model.update(n=>({...n,risers:[...n.risers,e],updatedAt:new Date})),this._isDirty.set(!0),this.addLog("info",`Riser "${e.name}" added`)}updateRiser(e){const n=this._model().risers.find(n=>n.id===e.id);n&&this.pushUndoAction({type:"UPDATE_RISER",previous:n,current:e}),this._model.update(n=>({...n,risers:n.risers.map(n=>n.id===e.id?e:n),updatedAt:new Date})),this._isDirty.set(!0)}deleteRiser(e){const n=this._model().risers.find(n=>n.id===e);n&&(this.pushUndoAction({type:"DELETE_RISER",riser:n}),this._model.update(n=>({...n,risers:n.risers.filter(n=>n.id!==e),updatedAt:new Date})),this._selectedRiserId()===e&&this._selectedRiserId.set(null),this._isDirty.set(!0),this.addLog("info",`Riser "${n.name}" deleted`))}selectRiser(e){this._selectedRiserId.set(e)}selectVessel(e){this._selectedVesselId.set(e)}undo(){const e=this._undoStack();if(0===e.length)return;const n=e[e.length-1];this._undoStack.update(e=>e.slice(0,-1)),this._redoStack.update(e=>[...e,n]),this.applyUndoAction(n),this._isDirty.set(!0),this.addLog("info","Undo performed")}redo(){const e=this._redoStack();if(0===e.length)return;const n=e[e.length-1];this._redoStack.update(e=>e.slice(0,-1)),this._undoStack.update(e=>[...e,n]),this.applyRedoAction(n),this._isDirty.set(!0),this.addLog("info","Redo performed")}setCalculating(e){this._isCalculating.set(e)}setValidationResult(e){this._validationResult.set(e)}addLog(e,n,t){const s={id:crypto.randomUUID(),timestamp:new Date,level:e,message:n,details:t};this._logs.update(e=>[...e.slice(-99),s])}clearLogs(){this._logs.set([])}createEmptyModel(){return{id:crypto.randomUUID(),name:"New Model",createdAt:new Date,updatedAt:new Date,environment:{...i.Uz},vessels:[{...i.ts}],lineTypes:i.R9.map(e=>({...e})),buoyancyModules:[{...i.qN}],risers:[]}}pushUndoAction(e){this._undoStack.update(n=>{const t=[...n,e];return t.length>this.MAX_HISTORY?t.slice(-this.MAX_HISTORY):t}),this._redoStack.set([])}applyUndoAction(e){switch(e.type){case"UPDATE_ENVIRONMENT":this._model.update(n=>({...n,environment:e.previous}));break;case"ADD_VESSEL":this._model.update(n=>({...n,vessels:n.vessels.filter(n=>n.id!==e.vessel.id)}));break;case"UPDATE_VESSEL":this._model.update(n=>({...n,vessels:n.vessels.map(n=>n.id===e.previous.id?e.previous:n)}));break;case"DELETE_VESSEL":this._model.update(n=>({...n,vessels:[...n.vessels,e.vessel]}));break;case"ADD_LINE_TYPE":this._model.update(n=>({...n,lineTypes:n.lineTypes.filter(n=>n.id!==e.lineType.id)}));break;case"UPDATE_LINE_TYPE":this._model.update(n=>({...n,lineTypes:n.lineTypes.map(n=>n.id===e.previous.id?e.previous:n)}));break;case"DELETE_LINE_TYPE":this._model.update(n=>({...n,lineTypes:[...n.lineTypes,e.lineType]}));break;case"ADD_RISER":this._model.update(n=>({...n,risers:n.risers.filter(n=>n.id!==e.riser.id)}));break;case"UPDATE_RISER":this._model.update(n=>({...n,risers:n.risers.map(n=>n.id===e.previous.id?e.previous:n)}));break;case"DELETE_RISER":this._model.update(n=>({...n,risers:[...n.risers,e.riser]}))}}applyRedoAction(e){switch(e.type){case"UPDATE_ENVIRONMENT":this._model.update(n=>({...n,environment:e.current}));break;case"ADD_VESSEL":this._model.update(n=>({...n,vessels:[...n.vessels,e.vessel]}));break;case"UPDATE_VESSEL":this._model.update(n=>({...n,vessels:n.vessels.map(n=>n.id===e.current.id?e.current:n)}));break;case"DELETE_VESSEL":this._model.update(n=>({...n,vessels:n.vessels.filter(n=>n.id!==e.vessel.id)}));break;case"ADD_LINE_TYPE":this._model.update(n=>({...n,lineTypes:[...n.lineTypes,e.lineType]}));break;case"UPDATE_LINE_TYPE":this._model.update(n=>({...n,lineTypes:n.lineTypes.map(n=>n.id===e.current.id?e.current:n)}));break;case"DELETE_LINE_TYPE":this._model.update(n=>({...n,lineTypes:n.lineTypes.filter(n=>n.id!==e.lineType.id)}));break;case"ADD_RISER":this._model.update(n=>({...n,risers:[...n.risers,e.riser]}));break;case"UPDATE_RISER":this._model.update(n=>({...n,risers:n.risers.map(n=>n.id===e.current.id?e.current:n)}));break;case"DELETE_RISER":this._model.update(n=>({...n,risers:n.risers.filter(n=>n.id!==e.riser.id)}))}}};o=function(e,n,t,s){var i,o=arguments.length,a=o<3?n:null===s?s=Object.getOwnPropertyDescriptor(n,t):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,n,t,s);else for(var r=e.length-1;r>=0;r--)(i=e[r])&&(a=(o<3?i(a):o>3?i(n,t,a):i(n,t))||a);return o>3&&a&&Object.defineProperty(n,t,a),a}([(0,s.Injectable)({providedIn:"root"})],o)},3574(e,n,t){t.d(n,{H5:()=>o.H5,MB:()=>o.MB,Ny:()=>o.Ny,R9:()=>o.R9,Uz:()=>s.U,XT:()=>a.X,aW:()=>o.aW,bl:()=>o.bl,hY:()=>o.hY,od:()=>o.od,qN:()=>o.qN,ts:()=>i.t,uU:()=>o.uU});var s=t(8280),i=t(7849),o=t(5084),a=t(6012)},3591(e,n,t){t.d(n,{$d:()=>i.$,L5:()=>a.L,Y0:()=>o.Y,aG:()=>s.a,i_:()=>l.i,rW:()=>r.r});var s=t(9097),i=t(2939),o=t(303),a=t(1463),r=t(5305),l=t(2873)},3858(e,n,t){t.r(n),t.d(n,{OrcaFlexRiserModule:()=>a,default:()=>r});var s=t(1142),i=t(3413),o=t(295);class a{name="orcaflex-riser-module";version="1.0.0";component=s.B;context=null;modelState=null;apiService=null;async onInit(e){this.context=e,this.modelState=e.injector.get(i.W),this.apiService=e.injector.get(o.C),this.apiService.setApiService(e.services.api),e.config&&this.applyConfig(e.config),console.log("[OrcaFlex Module] Initialized")}async onDestroy(){this.context=null,this.modelState=null,this.apiService=null,console.log("[OrcaFlex Module] Destroyed")}onActivate(){console.log("[OrcaFlex Module] Activated")}onDeactivate(){console.log("[OrcaFlex Module] Deactivated")}onRibbonAction(e){if(this.modelState&&this.context)switch(e){case"newModel":this.modelState.newModel(),this.context.services.notifications.info("New model created");break;case"importYaml":this.handleImportYaml();break;case"exportYaml":this.handleExportYaml();break;case"undo":this.modelState.canUndo()&&this.modelState.undo();break;case"redo":this.modelState.canRedo()&&this.modelState.redo();break;case"calculateAll":this.handleCalculateAll();break;case"validateModel":this.handleValidateModel();break;case"goalSeek":this.handleGoalSeek();break;case"resetView":case"topView":case"sideView":case"frontView":case"zoomToFit":console.log(`[OrcaFlex Module] View action: ${e}`);break;case"openDocs":window.open("https://docs.carispro.com/modules/orcaflex-riser","_blank");break;case"showAbout":this.showAboutDialog();break;case"closeModule":this.modelState.isDirty()&&this.context.services.dialogs.confirm({title:"Unsaved Changes",message:"You have unsaved changes. Are you sure you want to close?"}).then(e=>{});break;default:console.warn(`[OrcaFlex Module] Unknown ribbon action: ${e}`)}}onSidebarAction(e,n){console.log(`[OrcaFlex Module] Sidebar action: ${e}/${n}`)}applyConfig(e){if(this.modelState){if(e.defaultWaterDepth){const n=this.modelState.environment();this.modelState.updateEnvironment({...n,sea:{...n.sea,waterDepth:e.defaultWaterDepth}})}e.showDebugInfo&&this.modelState.addLog("info","Debug mode enabled")}}async handleImportYaml(){const e=await(this.context?.services.dialogs.fileUpload({title:"Import OrcaFlex YAML",accept:".yml,.yaml"}));if(e?.file){const n=await e.file.text();try{const e=await this.apiService.parseYaml(n);e.success&&e.model?this.context?.services.notifications.success("YAML imported successfully"):this.context?.services.notifications.error("Failed to parse YAML")}catch(e){this.context?.services.notifications.error("Import failed")}}}async handleExportYaml(){if(this.modelState&&this.apiService)try{const e=this.modelState.model(),n=await this.apiService.downloadYaml({model:e}),t=URL.createObjectURL(n),s=document.createElement("a");s.href=t,s.download=`${e.name.replace(/\s+/g,"_")}.yml`,s.click(),URL.revokeObjectURL(t),this.context?.services.notifications.success("YAML exported successfully")}catch(e){this.context?.services.notifications.error("Export failed")}}async handleCalculateAll(){if(!this.modelState)return;const e=this.modelState.risers();this.modelState.addLog("info",`Calculating ${e.length} risers...`),this.context?.services.notifications.info("Starting calculations...")}async handleValidateModel(){if(this.modelState&&this.apiService)try{const e=this.modelState.model(),n=await this.apiService.validateModel(e);this.modelState.setValidationResult(n),n.valid?this.context?.services.notifications.success("Model is valid"):this.context?.services.notifications.warning(`Model has ${n.errors.length} errors and ${n.warnings.length} warnings`)}catch(e){this.context?.services.notifications.error("Validation failed")}}handleGoalSeek(){this.context?.services.notifications.info("Goal Seek coming in Phase 5")}showAboutDialog(){this.context?.services.dialogs.info({title:"About OrcaFlex Riser Analysis",message:`\nOrcaFlex Riser Analysis Module v${this.version}\n\nAutomated OrcaFlex model generation for riser analysis.\nProvides interactive 3D visualization, parameter-driven input,\ngoal-seeking calculations, and direct export to OrcaFlex YAML format.\n\n© 2024 CARIS Pro. All rights reserved.\n      `.trim()})}}const r=a},4532(e,n,t){t.d(n,{q:()=>u});var s=t(4087),i=t(7493),o=t(1795),a=t(5254),r=t(6882),l=t(5154),d=t(1711),c=function(e,n,t,s){var i,o=arguments.length,a=o<3?n:null===s?s=Object.getOwnPropertyDescriptor(n,t):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,n,t,s);else for(var r=e.length-1;r>=0;r--)(i=e[r])&&(a=(o<3?i(a):o>3?i(n,t,a):i(n,t))||a);return o>3&&a&&Object.defineProperty(n,t,a),a},p=function(e,n){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,n)};let u=class{visible=!1;visibleChange=new s.EventEmitter;import=new s.EventEmitter;rows=(0,s.signal)([{name:"",x:0,y:0,z:0}]);handlePaste(e){e.preventDefault();const n=e.clipboardData;if(!n)return;const t=n.getData("text");if(!t)return;const s=this.parseExcelData(t);s.length>0&&this.rows.set(s)}handleKeydown(e){!e.ctrlKey&&!e.metaKey||e.key}parseExcelData(e){const n=[],t=e.trim().split("\n");for(const e of t){const t=e.split(/\t|(?:  +)/);if(t.length>=4){const e=t[0]?.trim()||"",s=parseFloat(t[1])||0,i=parseFloat(t[2])||0,o=parseFloat(t[3])||0;n.push({name:e,x:s,y:i,z:o})}else t.length>=1&&t[0]?.trim()&&n.push({name:t[0]?.trim()||"",x:parseFloat(t[1])||0,y:parseFloat(t[2])||0,z:parseFloat(t[3])||0})}return n}addRow(){const e=this.rows(),n=e.length+1;this.rows.set([...e,{name:`CP${n}`,x:0,y:0,z:0}])}clearRows(){this.rows.set([{name:"",x:0,y:0,z:0}])}hasValidData(){return this.rows().some(e=>""!==e.name.trim())}getValidRowCount(){return this.rows().filter(e=>""!==e.name.trim()).length}onImport(){const e=this.rows().filter(e=>""!==e.name.trim()).map(e=>({id:crypto.randomUUID(),name:e.name.trim(),x:e.x,y:e.y,z:e.z}));this.import.emit(e),this.close()}onCancel(){this.close()}close(){this.visible=!1,this.visibleChange.emit(!1),this.rows.set([{name:"",x:0,y:0,z:0}])}};c([(0,s.Input)(),p("design:type",Object)],u.prototype,"visible",void 0),c([(0,s.Output)(),p("design:type",Object)],u.prototype,"visibleChange",void 0),c([(0,s.Output)(),p("design:type",Object)],u.prototype,"import",void 0),u=c([(0,s.Component)({selector:"orcaflex-connection-points-import-dialog",standalone:!0,imports:[i.CommonModule,o.FormsModule,a.Ph,r.bG,l.tm,d.um],template:'\n    <p-dialog\n      header="Import Connection Points"\n      [visible]="visible"\n      [modal]="true"\n      [closable]="true"\n      [draggable]="false"\n      [resizable]="false"\n      [style]="{ width: \'600px\' }"\n      styleClass="import-dialog"\n      (onHide)="onCancel()"\n    >\n      <div class="dialog-content">\n        <div class="paste-instructions">\n          <p>Paste data from Excel with 4 columns: <strong>Connection Name, X, Y, Z</strong></p>\n          <p class="hint">Click in the table and press Ctrl+V (Cmd+V on Mac) to paste</p>\n        </div>\n\n        <div\n          class="table-container"\n          tabindex="0"\n          (paste)="handlePaste($event)"\n          (keydown)="handleKeydown($event)"\n        >\n          <p-table [value]="rows()" [tableStyle]="{ \'min-width\': \'100%\' }">\n            <ng-template pTemplate="header">\n              <tr>\n                <th style="width: 40%">Connection Name</th>\n                <th style="width: 20%">X (m)</th>\n                <th style="width: 20%">Y (m)</th>\n                <th style="width: 20%">Z (m)</th>\n              </tr>\n            </ng-template>\n            <ng-template pTemplate="body" let-row let-rowIndex="rowIndex">\n              <tr>\n                <td>\n                  <input\n                    type="text"\n                    pInputText\n                    [(ngModel)]="row.name"\n                    placeholder="CP Name"\n                    class="table-input"\n                  />\n                </td>\n                <td>\n                  <input\n                    type="number"\n                    pInputText\n                    [(ngModel)]="row.x"\n                    placeholder="0"\n                    class="table-input coord"\n                  />\n                </td>\n                <td>\n                  <input\n                    type="number"\n                    pInputText\n                    [(ngModel)]="row.y"\n                    placeholder="0"\n                    class="table-input coord"\n                  />\n                </td>\n                <td>\n                  <input\n                    type="number"\n                    pInputText\n                    [(ngModel)]="row.z"\n                    placeholder="0"\n                    class="table-input coord"\n                  />\n                </td>\n              </tr>\n            </ng-template>\n            <ng-template pTemplate="emptymessage">\n              <tr>\n                <td colspan="4" class="empty-message">\n                  Paste Excel data here or add rows manually\n                </td>\n              </tr>\n            </ng-template>\n          </p-table>\n        </div>\n\n        <div class="row-actions">\n          <button class="action-btn add" (click)="addRow()">+ Add Row</button>\n          <button class="action-btn clear" (click)="clearRows()">Clear All</button>\n        </div>\n      </div>\n\n      <ng-template pTemplate="footer">\n        <div class="dialog-footer">\n          <button class="btn-secondary" (click)="onCancel()">Cancel</button>\n          <button class="btn-primary" (click)="onImport()" [disabled]="!hasValidData()">\n            Import {{ getValidRowCount() }} Connection Point{{ getValidRowCount() !== 1 ? \'s\' : \'\' }}\n          </button>\n        </div>\n      </ng-template>\n    </p-dialog>\n  ',styles:["\n    :host ::ng-deep .import-dialog .p-dialog {\n      background: white;\n    }\n\n    :host ::ng-deep .import-dialog .p-dialog-header {\n      background: white;\n      border-bottom: 1px solid #eee;\n      padding: 16px 20px;\n    }\n\n    :host ::ng-deep .import-dialog .p-dialog-content {\n      background: white;\n      padding: 20px;\n    }\n\n    :host ::ng-deep .import-dialog .p-dialog-footer {\n      background: white;\n      border-top: 1px solid #eee;\n      padding: 16px 20px;\n    }\n\n    :host ::ng-deep .p-dialog-mask {\n      background: rgba(0, 0, 0, 0.5);\n    }\n\n    .dialog-content {\n      padding: 0;\n    }\n\n    .paste-instructions {\n      margin-bottom: 16px;\n      padding: 12px;\n      background: #f5f5f5;\n      border-radius: 4px;\n    }\n\n    .paste-instructions p {\n      margin: 0;\n      font-size: 12px;\n      color: #333;\n    }\n\n    .paste-instructions .hint {\n      margin-top: 4px;\n      font-size: 11px;\n      color: #666;\n    }\n\n    .table-container {\n      border: 2px dashed #ddd;\n      border-radius: 4px;\n      padding: 4px;\n      outline: none;\n      transition: border-color 0.2s;\n      background: white;\n    }\n\n    .table-container:focus {\n      border-color: #1976d2;\n    }\n\n    :host ::ng-deep .p-datatable {\n      background: white;\n    }\n\n    :host ::ng-deep .p-datatable .p-datatable-header {\n      background: #fafafa;\n      border: none;\n    }\n\n    :host ::ng-deep .p-datatable .p-datatable-thead > tr > th {\n      background: #fafafa;\n      font-size: 11px;\n      font-weight: 600;\n      text-transform: uppercase;\n      color: #666;\n      padding: 8px;\n      border: none;\n      border-bottom: 1px solid #eee;\n    }\n\n    :host ::ng-deep .p-datatable .p-datatable-tbody > tr {\n      background: white;\n    }\n\n    :host ::ng-deep .p-datatable .p-datatable-tbody > tr > td {\n      padding: 4px;\n      border: none;\n      border-bottom: 1px solid #f0f0f0;\n      background: white;\n    }\n\n    :host ::ng-deep .p-datatable .p-datatable-tbody > tr:last-child > td {\n      border-bottom: none;\n    }\n\n    .table-input {\n      width: 100%;\n      padding: 6px 8px;\n      border: 1px solid #ddd;\n      border-radius: 4px;\n      font-size: 12px;\n      background: white;\n    }\n\n    .table-input:focus {\n      outline: none;\n      border-color: #1976d2;\n    }\n\n    .table-input.coord {\n      text-align: right;\n    }\n\n    .empty-message {\n      text-align: center;\n      padding: 24px;\n      color: #999;\n      font-style: italic;\n      background: white;\n    }\n\n    .row-actions {\n      display: flex;\n      gap: 8px;\n      margin-top: 12px;\n    }\n\n    .action-btn {\n      padding: 6px 12px;\n      border: 1px solid #ddd;\n      border-radius: 4px;\n      background: white;\n      font-size: 11px;\n      cursor: pointer;\n    }\n\n    .action-btn:hover {\n      background: #f5f5f5;\n    }\n\n    .action-btn.add {\n      color: #1976d2;\n      border-color: #1976d2;\n    }\n\n    .action-btn.clear {\n      color: #666;\n    }\n\n    .dialog-footer {\n      display: flex;\n      justify-content: flex-end;\n      gap: 8px;\n    }\n\n    .btn-secondary {\n      padding: 8px 16px;\n      border: 1px solid #ddd;\n      border-radius: 4px;\n      background: white;\n      font-size: 12px;\n      cursor: pointer;\n    }\n\n    .btn-secondary:hover {\n      background: #f5f5f5;\n    }\n\n    .btn-primary {\n      padding: 8px 16px;\n      border: none;\n      border-radius: 4px;\n      background: #1976d2;\n      color: white;\n      font-size: 12px;\n      cursor: pointer;\n    }\n\n    .btn-primary:hover:not(:disabled) {\n      background: #1565c0;\n    }\n\n    .btn-primary:disabled {\n      background: #ddd;\n      cursor: not-allowed;\n    }\n  "]})],u)},4677(e,n,t){t.d(n,{N:()=>p});var s=t(4087),i=t(7493),o=t(1795),a=t(3413),r=t(6291),l=t(5726),d=function(e,n,t,s){var i,o=arguments.length,a=o<3?n:null===s?s=Object.getOwnPropertyDescriptor(n,t):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,n,t,s);else for(var r=e.length-1;r>=0;r--)(i=e[r])&&(a=(o<3?i(a):o>3?i(n,t,a):i(n,t))||a);return o>3&&a&&Object.defineProperty(n,t,a),a},c=function(e,n){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,n)};let p=class{canvasRef;containerRef;viewHelperCanvasRef;modelState=(0,s.inject)(a.W);sceneManager=null;resizeObserver=null;viewHelper=null;viewHelperRenderer=null;clock=new l.Clock;globalCoordSystem=null;vesselCoordSystems=[];vesselGroups=[];connectionPointGroups=[];waterPlane=null;seabedPlane=null;gridHelper=null;currentView="iso";displayMenuOpen=(0,s.signal)(!1);showCoordinateSystems=(0,s.signal)(!0);showVessel=(0,s.signal)(!0);showConnectionPoints=(0,s.signal)(!0);showWater=(0,s.signal)(!0);showSeabed=(0,s.signal)(!0);showGrid=(0,s.signal)(!0);constructor(){(0,s.effect)(()=>{this.modelState.environment(),this.modelState.vessels(),this.modelState.risers(),this.sceneManager&&this.rebuildScene()})}ngOnInit(){this.sceneManager=new r.w}ngAfterViewInit(){const e=this.canvasRef.nativeElement;this.sceneManager.initialize(e),this.resizeObserver=new ResizeObserver(()=>{this.sceneManager?.onResize()}),this.resizeObserver.observe(e.parentElement),this.setupViewHelper(),this.rebuildScene(),this.sceneManager.startRenderLoop(()=>{this.renderViewHelper()}),window.addEventListener("keydown",this.handleKeydown.bind(this)),document.addEventListener("click",this.closeMenuOnOutsideClick.bind(this))}ngOnDestroy(){window.removeEventListener("keydown",this.handleKeydown.bind(this)),document.removeEventListener("click",this.closeMenuOnOutsideClick.bind(this)),this.resizeObserver?.disconnect(),this.sceneManager?.dispose(),this.viewHelper?.dispose(),this.viewHelperRenderer?.dispose()}setupViewHelper(){if(!this.sceneManager)return;const e=this.viewHelperCanvasRef.nativeElement;this.viewHelperRenderer=new l.WebGLRenderer({canvas:e,alpha:!0,antialias:!0}),this.viewHelperRenderer.setSize(128,128),this.viewHelperRenderer.setPixelRatio(window.devicePixelRatio);const n=this.sceneManager.getCamera();this.viewHelper=new r.sr(n),this.viewHelper.controls={center:this.sceneManager.getControlsTarget()},this.viewHelper.setDimension(128)}onViewHelperClick(e){if(!this.viewHelper||!this.sceneManager)return;const n=e.target.getBoundingClientRect(),t=e.clientX-n.left,s=e.clientY-n.top,i={clientX:n.right-(128-t),clientY:n.bottom-(128-s)};this.viewHelper.handleClick(i,this.viewHelperCanvasRef.nativeElement)}renderViewHelper(){if(this.viewHelper&&this.viewHelperRenderer){if(this.viewHelper.animating){const e=this.clock.getDelta();this.viewHelper.update(e)}this.showCoordinateSystems()?this.viewHelper.renderToCanvas(this.viewHelperRenderer):this.viewHelperRenderer.clear()}}closeMenuOnOutsideClick(e){e.target.closest(".dropdown")||this.displayMenuOpen.set(!1)}rebuildScene(){if(!this.sceneManager)return;this.sceneManager.clearObjects(),this.vesselCoordSystems=[],this.vesselGroups=[],this.connectionPointGroups=[];const e=this.modelState.environment(),n=this.modelState.vessels(),t=this.modelState.risers();this.waterPlane=(0,r.oq)(),this.waterPlane.visible=this.showWater(),this.sceneManager.add(this.waterPlane),this.seabedPlane=(0,r.hl)(e.sea.waterDepth),this.seabedPlane.visible=this.showSeabed(),this.sceneManager.add(this.seabedPlane),this.gridHelper=(0,r.Dv)(),this.gridHelper.visible=this.showGrid(),this.sceneManager.add(this.gridHelper),this.globalCoordSystem=(0,r.RG)(30),this.globalCoordSystem.visible=this.showCoordinateSystems(),this.sceneManager.add(this.globalCoordSystem),n.forEach(e=>{const n=(0,r.Q_)({length:e.length,breadth:e.breadth,depth:e.depth,draft:e.draft},e.position);n.rotation.z=(e.orientation?.heading??0)*Math.PI/180,n.visible=this.showVessel(),this.sceneManager.add(n),this.vesselGroups.push(n);const t=(0,r.sl)(15);t.position.set(e.position.x,e.position.y,e.position.z),t.rotation.z=(e.orientation?.heading??0)*Math.PI/180,t.visible=this.showCoordinateSystems(),this.sceneManager.add(t),this.vesselCoordSystems.push(t),e.connectionPoints.forEach(n=>{const t=(e.orientation?.heading??0)*Math.PI/180,s=Math.cos(t),i=Math.sin(t),o=e.position.x+(n.x*s-n.y*i),a=e.position.y+(n.x*i+n.y*s),l=e.position.z+n.z,d=(0,r.T3)({x:o,y:a,z:l},n.name);d.visible=this.showConnectionPoints(),this.sceneManager.add(d),this.connectionPointGroups.push(d)})}),console.log("Rendering risers:",t.length,t.map(e=>({name:e.name,hasResults:!!e.calculationResults,pointsCount:e.calculationResults?.points?.length}))),t.forEach((t,s)=>{if(!t.calculationResults)return void console.log(`Riser ${t.name}: no calculation results, skipping`);console.log(`Riser ${t.name}: rendering with ${t.calculationResults.points?.length||0} points`);const i=t.contents?.find(e=>e.id===t.activeContentId),o=i?.color??r.D_[s%r.D_.length],a=n.find(e=>e.id===t.vesselId),l=a?.connectionPoints.find(e=>e.id===t.connectionPointId),d=a?.orientation?.heading??0,c=(d+(t.geometry.azimuth??0))*Math.PI/180,p=d*Math.PI/180,u=Math.cos(p),h=Math.sin(p),m=(a?.position.x??0)+((l?.x??0)*u-(l?.y??0)*h),g=(a?.position.y??0)+((l?.x??0)*h+(l?.y??0)*u),b=(a?.position.z??0)+(l?.z??0);if("catenary"===t.geometry.type&&t.calculationResults.points.length>0){const n=(0,r.f_)(t.calculationResults.points,{color:o});if(n.position.set(m,g,b),n.rotation.z=c,this.sceneManager.add(n),t.calculationResults.tdpPosition){const n=t.calculationResults.tdpPosition.x,s=t.calculationResults.tdpPosition.y,i=Math.cos(c),a=Math.sin(c),l=m+(n*i-s*a),d=g+(n*a+s*i),p=(0,r.nB)(l,d,e.sea.waterDepth,o);this.sceneManager.add(p)}}else if("lazy-wave"===t.geometry.type&&t.calculationResults.points&&t.calculationResults.points.length>0){const n=t.calculationResults.points.map(e=>({x:e.x,y:0,z:e.z})),s=this.modelState.buoyancyModules().find(e=>e.id===t.buoyancyModuleId);console.log("Rendering lazy wave with",n.length,"points");const i=(0,r.$Z)(n,{color:o,buoyancyStartX:t.geometry.buoyancyStart,buoyancyEndX:t.geometry.buoyancyEnd,buoyancyStart:t.calculationResults.buoyancyStart,buoyancyEnd:t.calculationResults.buoyancyEnd,buoyancyModule:s?{outerDiameter:s.outerDiameter,length:s.length,numberOfModules:s.numberOfModules,spacing:s.spacing}:void 0});if(i.position.set(m,g,b),i.rotation.z=c,this.sceneManager.add(i),t.calculationResults.tdpPosition){const n=t.calculationResults.tdpPosition.x,s=t.calculationResults.tdpPosition.y,i=Math.cos(c),a=Math.sin(c),l=m+(n*i-s*a),d=g+(n*a+s*i),p=(0,r.nB)(l,d,e.sea.waterDepth,o);this.sceneManager.add(p)}}}),this.sceneManager.updateSceneBounds({min:{x:-100,y:-100,z:-e.sea.waterDepth-50},max:{x:400,y:100,z:50}})}setView(e){this.currentView=e,this.sceneManager?.setCamera(e)}zoomToFit(){this.sceneManager?.zoomToFit()}toggleDisplayMenu(){this.displayMenuOpen.set(!this.displayMenuOpen())}toggleVisibility(e){switch(e){case"coordinates":const e=!this.showCoordinateSystems();this.showCoordinateSystems.set(e),this.globalCoordSystem&&(this.globalCoordSystem.visible=e),this.vesselCoordSystems.forEach(n=>{n.visible=e});break;case"vessel":const n=!this.showVessel();this.showVessel.set(n),this.vesselGroups.forEach(e=>{e.visible=n});break;case"connectionPoints":const t=!this.showConnectionPoints();this.showConnectionPoints.set(t),this.connectionPointGroups.forEach(e=>{e.visible=t});break;case"water":const s=!this.showWater();this.showWater.set(s),this.waterPlane&&(this.waterPlane.visible=s);break;case"seabed":const i=!this.showSeabed();this.showSeabed.set(i),this.seabedPlane&&(this.seabedPlane.visible=i);break;case"grid":const o=!this.showGrid();this.showGrid.set(o),this.gridHelper&&(this.gridHelper.visible=o)}}handleKeydown(e){const n=document.activeElement;if(!(n instanceof HTMLInputElement||n instanceof HTMLTextAreaElement))switch(e.key.toLowerCase()){case"f":this.zoomToFit();break;case"1":this.setView("iso");break;case"2":this.setView("side");break;case"3":this.setView("top");break;case"4":this.setView("front")}}};d([(0,s.ViewChild)("threeCanvas",{static:!0}),c("design:type",s.ElementRef)],p.prototype,"canvasRef",void 0),d([(0,s.ViewChild)("container",{static:!0}),c("design:type",s.ElementRef)],p.prototype,"containerRef",void 0),d([(0,s.ViewChild)("viewHelperCanvas",{static:!0}),c("design:type",s.ElementRef)],p.prototype,"viewHelperCanvasRef",void 0),p=d([(0,s.Component)({selector:"orcaflex-three-view",standalone:!0,imports:[i.CommonModule,o.FormsModule],template:'\n    <div class="three-view-container" #container>\n      <canvas #threeCanvas class="three-canvas"></canvas>\n\n      \x3c!-- ViewHelper canvas overlay --\x3e\n      <canvas #viewHelperCanvas class="view-helper-canvas" (click)="onViewHelperClick($event)"></canvas>\n\n      <div class="view-controls">\n        <button\n          [class.active]="currentView === \'iso\'"\n          (click)="setView(\'iso\')"\n          title="Isometric View"\n        >\n          3D\n        </button>\n        <button\n          [class.active]="currentView === \'side\'"\n          (click)="setView(\'side\')"\n          title="Side View"\n        >\n          Side\n        </button>\n        <button\n          [class.active]="currentView === \'top\'"\n          (click)="setView(\'top\')"\n          title="Top View"\n        >\n          Top\n        </button>\n        <button\n          [class.active]="currentView === \'front\'"\n          (click)="setView(\'front\')"\n          title="Front View"\n        >\n          Front\n        </button>\n        <button (click)="zoomToFit()" title="Zoom to Fit (F)">Fit</button>\n\n        \x3c!-- Display options dropdown --\x3e\n        <div class="dropdown">\n          <button (click)="toggleDisplayMenu()" title="Display Options">\n            View\n          </button>\n          @if (displayMenuOpen()) {\n            <div class="dropdown-menu">\n              <label class="menu-item">\n                <input type="checkbox" [checked]="showCoordinateSystems()" (change)="toggleVisibility(\'coordinates\')" />\n                <span>Coordinate Systems</span>\n              </label>\n              <label class="menu-item">\n                <input type="checkbox" [checked]="showVessel()" (change)="toggleVisibility(\'vessel\')" />\n                <span>Vessel</span>\n              </label>\n              <label class="menu-item">\n                <input type="checkbox" [checked]="showConnectionPoints()" (change)="toggleVisibility(\'connectionPoints\')" />\n                <span>Connection Points</span>\n              </label>\n              <label class="menu-item">\n                <input type="checkbox" [checked]="showWater()" (change)="toggleVisibility(\'water\')" />\n                <span>Water Surface</span>\n              </label>\n              <label class="menu-item">\n                <input type="checkbox" [checked]="showSeabed()" (change)="toggleVisibility(\'seabed\')" />\n                <span>Seabed</span>\n              </label>\n              <label class="menu-item">\n                <input type="checkbox" [checked]="showGrid()" (change)="toggleVisibility(\'grid\')" />\n                <span>Grid</span>\n              </label>\n            </div>\n          }\n        </div>\n      </div>\n    </div>\n  ',styles:["\n    :host {\n      display: block;\n      width: 100%;\n      height: 100%;\n    }\n\n    .three-view-container {\n      position: relative;\n      width: 100%;\n      height: 100%;\n    }\n\n    .three-canvas {\n      width: 100%;\n      height: 100%;\n      display: block;\n    }\n\n    .view-controls {\n      position: absolute;\n      top: 12px;\n      right: 12px;\n      display: flex;\n      gap: 4px;\n      background: rgba(255, 255, 255, 0.9);\n      padding: 4px;\n      border-radius: 4px;\n      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);\n    }\n\n    .view-controls button {\n      padding: 6px 10px;\n      border: 1px solid #ddd;\n      background: white;\n      border-radius: 3px;\n      font-size: 11px;\n      cursor: pointer;\n      transition: all 0.2s;\n    }\n\n    .view-controls button:hover {\n      background: #f0f0f0;\n    }\n\n    .view-controls button.active {\n      background: var(--caris-primary, #1976d2);\n      color: white;\n      border-color: var(--caris-primary, #1976d2);\n    }\n\n    .dropdown {\n      position: relative;\n    }\n\n    .dropdown-menu {\n      position: absolute;\n      top: 100%;\n      right: 0;\n      margin-top: 4px;\n      background: white;\n      border: 1px solid #ddd;\n      border-radius: 4px;\n      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);\n      min-width: 160px;\n      z-index: 100;\n    }\n\n    .menu-item {\n      display: flex;\n      align-items: center;\n      gap: 8px;\n      padding: 8px 12px;\n      font-size: 11px;\n      cursor: pointer;\n      user-select: none;\n      border-bottom: 1px solid #eee;\n    }\n\n    .menu-item:last-child {\n      border-bottom: none;\n    }\n\n    .menu-item:hover {\n      background: #f5f5f5;\n    }\n\n    .menu-item input {\n      cursor: pointer;\n    }\n\n    .menu-item span {\n      color: #333;\n    }\n\n    .view-helper-canvas {\n      position: absolute;\n      bottom: 12px;\n      right: 12px;\n      width: 128px;\n      height: 128px;\n      cursor: pointer;\n    }\n  "]}),c("design:paramtypes",[])],p)},4940(e,n,t){t.d(n,{f_:()=>o,nB:()=>a});var s=t(5726),i=t(2945);function o(e,n={}){const{color:t=i.D_[0],lineRadius:o=.15}=n,a=new s.Group;a.name="CatenaryCable",a.userData={type:"catenaryCable",pointCount:e.length};const r=new s.MeshBasicMaterial({color:t});for(let n=0;n<e.length-1;n++){const t=new s.Vector3(e[n].x,0,-e[n].y),i=new s.Vector3(e[n+1].x,0,-e[n+1].y),l=(new s.Vector3).subVectors(i,t).length();if(l<.001)continue;const d=new s.CylinderGeometry(o,o,l,8),c=new s.Mesh(d,r),p=(new s.Vector3).addVectors(t,i).multiplyScalar(.5);c.position.copy(p),c.lookAt(i),c.rotateX(Math.PI/2),a.add(c)}return a}function a(e,n,t,i=16771899){const o=new s.SphereGeometry(1.5,16,16),a=new s.MeshBasicMaterial({color:i}),r=new s.Mesh(o,a);return r.position.set(e,n,-t),r.userData={type:"tdpMarker",name:"Touch Down Point",position:{x:e,y:n,z:-t}},r}},5084(e,n,t){function s(e){return 9.81*-e.apparentMassInWater}function i(e){return e.numberOfModules<=0?0:1===e.numberOfModules?e.length:(e.numberOfModules-1)*e.spacing+e.length}function o(e){const n=e.numberOfModules*s(e),t=i(e);return t<=0?0:n/t}function a(e,n=1025){const t=Math.PI*Math.pow(e.outerDiameter/2,2)*n;return e.dryMass-t}function r(e,n,t=1025){return e+Math.PI*Math.pow(n/2,2)*t}function l(e){const n=Math.PI*Math.pow(e.outerDiameter/2,2)-Math.PI*Math.pow(e.innerDiameter/2,2);return n<=0?0:e.dryMass/n}function d(e,n,t){return e*(Math.PI*Math.pow(n/2,2)-Math.PI*Math.pow(t/2,2))}function c(e,n,t=1025){const s=Math.PI*Math.pow(e.innerDiameter/2,2),i=Math.PI*Math.pow(e.outerDiameter/2,2);return 9.81*e.dryMass+s*n*9.81-i*t*9.81}t.d(n,{H5:()=>l,MB:()=>i,Ny:()=>a,R9:()=>p,aW:()=>r,bl:()=>s,hY:()=>o,od:()=>d,qN:()=>u,uU:()=>c});const p=[{id:"flexible-riser",name:'10" Flexible Riser',category:"General",outerDiameter:.3556,innerDiameter:.254,dryMass:184.2262,bendingStiffness:124.87,axialStiffness:711200,torsionalStiffness:10,poissonRatio:.5,allowableTension:5e3,minBendRadius:3.675,dragCoefficients:{normal:1.2,axial:.008},addedMassCoefficients:{normal:1,axial:0}}],u={id:"buoyancy-1",name:'10" Buoyancy Module',outerDiameter:1.45,length:1.6,dryMass:855.7,apparentMassInWater:-1220,dragCoefficient:.8,numberOfModules:6,spacing:12}},5305(e,n,t){t.d(n,{r:()=>a});var s=t(4087),i=t(7493),o=t(3413);let a=class{modelState=(0,s.inject)(o.W);selectedRiser=this.modelState.selectedRiser};a=function(e,n,t,s){var i,o=arguments.length,a=o<3?n:null===s?s=Object.getOwnPropertyDescriptor(n,t):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,n,t,s);else for(var r=e.length-1;r>=0;r--)(i=e[r])&&(a=(o<3?i(a):o>3?i(n,t,a):i(n,t))||a);return o>3&&a&&Object.defineProperty(n,t,a),a}([(0,s.Component)({selector:"orcaflex-results-section",standalone:!0,imports:[i.CommonModule],template:'\n    <div class="section-content">\n      @if (selectedRiser(); as riser) {\n        @if (riser.calculationResults; as results) {\n          <div class="results-grid">\n            <div class="result-item">\n              <span class="label">Total Length</span>\n              <span class="value">{{ results.totalLength | number:\'1.1-1\' }} m</span>\n            </div>\n            <div class="result-item">\n              <span class="label">Max Tension</span>\n              <span class="value">{{ results.maxTension | number:\'1.0-0\' }} kN</span>\n            </div>\n            <div class="result-item">\n              <span class="label">Min Tension</span>\n              <span class="value">{{ results.minTension | number:\'1.0-0\' }} kN</span>\n            </div>\n            <div class="result-item">\n              <span class="label">TDP Position</span>\n              <span class="value">\n                ({{ results.tdpPosition.x | number:\'1.1-1\' }},\n                {{ results.tdpPosition.y | number:\'1.1-1\' }})\n              </span>\n            </div>\n            @if (results.sagBendRadius) {\n              <div class="result-item">\n                <span class="label">Sag Bend Radius</span>\n                <span class="value">{{ results.sagBendRadius | number:\'1.0-0\' }} m</span>\n              </div>\n            }\n            @if (results.hogBendRadius) {\n              <div class="result-item">\n                <span class="label">Hog Bend Radius</span>\n                <span class="value">{{ results.hogBendRadius | number:\'1.0-0\' }} m</span>\n              </div>\n            }\n          </div>\n\n          @if (results.segments && results.segments.length > 0) {\n            <div class="segments-section">\n              <h4>Segments</h4>\n              @for (segment of results.segments; track segment.name) {\n                <div class="segment-row">\n                  <span class="segment-name">{{ segment.name }}</span>\n                  <span class="segment-length">{{ segment.length | number:\'1.1-1\' }} m</span>\n                </div>\n              }\n            </div>\n          }\n        } @else {\n          <div class="no-results">\n            <p>No calculation results</p>\n            <p class="hint">Click "Calculate" in the Risers panel</p>\n          </div>\n        }\n      } @else {\n        <div class="no-selection">\n          Select a riser to view results\n        </div>\n      }\n    </div>\n  ',styles:["\n    .section-content {\n      padding: 8px;\n    }\n\n    .results-grid {\n      display: grid;\n      gap: 8px;\n    }\n\n    .result-item {\n      display: flex;\n      justify-content: space-between;\n      padding: 8px 12px;\n      background: var(--caris-bg-subtle, #f5f5f5);\n      border-radius: 4px;\n    }\n\n    .label {\n      font-size: 11px;\n      color: var(--caris-text-secondary, #666);\n    }\n\n    .value {\n      font-size: 12px;\n      font-weight: 500;\n      font-family: monospace;\n    }\n\n    .segments-section {\n      margin-top: 16px;\n      padding-top: 12px;\n      border-top: 1px solid var(--caris-border-light, #eee);\n    }\n\n    .segments-section h4 {\n      font-size: 11px;\n      font-weight: 600;\n      color: var(--caris-text-secondary, #666);\n      margin: 0 0 8px 0;\n      text-transform: uppercase;\n    }\n\n    .segment-row {\n      display: flex;\n      justify-content: space-between;\n      padding: 6px 8px;\n      border-bottom: 1px solid var(--caris-border-light, #eee);\n      font-size: 12px;\n    }\n\n    .segment-row:last-child {\n      border-bottom: none;\n    }\n\n    .segment-name {\n      color: var(--caris-text-primary, #333);\n    }\n\n    .segment-length {\n      color: var(--caris-text-secondary, #666);\n      font-family: monospace;\n    }\n\n    .no-results, .no-selection {\n      text-align: center;\n      padding: 24px;\n      color: var(--caris-text-secondary, #999);\n    }\n\n    .no-results p {\n      margin: 0 0 4px 0;\n      font-size: 12px;\n    }\n\n    .hint {\n      font-size: 11px;\n      color: var(--caris-text-tertiary, #bbb);\n    }\n\n    .no-selection {\n      font-size: 12px;\n    }\n  "]})],a)},6012(e,n,t){t.d(n,{X:()=>s});const s=[{id:"empty",name:"Empty (Air)",density:0,color:4886745},{id:"seawater",name:"Seawater",density:1025,color:3046706}]},6291(e,n,t){t.d(n,{$Z:()=>o.$Z,D_:()=>s.D_,Dv:()=>o.Dv,Q_:()=>o.Q_,RG:()=>o.RG,T3:()=>o.T3,f_:()=>o.f_,hl:()=>o.hl,nB:()=>o.nB,oq:()=>o.oq,sl:()=>o.sl,sr:()=>a.s,w:()=>i.w});var s=t(2945),i=t(7521),o=t(7815),a=t(2563)},7521(e,n,t){t.d(n,{w:()=>a});var s=t(5726),i=t(7024),o=t(2945);class a{scene;camera;renderer;controls;animationId=null;cameraPositions;sceneBounds;currentView="iso";constructor(){this.scene=new s.Scene,this.camera=new s.PerspectiveCamera(45,1,1,5e3),this.renderer=new s.WebGLRenderer({antialias:!0}),this.controls=null,this.cameraPositions={...o.hr},this.sceneBounds={...o.lP}}initialize(e){this.renderer=new s.WebGLRenderer({canvas:e,antialias:!0}),this.renderer.setSize(e.clientWidth,e.clientHeight),this.renderer.setPixelRatio(Math.min(window.devicePixelRatio,2)),this.renderer.shadowMap.enabled=!0,this.renderer.shadowMap.type=s.PCFSoftShadowMap,this.scene=new s.Scene,this.setupBackground();const n=e.clientWidth/e.clientHeight;this.camera=new s.PerspectiveCamera(45,n,1,5e3),this.controls=new i.N(this.camera,this.renderer.domElement),this.controls.enableDamping=!0,this.controls.dampingFactor=.05,this.controls.screenSpacePanning=!0,this.controls.minDistance=10,this.controls.maxDistance=2e3,this.setupLights(),this.setCamera("iso")}setupBackground(){const e=document.createElement("canvas");e.width=2,e.height=512;const n=e.getContext("2d"),t=n.createLinearGradient(0,0,0,512);t.addColorStop(0,"#1a237e"),t.addColorStop(.5,"#0d47a1"),t.addColorStop(1,"#01579b"),n.fillStyle=t,n.fillRect(0,0,2,512);const i=new s.CanvasTexture(e);i.magFilter=s.LinearFilter,this.scene.background=i}setupLights(){const e=new s.AmbientLight(16777215,.5);this.scene.add(e);const n=new s.DirectionalLight(16777215,.8);n.position.set(200,200,200),n.castShadow=!0,n.shadow.camera.left=-500,n.shadow.camera.right=500,n.shadow.camera.top=500,n.shadow.camera.bottom=-500,n.shadow.camera.near=.5,n.shadow.camera.far=2e3,n.shadow.mapSize.width=2048,n.shadow.mapSize.height=2048,this.scene.add(n);const t=new s.DirectionalLight(16777215,.3);t.position.set(-200,-200,100),this.scene.add(t)}setCamera(e){this.currentView=e;const n=this.cameraPositions[e];this.camera.position.set(n.position.x,n.position.y,n.position.z),this.camera.up.set(n.up.x,n.up.y,n.up.z),this.camera.lookAt(0,0,0),this.controls.target.set(0,0,0),this.controls.update(),setTimeout(()=>this.zoomToFit(),10)}zoomToFit(){const e=new s.Vector3((this.sceneBounds.max.x+this.sceneBounds.min.x)/2,(this.sceneBounds.max.y+this.sceneBounds.min.y)/2,(this.sceneBounds.max.z+this.sceneBounds.min.z)/2),n=new s.Vector3(this.sceneBounds.max.x-this.sceneBounds.min.x,this.sceneBounds.max.y-this.sceneBounds.min.y,this.sceneBounds.max.z-this.sceneBounds.min.z);this.controls.target.copy(e);const t=this.camera.aspect,i=this.camera.fov*Math.PI/180;let o;switch(this.currentView){case"top":o=1.3*Math.max(n.x/2/Math.tan(i/2)/t,n.y/2/Math.tan(i/2)),this.camera.position.set(e.x,e.y,e.z+o);break;case"front":o=1.3*Math.max(n.x/2/Math.tan(i/2)/t,n.z/2/Math.tan(i/2)),this.camera.position.set(e.x,e.y-o,e.z);break;case"side":o=1.3*Math.max(n.y/2/Math.tan(i/2)/t,n.z/2/Math.tan(i/2)),this.camera.position.set(e.x+o,e.y,e.z);break;default:o=1.4*Math.max(n.x,n.y,n.z)/(2*Math.tan(this.camera.fov*Math.PI/360));const a=(new s.Vector3).subVectors(this.camera.position,e).normalize();this.camera.position.copy(e).add(a.multiplyScalar(o))}this.camera.lookAt(e),this.controls.update()}updateSceneBounds(e){this.sceneBounds=e}onResize(){const e=this.renderer.domElement;this.camera.aspect=e.clientWidth/e.clientHeight,this.camera.updateProjectionMatrix(),this.renderer.setSize(e.clientWidth,e.clientHeight)}startRenderLoop(e){const n=()=>{this.animationId=requestAnimationFrame(n),this.controls.update(),this.renderer.render(this.scene,this.camera),e?.()};n()}stopRenderLoop(){null!==this.animationId&&(cancelAnimationFrame(this.animationId),this.animationId=null)}add(e){this.scene.add(e)}remove(e){this.scene.remove(e)}clearObjects(){const e=[];this.scene.traverse(n=>{n instanceof s.Light||n===this.scene||e.push(n)}),e.forEach(e=>{e.parent===this.scene&&this.scene.remove(e)})}getScene(){return this.scene}getCamera(){return this.camera}getRenderer(){return this.renderer}getCurrentView(){return this.currentView}getControlsTarget(){return this.controls.target}dispose(){this.stopRenderLoop(),this.controls.dispose(),this.renderer.dispose(),this.clearObjects()}}},7763(e,n,t){t.d(n,{$Z:()=>o});var s=t(5726),i=t(2945);function o(e,n={}){const{color:t=i.D_[0],normalRadius:o=.5,buoyancyStartX:r=0,buoyancyEndX:l=0,buoyancyStart:d,buoyancyEnd:c,buoyancyModule:p}=n,u=new s.Group;u.name="LazyWaveRiser",u.userData={type:"lazyWaveRiser",pointCount:e.length,buoyancySection:{start:d,end:c}};const h=new s.MeshPhongMaterial({color:t,shininess:30}),m=1.2*o,g=new s.MeshPhongMaterial({color:new s.Color(t).offsetHSL(0,.1,-.15).getHex(),shininess:40});let b,y;d&&c?(b=Math.min(d.x,c.x),y=Math.max(d.x,c.x)):(b=Math.min(r,l),y=Math.max(r,l));const f=[];for(let n=0;n<e.length-1;n++){const t=new s.Vector3(e[n].x,e[n].y,e[n].z),i=new s.Vector3(e[n+1].x,e[n+1].y,e[n+1].z),a=(t.x+i.x)/2,r=y>b&&a>=b&&a<=y,l=r?m:o,d=r?g:h;r&&(0===f.length&&f.push(e[n]),f.push(e[n+1]));const c=(new s.Vector3).subVectors(i,t).length();if(c<.001)continue;const p=new s.CylinderGeometry(l,l,c,12),v=new s.Mesh(p,d),x=(new s.Vector3).addVectors(t,i).multiplyScalar(.5);v.position.copy(x),v.lookAt(i),v.rotateX(Math.PI/2),u.add(v)}return p&&p.numberOfModules>0&&f.length>1&&function(e,n){const t=[];if(e.length<2||n.numberOfModules<=0)return t;const i=[0];for(let n=1;n<e.length;n++){const t=e[n].x-e[n-1].x,s=e[n].y-e[n-1].y,o=e[n].z-e[n-1].z;i.push(i[n-1]+Math.sqrt(t*t+s*s+o*o))}const o=i[i.length-1],r=[];for(let e=0;e<n.numberOfModules;e++){const t=e*n.spacing;t<=o&&r.push(t)}const l=new s.MeshPhongMaterial({color:16747520,shininess:60});for(const o of r){const{position:r,direction:d}=a(e,i,o),c=n.outerDiameter/2,p=new s.CylinderGeometry(c,c,n.length,16),u=new s.Mesh(p,l);if(u.position.copy(r),d.lengthSq()>1e-4){const e=r.clone().add(d);u.lookAt(e),u.rotateX(Math.PI/2)}u.userData={type:"buoyancyModule",name:"Buoyancy Module"},t.push(u)}return t}(f,p).forEach(e=>u.add(e)),u}function a(e,n,t){let i=0;for(let e=1;e<n.length;e++){if(n[e]>=t){i=e-1;break}i=e-1}const o=e[i],a=e[Math.min(i+1,e.length-1)],r=n[i],l=n[Math.min(i+1,n.length-1)]-r,d=l>0?(t-r)/l:0;return{position:new s.Vector3(o.x+d*(a.x-o.x),o.y+d*(a.y-o.y),o.z+d*(a.z-o.z)),direction:new s.Vector3(a.x-o.x,a.y-o.y,a.z-o.z).normalize()}}},7815(e,n,t){t.d(n,{$Z:()=>r.$Z,Dv:()=>l.D,Q_:()=>o.Q_,RG:()=>d.RG,T3:()=>o.T3,f_:()=>a.f_,hl:()=>i.h,nB:()=>a.nB,oq:()=>s.o,sl:()=>d.sl});var s=t(19),i=t(8118),o=t(9067),a=t(4940),r=t(7763),l=t(1019),d=t(9363)},7849(e,n,t){t.d(n,{t:()=>s});const s={id:"vessel-1",name:"FPSO",length:280,breadth:60,depth:30,draft:22,position:{x:0,y:0,z:0},orientation:{heading:0,roll:0,pitch:0},connectionPoints:[{id:"cp-1",name:"Turret Center",x:50,y:0,z:-10}]}},8003(e,n,t){t.d(n,{J:()=>g});var s=t(4087),i=t(7493),o=t(1795),a=t(5254),r=t(3437),l=t(5154),d=t(1711),c=t(1710),p=t.n(c),u=t(3413),h=function(e,n,t,s){var i,o=arguments.length,a=o<3?n:null===s?s=Object.getOwnPropertyDescriptor(n,t):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,n,t,s);else for(var r=e.length-1;r>=0;r--)(i=e[r])&&(a=(o<3?i(a):o>3?i(n,t,a):i(n,t))||a);return o>3&&a&&Object.defineProperty(n,t,a),a},m=function(e,n){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,n)};let g=class{visible=!1;visibleChange=new s.EventEmitter;generate=new s.EventEmitter;modelState=(0,s.inject)(u.W);riserSelections=(0,s.signal)([]);vesselConditions=(0,s.signal)([{id:crypto.randomUUID(),heading:25,offset:40}]);oneRiserPerModel=!1;isGenerating=(0,s.signal)(!1);generatedModels=(0,s.signal)([]);ngOnInit(){this.initializeSelections()}ngOnChanges(){this.visible&&this.initializeSelections()}initializeSelections(){const e=this.modelState.risers().map(e=>({riserId:e.id,riserName:e.name,contents:(e.contents||[]).map(e=>({contentId:e.id,contentName:e.name,selected:!0}))}));this.riserSelections.set(e),this.updateModelList()}selectAllContents(){const e=this.riserSelections();for(const n of e)for(const e of n.contents)e.selected=!0;this.riserSelections.set([...e]),this.updateModelList()}deselectAllContents(){const e=this.riserSelections();for(const n of e)for(const e of n.contents)e.selected=!1;this.riserSelections.set([...e]),this.updateModelList()}addCondition(){const e=this.vesselConditions();this.vesselConditions.set([...e,{id:crypto.randomUUID(),heading:0,offset:0}]),this.updateModelList()}removeCondition(e){const n=this.vesselConditions();n.length>1&&(n.splice(e,1),this.vesselConditions.set([...n]),this.updateModelList())}updateModelList(){const e=[],n=this.riserSelections(),t=this.vesselConditions(),s=[];for(const e of n)for(const n of e.contents)n.selected&&s.push({riserId:e.riserId,riserName:e.riserName,contentId:n.contentId,contentName:n.contentName});if(0!==s.length&&0!==t.length){for(const n of t){const t=`H${n.heading}_O${n.offset}`,i=`Heading ${n.heading}°, Offset ${n.offset}m`;if(this.oneRiserPerModel)for(const n of s){const s=`${this.sanitizeName(n.riserName)}_${this.sanitizeName(n.contentName)}_${t}`;e.push({name:s,risers:[`${n.riserName} (${n.contentName})`],condition:i})}else{const n=s.map(e=>`${e.riserName} (${e.contentName})`),o=`Model_${t}`;e.push({name:o,risers:n,condition:i})}}this.generatedModels.set(e)}else this.generatedModels.set([])}sanitizeName(e){return e.replace(/[^a-zA-Z0-9]/g,"_").replace(/_+/g,"_")}async onGenerate(){this.isGenerating.set(!0);try{const e=this.riserSelections(),n=this.vesselConditions(),t=[];for(const s of n){const n=`H${s.heading}_O${s.offset}`,i=[],o=this.modelState.risers();for(const n of e){const e=o.find(e=>e.id===n.riserId);if(e)for(const t of n.contents)if(t.selected){const n=e.contents.find(e=>e.id===t.contentId);n&&i.push({riser:e,content:n})}}if(this.oneRiserPerModel)for(const{riser:e,content:o}of i){const i=`${this.sanitizeName(e.name)}_${this.sanitizeName(o.name)}_${n}`,a=this.generateOrcaFlexYaml([{riser:e,content:o}],s);t.push({name:`${i}.yml`,content:a})}else{const e=`Model_${n}`,o=this.generateOrcaFlexYaml(i,s);t.push({name:`${e}.yml`,content:o})}}await this.downloadAsZip(t),this.modelState.addLog("success",`Generated ${t.length} OrcaFlex model(s)`),this.close()}catch(e){const n=e instanceof Error?e.message:"Unknown error";this.modelState.addLog("error",`Failed to generate models: ${n}`)}finally{this.isGenerating.set(!1)}}generateOrcaFlexYaml(e,n){const t=this.modelState.environment(),s=this.modelState.vessels(),i=this.modelState.lineTypes(),o=this.modelState.buoyancyModules(),a=[];a.push("General:"),a.push("  StageDuration:"),a.push("    - 8"),a.push("    - ~"),a.push("  TargetLogSampleInterval: 0.2"),a.push("  ImplicitConstantTimeStep: 0.02"),a.push(""),a.push("Environment:"),a.push(`  WaterDepth: ${t.sea.waterDepth}`),a.push(`  SeaDensity: ${t.sea.waterDensity}`),a.push("  WaveType: Airy"),a.push("  WaveHeight: 0"),a.push("  WavePeriod: 10"),a.push(""),a.push("LineTypes:");for(const e of i)a.push(`  - Name: ${e.name}`),a.push(`    OD: ${e.outerDiameter}`),a.push(`    ID: ${e.innerDiameter}`),a.push(`    MassPerUnitLength: ${e.dryMass}`),a.push(`    EI: ${e.bendingStiffness}`),a.push(`    EA: ${e.axialStiffness}`),a.push(`    GJ: ${e.torsionalStiffness||10}`),a.push(`    PoissonRatio: ${e.poissonRatio||.5}`),a.push(`    Cdx: ${e.dragCoefficients.axial}`),a.push(`    Cdn: ${e.dragCoefficients.normal}`),a.push(`    Cax: ${e.addedMassCoefficients.axial}`),a.push(`    Can: ${e.addedMassCoefficients.normal}`);a.push(""),a.push("Vessels:");for(const e of s){a.push(`  - Name: ${e.name}`),a.push(`    Length: ${e.length}`),a.push(`    InitialX: ${e.position.x+n.offset}`),a.push(`    InitialY: ${e.position.y}`),a.push(`    InitialZ: ${e.position.z}`),a.push(`    InitialHeading: ${e.orientation.heading+n.heading}`),a.push(`    InitialHeel: ${e.orientation.roll}`),a.push(`    InitialTrim: ${e.orientation.pitch}`),a.push("    Connection:");for(const n of e.connectionPoints)a.push(`      - Name: ${n.name}`),a.push(`        X: ${n.x}`),a.push(`        Y: ${n.y}`),a.push(`        Z: ${n.z}`)}if(a.push(""),o.length>0){a.push("BuoyancyModules:");for(const e of o)a.push(`  - Name: ${e.name}`),a.push(`    OD: ${e.outerDiameter}`),a.push(`    Length: ${e.length}`),a.push(`    Mass: ${e.dryMass}`),a.push(`    ApparentMass: ${e.apparentMassInWater}`),a.push(`    NumberOfModules: ${e.numberOfModules}`),a.push(`    Spacing: ${e.spacing}`);a.push("")}a.push("Lines:");for(const{riser:n,content:o}of e){const e=i.find(e=>e.id===n.lineTypeId),r=s.find(e=>e.id===n.vesselId),l=r?.connectionPoints.find(e=>e.id===n.connectionPointId),d=`${n.name}_${o.name}`.replace(/[^a-zA-Z0-9]/g,"_");if(a.push(`  - Name: ${d}`),a.push(`    LineType: ${e?.name||"Unknown"}`),a.push(`    ContentsDensity: ${o.density}`),a.push("    EndAConnection: Vessel"),a.push(`    EndAVessel: ${r?.name||"Unknown"}`),a.push(`    EndAConnectionPoint: ${l?.name||"CP1"}`),a.push("    EndBConnection: Anchored"),a.push(`    EndBX: ${n.calculationResults?.tdpPosition?.x||200}`),a.push("    EndBY: 0"),a.push("    EndBZ: "+-t.sea.waterDepth),"lazy-wave"===n.geometry.type){const e=n.geometry;a.push("    TargetSegmentLength: 5"),a.push("    # Lazy wave configuration"),a.push(`    # SagBend: ${e.sagBend}`),a.push(`    # HogBend: ${e.hogBend}`)}a.push(`    TotalLength: ${n.calculationResults?.totalLength||500}`)}return a.push(""),a.join("\n")}async downloadAsZip(e){const n=new(p());for(const t of e)n.file(t.name,t.content);const t=await n.generateAsync({type:"blob"}),s=`OrcaFlex_Models_${(new Date).toISOString().slice(0,10).replace(/-/g,"")}.zip`,i=URL.createObjectURL(t),o=document.createElement("a");o.href=i,o.download=s,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(i)}onCancel(){this.close()}close(){this.visible=!1,this.visibleChange.emit(!1)}};h([(0,s.Input)(),m("design:type",Object)],g.prototype,"visible",void 0),h([(0,s.Output)(),m("design:type",Object)],g.prototype,"visibleChange",void 0),h([(0,s.Output)(),m("design:type",Object)],g.prototype,"generate",void 0),g=h([(0,s.Component)({selector:"orcaflex-generate-dialog",standalone:!0,imports:[i.CommonModule,o.FormsModule,a.Ph,r.q4,l.tm,d.um],template:'\n    <p-dialog\n      header="Generate OrcaFlex Models"\n      [visible]="visible"\n      [modal]="true"\n      [closable]="true"\n      [draggable]="false"\n      [resizable]="false"\n      [style]="{ width: \'900px\', maxHeight: \'90vh\' }"\n      styleClass="generate-dialog"\n      (onHide)="onCancel()"\n    >\n      <div class="dialog-content">\n        <div class="config-panels">\n          \x3c!-- Left Panel: Riser/Content Selection --\x3e\n          <div class="panel risers-panel">\n            <div class="panel-header">\n              <span>Risers & Contents</span>\n              <div class="select-actions">\n                <button class="link-btn" (click)="selectAllContents()">Select All</button>\n                <button class="link-btn" (click)="deselectAllContents()">Deselect All</button>\n              </div>\n            </div>\n            <div class="panel-body">\n              @for (riser of riserSelections(); track riser.riserId) {\n                <div class="riser-group">\n                  <div class="riser-name">{{ riser.riserName }}</div>\n                  <div class="content-list">\n                    @for (content of riser.contents; track content.contentId) {\n                      <label class="content-item">\n                        <input\n                          type="checkbox"\n                          [(ngModel)]="content.selected"\n                          (ngModelChange)="updateModelList()"\n                        />\n                        <span class="content-name">{{ content.contentName }}</span>\n                      </label>\n                    }\n                  </div>\n                </div>\n              }\n              @if (riserSelections().length === 0) {\n                <div class="empty-state">No risers defined</div>\n              }\n            </div>\n          </div>\n\n          \x3c!-- Right Panel: Vessel Conditions --\x3e\n          <div class="panel conditions-panel">\n            <div class="panel-header">\n              <span>Vessel Conditions</span>\n              <button class="add-btn" (click)="addCondition()">+ Add</button>\n            </div>\n            <div class="panel-body">\n              <div class="conditions-table">\n                <div class="table-header">\n                  <span class="col-heading">Heading (°)</span>\n                  <span class="col-offset">Offset (m)</span>\n                  <span class="col-actions"></span>\n                </div>\n                @for (condition of vesselConditions(); track condition.id; let idx = $index) {\n                  <div class="table-row">\n                    <input\n                      type="number"\n                      class="condition-input"\n                      [(ngModel)]="condition.heading"\n                      (ngModelChange)="updateModelList()"\n                      placeholder="0"\n                    />\n                    <input\n                      type="number"\n                      class="condition-input"\n                      [(ngModel)]="condition.offset"\n                      (ngModelChange)="updateModelList()"\n                      placeholder="0"\n                    />\n                    <button\n                      class="remove-btn"\n                      (click)="removeCondition(idx)"\n                      [disabled]="vesselConditions().length <= 1"\n                    >×</button>\n                  </div>\n                }\n              </div>\n            </div>\n\n            \x3c!-- Options --\x3e\n            <div class="options-section">\n              <label class="option-item">\n                <input\n                  type="checkbox"\n                  [(ngModel)]="oneRiserPerModel"\n                  (ngModelChange)="updateModelList()"\n                />\n                <span>One riser per model</span>\n              </label>\n            </div>\n          </div>\n        </div>\n\n        \x3c!-- Model Preview --\x3e\n        <div class="model-preview">\n          <div class="preview-header">\n            <span>Models to Generate ({{ generatedModels().length }})</span>\n          </div>\n          <div class="preview-body">\n            @if (generatedModels().length > 0) {\n              <div class="model-list">\n                @for (model of generatedModels(); track model.name) {\n                  <div class="model-item">\n                    <span class="model-name">{{ model.name }}.yml</span>\n                    <span class="model-info">{{ model.risers.length }} riser(s) - {{ model.condition }}</span>\n                  </div>\n                }\n              </div>\n            } @else {\n              <div class="empty-preview">\n                Select risers and contents to generate models\n              </div>\n            }\n          </div>\n        </div>\n      </div>\n\n      <ng-template pTemplate="footer">\n        <div class="dialog-footer">\n          <div class="footer-info">\n            @if (isGenerating()) {\n              <span class="generating">Generating models...</span>\n            }\n          </div>\n          <div class="footer-actions">\n            <button class="btn-secondary" (click)="onCancel()">Cancel</button>\n            <button\n              class="btn-primary"\n              (click)="onGenerate()"\n              [disabled]="generatedModels().length === 0 || isGenerating()"\n            >\n              Generate {{ generatedModels().length }} Model{{ generatedModels().length !== 1 ? \'s\' : \'\' }}\n            </button>\n          </div>\n        </div>\n      </ng-template>\n    </p-dialog>\n  ',styles:['\n    :host ::ng-deep .generate-dialog .p-dialog {\n      background: white;\n    }\n\n    :host ::ng-deep .generate-dialog .p-dialog-header {\n      background: white;\n      border-bottom: 1px solid #eee;\n      padding: 16px 20px;\n    }\n\n    :host ::ng-deep .generate-dialog .p-dialog-content {\n      background: white;\n      padding: 20px;\n      overflow-y: auto;\n    }\n\n    :host ::ng-deep .generate-dialog .p-dialog-footer {\n      background: white;\n      border-top: 1px solid #eee;\n      padding: 16px 20px;\n    }\n\n    :host ::ng-deep .p-dialog-mask {\n      background: rgba(0, 0, 0, 0.5);\n    }\n\n    .dialog-content {\n      display: flex;\n      flex-direction: column;\n      gap: 16px;\n    }\n\n    .config-panels {\n      display: flex;\n      gap: 16px;\n    }\n\n    .panel {\n      flex: 1;\n      border: 1px solid #eee;\n      border-radius: 6px;\n      overflow: hidden;\n    }\n\n    .panel-header {\n      display: flex;\n      justify-content: space-between;\n      align-items: center;\n      padding: 10px 12px;\n      background: #fafafa;\n      border-bottom: 1px solid #eee;\n      font-size: 11px;\n      font-weight: 600;\n      text-transform: uppercase;\n      color: #666;\n    }\n\n    .select-actions {\n      display: flex;\n      gap: 8px;\n    }\n\n    .link-btn {\n      background: none;\n      border: none;\n      color: #1976d2;\n      font-size: 10px;\n      cursor: pointer;\n      text-transform: none;\n      font-weight: 500;\n    }\n\n    .link-btn:hover {\n      text-decoration: underline;\n    }\n\n    .add-btn {\n      padding: 2px 8px;\n      border: 1px solid #1976d2;\n      border-radius: 3px;\n      background: transparent;\n      color: #1976d2;\n      font-size: 10px;\n      cursor: pointer;\n      text-transform: none;\n      font-weight: 500;\n    }\n\n    .add-btn:hover {\n      background: #1976d2;\n      color: white;\n    }\n\n    .panel-body {\n      padding: 12px;\n      max-height: 200px;\n      overflow-y: auto;\n      background: white;\n    }\n\n    .riser-group {\n      margin-bottom: 12px;\n    }\n\n    .riser-group:last-child {\n      margin-bottom: 0;\n    }\n\n    .riser-name {\n      font-size: 12px;\n      font-weight: 600;\n      color: #333;\n      margin-bottom: 6px;\n    }\n\n    .content-list {\n      display: flex;\n      flex-direction: column;\n      gap: 4px;\n      padding-left: 12px;\n    }\n\n    .content-item {\n      display: flex;\n      align-items: center;\n      gap: 6px;\n      cursor: pointer;\n      font-size: 11px;\n      color: #555;\n    }\n\n    .content-item input[type="checkbox"] {\n      width: 14px;\n      height: 14px;\n      cursor: pointer;\n    }\n\n    .conditions-table {\n      display: flex;\n      flex-direction: column;\n      gap: 6px;\n    }\n\n    .table-header {\n      display: flex;\n      gap: 8px;\n      padding: 0 4px;\n      font-size: 10px;\n      font-weight: 600;\n      text-transform: uppercase;\n      color: #999;\n    }\n\n    .col-heading, .col-offset {\n      flex: 1;\n    }\n\n    .col-actions {\n      width: 24px;\n    }\n\n    .table-row {\n      display: flex;\n      gap: 8px;\n      align-items: center;\n    }\n\n    .condition-input {\n      flex: 1;\n      padding: 6px 8px;\n      border: 1px solid #ddd;\n      border-radius: 4px;\n      font-size: 12px;\n      text-align: right;\n      background: white;\n    }\n\n    .condition-input:focus {\n      outline: none;\n      border-color: #1976d2;\n    }\n\n    .remove-btn {\n      width: 24px;\n      height: 24px;\n      border: none;\n      background: transparent;\n      color: #999;\n      font-size: 16px;\n      cursor: pointer;\n      border-radius: 3px;\n    }\n\n    .remove-btn:hover:not(:disabled) {\n      background: #ffebee;\n      color: #f44336;\n    }\n\n    .remove-btn:disabled {\n      opacity: 0.3;\n      cursor: not-allowed;\n    }\n\n    .options-section {\n      padding: 12px;\n      border-top: 1px solid #eee;\n      background: white;\n    }\n\n    .option-item {\n      display: flex;\n      align-items: center;\n      gap: 8px;\n      cursor: pointer;\n      font-size: 12px;\n      color: #333;\n    }\n\n    .option-item input[type="checkbox"] {\n      width: 14px;\n      height: 14px;\n      cursor: pointer;\n    }\n\n    .model-preview {\n      border: 1px solid #eee;\n      border-radius: 6px;\n      overflow: hidden;\n    }\n\n    .preview-header {\n      padding: 10px 12px;\n      background: #fafafa;\n      border-bottom: 1px solid #eee;\n      font-size: 11px;\n      font-weight: 600;\n      text-transform: uppercase;\n      color: #666;\n    }\n\n    .preview-body {\n      max-height: 150px;\n      overflow-y: auto;\n      background: white;\n    }\n\n    .model-list {\n      padding: 8px;\n    }\n\n    .model-item {\n      display: flex;\n      justify-content: space-between;\n      align-items: center;\n      padding: 6px 8px;\n      border-radius: 4px;\n      background: #f9f9f9;\n      margin-bottom: 4px;\n    }\n\n    .model-item:last-child {\n      margin-bottom: 0;\n    }\n\n    .model-name {\n      font-size: 12px;\n      font-weight: 500;\n      color: #333;\n      font-family: monospace;\n    }\n\n    .model-info {\n      font-size: 10px;\n      color: #999;\n    }\n\n    .empty-state, .empty-preview {\n      padding: 24px;\n      text-align: center;\n      color: #999;\n      font-size: 12px;\n      font-style: italic;\n    }\n\n    .dialog-footer {\n      display: flex;\n      justify-content: space-between;\n      align-items: center;\n    }\n\n    .footer-info {\n      font-size: 12px;\n    }\n\n    .generating {\n      color: #1976d2;\n    }\n\n    .footer-actions {\n      display: flex;\n      gap: 8px;\n    }\n\n    .btn-secondary {\n      padding: 8px 16px;\n      border: 1px solid #ddd;\n      border-radius: 4px;\n      background: white;\n      font-size: 12px;\n      cursor: pointer;\n    }\n\n    .btn-secondary:hover {\n      background: #f5f5f5;\n    }\n\n    .btn-primary {\n      padding: 8px 16px;\n      border: none;\n      border-radius: 4px;\n      background: #1976d2;\n      color: white;\n      font-size: 12px;\n      cursor: pointer;\n    }\n\n    .btn-primary:hover:not(:disabled) {\n      background: #1565c0;\n    }\n\n    .btn-primary:disabled {\n      background: #ddd;\n      cursor: not-allowed;\n    }\n  ']})],g)},8118(e,n,t){t.d(n,{h:()=>o});var s=t(5726),i=t(2945);function o(e,n={}){const{size:t=2e3,addNoise:o=!0}=n,a=new s.PlaneGeometry(t,t,64,64);if(o){const e=a.attributes.position;for(let n=0;n<e.count;n++){const t=e.getZ(n);e.setZ(n,t+.5*(Math.random()-.5))}e.needsUpdate=!0,a.computeVertexNormals()}const r=new s.MeshLambertMaterial({color:i.lm.seabed,side:s.DoubleSide}),l=new s.Mesh(a,r);return l.position.set(0,0,-e),l.receiveShadow=!0,l.userData={type:"seabed",name:`Seabed at ${e}m`,depth:e},l}},8280(e,n,t){t.d(n,{U:()=>s});const s={sea:{waterDepth:100,waterDensity:1025,seabedType:"elastic",seabedFriction:.3},currentProfiles:[{depth:0,speed:.5,direction:0},{depth:100,speed:.2,direction:0}],wave:{type:"none"}}},8992(e,n,t){t.d(n,{c:()=>u});var s=t(4087),i=t(7493),o=t(1795),a=t(5254),r=t(6882),l=t(5154),d=t(1711),c=function(e,n,t,s){var i,o=arguments.length,a=o<3?n:null===s?s=Object.getOwnPropertyDescriptor(n,t):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,n,t,s);else for(var r=e.length-1;r>=0;r--)(i=e[r])&&(a=(o<3?i(a):o>3?i(n,t,a):i(n,t))||a);return o>3&&a&&Object.defineProperty(n,t,a),a},p=function(e,n){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,n)};let u=class{visible=!1;visibleChange=new s.EventEmitter;import=new s.EventEmitter;getDefaultRow(){return{name:"",outerDiameter:355.6,innerDiameter:254,dryMass:184.2,bendingStiffness:124.87,axialStiffness:711200,torsionalStiffness:10,allowableTension:5e3,minBendRadius:3.675}}rows=(0,s.signal)([this.getDefaultRow()]);handlePaste(e){e.preventDefault();const n=e.clipboardData;if(!n)return;const t=n.getData("text");if(!t)return;const s=this.parseExcelData(t);s.length>0&&this.rows.set(s)}handleKeydown(e){!e.ctrlKey&&!e.metaKey||e.key}parseExcelData(e){const n=[],t=e.trim().split("\n");for(const e of t){const t=e.split(/\t|(?:  +)/);t.length>=1&&t[0]?.trim()&&n.push({name:t[0]?.trim()||"",outerDiameter:parseFloat(t[1])||355.6,innerDiameter:parseFloat(t[2])||254,dryMass:parseFloat(t[3])||184.2,bendingStiffness:parseFloat(t[4])||124.87,axialStiffness:parseFloat(t[5])||711200,torsionalStiffness:parseFloat(t[6])||10,allowableTension:parseFloat(t[7])||5e3,minBendRadius:parseFloat(t[8])||3.675})}return n}addRow(){const e=this.rows();this.rows.set([...e,this.getDefaultRow()])}clearRows(){this.rows.set([this.getDefaultRow()])}hasValidData(){return this.rows().some(e=>""!==e.name.trim())}getValidRowCount(){return this.rows().filter(e=>""!==e.name.trim()).length}onImport(){const e=this.rows().filter(e=>""!==e.name.trim()).map(e=>({id:crypto.randomUUID(),name:e.name.trim(),outerDiameter:e.outerDiameter/1e3,innerDiameter:e.innerDiameter/1e3,dryMass:e.dryMass,bendingStiffness:e.bendingStiffness,axialStiffness:e.axialStiffness,torsionalStiffness:e.torsionalStiffness,poissonRatio:.5,allowableTension:e.allowableTension,minBendRadius:e.minBendRadius,dragCoefficients:{normal:1.2,axial:.008},addedMassCoefficients:{normal:1,axial:0}}));this.import.emit(e),this.close()}onCancel(){this.close()}close(){this.visible=!1,this.visibleChange.emit(!1),this.rows.set([this.getDefaultRow()])}};c([(0,s.Input)(),p("design:type",Object)],u.prototype,"visible",void 0),c([(0,s.Output)(),p("design:type",Object)],u.prototype,"visibleChange",void 0),c([(0,s.Output)(),p("design:type",Object)],u.prototype,"import",void 0),u=c([(0,s.Component)({selector:"orcaflex-line-types-import-dialog",standalone:!0,imports:[i.CommonModule,o.FormsModule,a.Ph,r.bG,l.tm,d.um],template:'\n    <p-dialog\n      header="Import Line Types"\n      [visible]="visible"\n      [modal]="true"\n      [closable]="true"\n      [draggable]="false"\n      [resizable]="false"\n      [style]="{ width: \'1000px\' }"\n      styleClass="import-dialog"\n      (onHide)="onCancel()"\n    >\n      <div class="dialog-content">\n        <div class="paste-instructions">\n          <p>Paste data from Excel with columns: <strong>Name, OD (mm), ID (mm), Dry Mass (kg/m), EI (kN·m²), EA (kN), GJ (kN·m²), Tension (kN), MBR (m)</strong></p>\n          <p class="hint">Click in the table and press Ctrl+V (Cmd+V on Mac) to paste</p>\n        </div>\n\n        <div\n          class="table-container"\n          tabindex="0"\n          (paste)="handlePaste($event)"\n          (keydown)="handleKeydown($event)"\n        >\n          <p-table [value]="rows()" [tableStyle]="{ \'min-width\': \'100%\' }" [scrollable]="true" scrollHeight="300px">\n            <ng-template pTemplate="header">\n              <tr>\n                <th style="width: 14%">Name</th>\n                <th style="width: 10%">OD (mm)</th>\n                <th style="width: 10%">ID (mm)</th>\n                <th style="width: 11%">Dry Mass</th>\n                <th style="width: 11%">EI (kN·m²)</th>\n                <th style="width: 11%">EA (kN)</th>\n                <th style="width: 11%">GJ (kN·m²)</th>\n                <th style="width: 11%">Tension (kN)</th>\n                <th style="width: 11%">MBR (m)</th>\n              </tr>\n            </ng-template>\n            <ng-template pTemplate="body" let-row let-rowIndex="rowIndex">\n              <tr>\n                <td>\n                  <input\n                    type="text"\n                    pInputText\n                    [(ngModel)]="row.name"\n                    placeholder="Name"\n                    class="table-input"\n                  />\n                </td>\n                <td>\n                  <input\n                    type="number"\n                    pInputText\n                    [(ngModel)]="row.outerDiameter"\n                    placeholder="355.6"\n                    class="table-input coord"\n                  />\n                </td>\n                <td>\n                  <input\n                    type="number"\n                    pInputText\n                    [(ngModel)]="row.innerDiameter"\n                    placeholder="254"\n                    class="table-input coord"\n                  />\n                </td>\n                <td>\n                  <input\n                    type="number"\n                    pInputText\n                    [(ngModel)]="row.dryMass"\n                    placeholder="184.2"\n                    class="table-input coord"\n                  />\n                </td>\n                <td>\n                  <input\n                    type="number"\n                    pInputText\n                    [(ngModel)]="row.bendingStiffness"\n                    placeholder="124.87"\n                    class="table-input coord"\n                  />\n                </td>\n                <td>\n                  <input\n                    type="number"\n                    pInputText\n                    [(ngModel)]="row.axialStiffness"\n                    placeholder="711200"\n                    class="table-input coord"\n                  />\n                </td>\n                <td>\n                  <input\n                    type="number"\n                    pInputText\n                    [(ngModel)]="row.torsionalStiffness"\n                    placeholder="10"\n                    class="table-input coord"\n                  />\n                </td>\n                <td>\n                  <input\n                    type="number"\n                    pInputText\n                    [(ngModel)]="row.allowableTension"\n                    placeholder="5000"\n                    class="table-input coord"\n                  />\n                </td>\n                <td>\n                  <input\n                    type="number"\n                    pInputText\n                    [(ngModel)]="row.minBendRadius"\n                    placeholder="3.675"\n                    class="table-input coord"\n                  />\n                </td>\n              </tr>\n            </ng-template>\n            <ng-template pTemplate="emptymessage">\n              <tr>\n                <td colspan="9" class="empty-message">\n                  Paste Excel data here or add rows manually\n                </td>\n              </tr>\n            </ng-template>\n          </p-table>\n        </div>\n\n        <div class="row-actions">\n          <button class="action-btn add" (click)="addRow()">+ Add Row</button>\n          <button class="action-btn clear" (click)="clearRows()">Clear All</button>\n        </div>\n      </div>\n\n      <ng-template pTemplate="footer">\n        <div class="dialog-footer">\n          <button class="btn-secondary" (click)="onCancel()">Cancel</button>\n          <button class="btn-primary" (click)="onImport()" [disabled]="!hasValidData()">\n            Import {{ getValidRowCount() }} Line Type{{ getValidRowCount() !== 1 ? \'s\' : \'\' }}\n          </button>\n        </div>\n      </ng-template>\n    </p-dialog>\n  ',styles:["\n    :host ::ng-deep .import-dialog .p-dialog {\n      background: white;\n    }\n\n    :host ::ng-deep .import-dialog .p-dialog-header {\n      background: white;\n      border-bottom: 1px solid #eee;\n      padding: 16px 20px;\n    }\n\n    :host ::ng-deep .import-dialog .p-dialog-content {\n      background: white;\n      padding: 20px;\n    }\n\n    :host ::ng-deep .import-dialog .p-dialog-footer {\n      background: white;\n      border-top: 1px solid #eee;\n      padding: 16px 20px;\n    }\n\n    :host ::ng-deep .p-dialog-mask {\n      background: rgba(0, 0, 0, 0.5);\n    }\n\n    .dialog-content {\n      padding: 0;\n    }\n\n    .paste-instructions {\n      margin-bottom: 16px;\n      padding: 12px;\n      background: #f5f5f5;\n      border-radius: 4px;\n    }\n\n    .paste-instructions p {\n      margin: 0;\n      font-size: 12px;\n      color: #333;\n    }\n\n    .paste-instructions .hint {\n      margin-top: 4px;\n      font-size: 11px;\n      color: #666;\n    }\n\n    .table-container {\n      border: 2px dashed #ddd;\n      border-radius: 4px;\n      padding: 4px;\n      outline: none;\n      transition: border-color 0.2s;\n      background: white;\n    }\n\n    .table-container:focus {\n      border-color: #1976d2;\n    }\n\n    :host ::ng-deep .p-datatable {\n      background: white;\n    }\n\n    :host ::ng-deep .p-datatable .p-datatable-thead > tr > th {\n      background: #fafafa;\n      font-size: 9px;\n      font-weight: 600;\n      text-transform: uppercase;\n      color: #666;\n      padding: 8px 2px;\n      border: none;\n      border-bottom: 1px solid #eee;\n    }\n\n    :host ::ng-deep .p-datatable .p-datatable-tbody > tr {\n      background: white;\n    }\n\n    :host ::ng-deep .p-datatable .p-datatable-tbody > tr > td {\n      padding: 4px 2px;\n      border: none;\n      border-bottom: 1px solid #f0f0f0;\n      background: white;\n    }\n\n    .table-input {\n      width: 100%;\n      padding: 6px 4px;\n      border: 1px solid #ddd;\n      border-radius: 4px;\n      font-size: 11px;\n      background: white;\n    }\n\n    .table-input:focus {\n      outline: none;\n      border-color: #1976d2;\n    }\n\n    .table-input.coord {\n      text-align: right;\n    }\n\n    .empty-message {\n      text-align: center;\n      padding: 24px;\n      color: #999;\n      font-style: italic;\n      background: white;\n    }\n\n    .row-actions {\n      display: flex;\n      gap: 8px;\n      margin-top: 12px;\n    }\n\n    .action-btn {\n      padding: 6px 12px;\n      border: 1px solid #ddd;\n      border-radius: 4px;\n      background: white;\n      font-size: 11px;\n      cursor: pointer;\n    }\n\n    .action-btn:hover {\n      background: #f5f5f5;\n    }\n\n    .action-btn.add {\n      color: #1976d2;\n      border-color: #1976d2;\n    }\n\n    .action-btn.clear {\n      color: #666;\n    }\n\n    .dialog-footer {\n      display: flex;\n      justify-content: flex-end;\n      gap: 8px;\n    }\n\n    .btn-secondary {\n      padding: 8px 16px;\n      border: 1px solid #ddd;\n      border-radius: 4px;\n      background: white;\n      font-size: 12px;\n      cursor: pointer;\n    }\n\n    .btn-secondary:hover {\n      background: #f5f5f5;\n    }\n\n    .btn-primary {\n      padding: 8px 16px;\n      border: none;\n      border-radius: 4px;\n      background: #1976d2;\n      color: white;\n      font-size: 12px;\n      cursor: pointer;\n    }\n\n    .btn-primary:hover:not(:disabled) {\n      background: #1565c0;\n    }\n\n    .btn-primary:disabled {\n      background: #ddd;\n      cursor: not-allowed;\n    }\n  "]})],u)},9067(e,n,t){t.d(n,{Q_:()=>o,T3:()=>a});var s=t(5726),i=t(2945);function o(e,n){const t=new s.Group;t.name="VesselGroup",t.userData={type:"vesselGroup"};const o=function(e,n={}){const{color:t=i.lm.vessel,opacity:o=1}=n,a=new s.BoxGeometry(e.length,e.breadth,e.depth),r=new s.MeshStandardMaterial({color:t,transparent:o<1,opacity:o}),l=new s.Mesh(a,r);return l.castShadow=!0,l.receiveShadow=!0,l.userData={type:"vessel",name:"Vessel",dimensions:e},l}(e);o.position.set(0,0,e.depth/2-e.draft),t.add(o);const a=new s.SphereGeometry(1,16,16),r=new s.MeshPhongMaterial({color:i.lm.vesselCOG,emissive:16716066,emissiveIntensity:.3}),l=new s.Mesh(a,r);return l.userData={type:"vesselCOG",name:"Center of Gravity"},t.add(l),t.position.set(n.x,n.y,n.z),t}function a(e,n,t=i.lm.cdp){const o=new s.Group;o.name=`ConnectionPoint-${n}`;const a=new s.SphereGeometry(2,16,16),r=new s.MeshBasicMaterial({color:t}),l=new s.Mesh(a,r);o.add(l);const d=new s.RingGeometry(2.5,3,32),c=new s.MeshBasicMaterial({color:16776960,side:s.DoubleSide}),p=new s.Mesh(d,c);p.rotation.x=Math.PI/2,o.add(p);const u=document.createElement("canvas"),h=u.getContext("2d");u.width=256,u.height=64,h.fillStyle="rgba(0, 0, 0, 0.7)",h.fillRect(0,0,u.width,u.height),h.font="Bold 32px Arial",h.textAlign="center",h.textBaseline="middle",h.fillStyle="#ffffff",h.fillText(n,u.width/2,u.height/2);const m=new s.CanvasTexture(u),g=new s.SpriteMaterial({map:m,transparent:!0}),b=new s.Sprite(g);return b.position.set(0,0,8),b.scale.set(16,4,1),o.add(b),o.position.set(e.x,e.y,e.z),o.userData={type:"connectionPoint",name:n,position:e},o}},9097(e,n,t){t.d(n,{a:()=>r});var s=t(4087),i=t(7493),o=t(1795),a=t(3413);let r=class{modelState=(0,s.inject)(a.W);environment=this.modelState.environment;expandedSubsections={sea:!0,wave:!1,current:!1};editingCurrentIdx=(0,s.signal)(null);editingDepth=0;editingSpeed=0;addingCurrent=(0,s.signal)(!1);newCurrentDepth=0;newCurrentSpeed=0;toggleSubsection(e){this.expandedSubsections[e]=!this.expandedSubsections[e]}updateWaterDepth(e){const n=this.environment();this.modelState.updateEnvironment({...n,sea:{...n.sea,waterDepth:e}})}updateWaterDensity(e){const n=this.environment();this.modelState.updateEnvironment({...n,sea:{...n.sea,waterDensity:e}})}updateSeabedFriction(e){const n=this.environment();this.modelState.updateEnvironment({...n,sea:{...n.sea,seabedFriction:e}})}updateSeabedStiffness(e){const n=this.environment();this.modelState.updateEnvironment({...n,sea:{...n.sea,seabedStiffness:e}})}updateSeabedType(e){const n=this.environment();this.modelState.updateEnvironment({...n,sea:{...n.sea,seabedType:e}})}updateWaveType(e){const n=this.environment();this.modelState.updateEnvironment({...n,wave:{...n.wave,type:e}})}updateWaveHeight(e){const n=this.environment();this.modelState.updateEnvironment({...n,wave:{...n.wave,height:e}})}updateWavePeriod(e){const n=this.environment();this.modelState.updateEnvironment({...n,wave:{...n.wave,period:e}})}updateWaveDirection(e){const n=this.environment();this.modelState.updateEnvironment({...n,wave:{...n.wave,direction:e}})}updateWaveSpectrum(e){const n=this.environment();this.modelState.updateEnvironment({...n,wave:{...n.wave,spectrum:e}})}updateWaveGamma(e){const n=this.environment();this.modelState.updateEnvironment({...n,wave:{...n.wave,gamma:e}})}startEditCurrent(e,n){this.editingCurrentIdx.set(e),this.editingDepth=n.depth,this.editingSpeed=n.speed}saveCurrentEdit(e){const n=this.environment(),t=[...n.currentProfiles];t[e]={depth:this.editingDepth,speed:this.editingSpeed,direction:t[e]?.direction??0},t.sort((e,n)=>e.depth-n.depth),this.modelState.updateEnvironment({...n,currentProfiles:t}),this.editingCurrentIdx.set(null)}cancelCurrentEdit(){this.editingCurrentIdx.set(null)}deleteCurrentProfile(e){const n=this.environment(),t=n.currentProfiles.filter((n,t)=>t!==e);this.modelState.updateEnvironment({...n,currentProfiles:t})}startAddCurrent(){this.addingCurrent.set(!0),this.newCurrentDepth=0,this.newCurrentSpeed=0}addCurrentProfile(){const e=this.environment(),n=[...e.currentProfiles,{depth:this.newCurrentDepth,speed:this.newCurrentSpeed,direction:0}];n.sort((e,n)=>e.depth-n.depth),this.modelState.updateEnvironment({...e,currentProfiles:n}),this.addingCurrent.set(!1)}cancelAddCurrent(){this.addingCurrent.set(!1)}};r=function(e,n,t,s){var i,o=arguments.length,a=o<3?n:null===s?s=Object.getOwnPropertyDescriptor(n,t):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,n,t,s);else for(var r=e.length-1;r>=0;r--)(i=e[r])&&(a=(o<3?i(a):o>3?i(n,t,a):i(n,t))||a);return o>3&&a&&Object.defineProperty(n,t,a),a}([(0,s.Component)({selector:"orcaflex-environment-section",standalone:!0,imports:[i.CommonModule,o.FormsModule],template:'\n    <div class="section-content">\n      \x3c!-- Sea Configuration --\x3e\n      <div class="subsection-header" (click)="toggleSubsection(\'sea\')">\n        <span>Sea</span>\n        <span class="toggle">{{ expandedSubsections.sea ? \'−\' : \'+\' }}</span>\n      </div>\n      @if (expandedSubsections.sea) {\n        <div class="subsection-content">\n          <div class="form-group">\n            <label>Water Depth (m)</label>\n            <input\n              type="number"\n              [ngModel]="environment().sea.waterDepth"\n              (ngModelChange)="updateWaterDepth($event)"\n              min="10"\n              max="3000"\n              step="1"\n            />\n          </div>\n\n          <div class="form-group">\n            <label>Water Density (kg/m³)</label>\n            <input\n              type="number"\n              [ngModel]="environment().sea.waterDensity"\n              (ngModelChange)="updateWaterDensity($event)"\n              min="1000"\n              max="1100"\n              step="1"\n            />\n          </div>\n\n          <div class="form-group">\n            <label>Seabed Friction</label>\n            <input\n              type="number"\n              [ngModel]="environment().sea.seabedFriction"\n              (ngModelChange)="updateSeabedFriction($event)"\n              min="0"\n              max="1"\n              step="0.05"\n            />\n          </div>\n\n          <div class="form-group">\n            <label>Seabed Stiffness (N/m/m²)</label>\n            <input\n              type="number"\n              [ngModel]="environment().sea.seabedStiffness"\n              (ngModelChange)="updateSeabedStiffness($event)"\n              min="0"\n              step="100"\n            />\n          </div>\n        </div>\n      }\n\n      \x3c!-- Wave Configuration --\x3e\n      <div class="subsection-header" (click)="toggleSubsection(\'wave\')">\n        <span>Wave</span>\n        <span class="toggle">{{ expandedSubsections.wave ? \'−\' : \'+\' }}</span>\n      </div>\n      @if (expandedSubsections.wave) {\n        <div class="subsection-content">\n          <div class="form-group">\n            <label>Wave Type</label>\n            <select\n              [ngModel]="environment().wave.type"\n              (ngModelChange)="updateWaveType($event)"\n            >\n              <option value="none">None</option>\n              <option value="airy">Airy</option>\n              <option value="dean-stream">Dean Stream</option>\n              <option value="stokes-5">Stokes 5th Order</option>\n              <option value="jonswap">JONSWAP Spectrum</option>\n            </select>\n          </div>\n\n          @if (environment().wave.type !== \'none\') {\n            <div class="form-row">\n              <div class="form-group half">\n                <label>Hs (m)</label>\n                <input\n                  type="number"\n                  [ngModel]="environment().wave.height"\n                  (ngModelChange)="updateWaveHeight($event)"\n                  min="0"\n                  max="30"\n                  step="0.5"\n                />\n              </div>\n              <div class="form-group half">\n                <label>Tp (s)</label>\n                <input\n                  type="number"\n                  [ngModel]="environment().wave.period"\n                  (ngModelChange)="updateWavePeriod($event)"\n                  min="1"\n                  max="30"\n                  step="0.5"\n                />\n              </div>\n            </div>\n\n            <div class="form-group">\n              <label>Direction (°)</label>\n              <input\n                type="number"\n                [ngModel]="environment().wave.direction"\n                (ngModelChange)="updateWaveDirection($event)"\n                min="0"\n                max="360"\n                step="5"\n              />\n            </div>\n\n            @if (environment().wave.type === \'jonswap\') {\n              <div class="form-group">\n                <label>Gamma</label>\n                <input\n                  type="number"\n                  [ngModel]="environment().wave.gamma"\n                  (ngModelChange)="updateWaveGamma($event)"\n                  min="1"\n                  max="7"\n                  step="0.1"\n                />\n              </div>\n            }\n          }\n        </div>\n      }\n\n      \x3c!-- Current Profile --\x3e\n      <div class="subsection-header" (click)="toggleSubsection(\'current\')">\n        <span>Current Profile</span>\n        <span class="toggle">{{ expandedSubsections.current ? \'−\' : \'+\' }}</span>\n      </div>\n      @if (expandedSubsections.current) {\n        <div class="subsection-content">\n          <div class="current-list">\n            @for (profile of environment().currentProfiles; track $index; let idx = $index) {\n              <div class="current-row" [class.editing]="editingCurrentIdx() === idx">\n                @if (editingCurrentIdx() === idx) {\n                  <input\n                    type="number"\n                    class="current-input depth"\n                    [(ngModel)]="editingDepth"\n                    placeholder="Depth"\n                    min="0"\n                  />\n                  <input\n                    type="number"\n                    class="current-input speed"\n                    [(ngModel)]="editingSpeed"\n                    placeholder="Speed"\n                    min="0"\n                    step="0.1"\n                  />\n                  <button class="icon-btn save" (click)="saveCurrentEdit(idx)">✓</button>\n                  <button class="icon-btn cancel" (click)="cancelCurrentEdit()">✕</button>\n                } @else {\n                  <span class="depth-val">{{ profile.depth }}m</span>\n                  <span class="speed-val">{{ profile.speed }} m/s</span>\n                  <button class="icon-btn edit" (click)="startEditCurrent(idx, profile)">✎</button>\n                  <button class="icon-btn delete" (click)="deleteCurrentProfile(idx)">×</button>\n                }\n              </div>\n            }\n          </div>\n\n          @if (addingCurrent()) {\n            <div class="current-row add-row">\n              <input\n                type="number"\n                class="current-input depth"\n                [(ngModel)]="newCurrentDepth"\n                placeholder="Depth (m)"\n                min="0"\n              />\n              <input\n                type="number"\n                class="current-input speed"\n                [(ngModel)]="newCurrentSpeed"\n                placeholder="Speed (m/s)"\n                min="0"\n                step="0.1"\n              />\n              <button class="icon-btn save" (click)="addCurrentProfile()">✓</button>\n              <button class="icon-btn cancel" (click)="cancelAddCurrent()">✕</button>\n            </div>\n          } @else {\n            <button class="add-current-btn" (click)="startAddCurrent()">\n              + Add Point\n            </button>\n          }\n        </div>\n      }\n    </div>\n  ',styles:["\n    .section-content {\n      padding: 0;\n    }\n\n    .subsection-header {\n      display: flex;\n      justify-content: space-between;\n      align-items: center;\n      padding: 8px 12px;\n      background: var(--caris-bg-subtle, #f5f5f5);\n      border-bottom: 1px solid var(--caris-border-light, #eee);\n      cursor: pointer;\n      font-size: 11px;\n      font-weight: 600;\n      text-transform: uppercase;\n      color: var(--caris-text-secondary, #666);\n    }\n\n    .subsection-header:hover {\n      background: var(--caris-bg-hover, #ebebeb);\n    }\n\n    .toggle {\n      font-weight: bold;\n    }\n\n    .subsection-content {\n      padding: 12px;\n    }\n\n    .form-group {\n      margin-bottom: 12px;\n    }\n\n    .form-group:last-child {\n      margin-bottom: 0;\n    }\n\n    .form-group label {\n      display: block;\n      font-size: 11px;\n      color: var(--caris-text-secondary, #666);\n      margin-bottom: 4px;\n    }\n\n    .form-group input,\n    .form-group select {\n      width: 100%;\n      padding: 6px 8px;\n      border: 1px solid var(--caris-border-light, #ddd);\n      border-radius: 4px;\n      font-size: 12px;\n      background: white;\n    }\n\n    .form-group input:focus,\n    .form-group select:focus {\n      outline: none;\n      border-color: var(--caris-primary, #1976d2);\n    }\n\n    .form-row {\n      display: flex;\n      gap: 8px;\n    }\n\n    .form-group.half {\n      flex: 1;\n    }\n\n    .current-list {\n      margin-bottom: 8px;\n    }\n\n    .current-row {\n      display: flex;\n      align-items: center;\n      gap: 8px;\n      padding: 4px 0;\n      font-size: 12px;\n    }\n\n    .current-row.editing,\n    .current-row.add-row {\n      padding: 6px 0;\n    }\n\n    .depth-val {\n      width: 60px;\n      color: var(--caris-text-secondary, #666);\n    }\n\n    .speed-val {\n      flex: 1;\n    }\n\n    .current-input {\n      padding: 4px 6px;\n      border: 1px solid var(--caris-border-light, #ddd);\n      border-radius: 3px;\n      font-size: 11px;\n    }\n\n    .current-input.depth {\n      width: 60px;\n    }\n\n    .current-input.speed {\n      width: 70px;\n    }\n\n    .icon-btn {\n      width: 22px;\n      height: 22px;\n      padding: 0;\n      border: none;\n      border-radius: 3px;\n      background: transparent;\n      cursor: pointer;\n      font-size: 14px;\n      line-height: 1;\n    }\n\n    .icon-btn:hover {\n      background: var(--caris-bg-hover, #f0f0f0);\n    }\n\n    .icon-btn.edit {\n      color: var(--caris-primary, #1976d2);\n    }\n\n    .icon-btn.delete {\n      color: var(--caris-error, #f44336);\n    }\n\n    .icon-btn.save {\n      color: var(--caris-success, #4caf50);\n    }\n\n    .icon-btn.cancel {\n      color: var(--caris-text-secondary, #666);\n    }\n\n    .add-current-btn {\n      width: 100%;\n      padding: 6px 12px;\n      border: 1px dashed var(--caris-border-light, #ddd);\n      border-radius: 4px;\n      background: transparent;\n      color: var(--caris-text-secondary, #666);\n      font-size: 11px;\n      cursor: pointer;\n    }\n\n    .add-current-btn:hover {\n      border-color: var(--caris-primary, #1976d2);\n      color: var(--caris-primary, #1976d2);\n    }\n  "]})],r)},9363(e,n,t){t.d(n,{RG:()=>o,sl:()=>a});var s=t(5726);function i(e={}){const{size:n=20,showLabels:t=!0}=e,i=new s.Group;i.name="CoordinateAxes",i.userData={type:"coordinateAxes"};const o=new s.Vector3(0,0,0),a=new s.Vector3(1,0,0),l=new s.ArrowHelper(a,o,n,16711680,.15*n,.08*n);l.name="X-axis",i.add(l);const d=new s.Vector3(0,1,0),c=new s.ArrowHelper(d,o,n,65280,.15*n,.08*n);c.name="Y-axis",i.add(c);const p=new s.Vector3(0,0,1),u=new s.ArrowHelper(p,o,n,35071,.15*n,.08*n);if(u.name="Z-axis",i.add(u),t){const e=r("X",16711680);e.position.set(n+3,0,0),i.add(e);const t=r("Y",65280);t.position.set(0,n+3,0),i.add(t);const s=r("Z",35071);s.position.set(0,0,n+3),i.add(s)}return i}function o(e=30){const n=i({size:e,showLabels:!0});n.name="GlobalCoordinateSystem",n.userData={type:"globalCoordinates"};const t=new s.SphereGeometry(1.5,16,16),o=new s.MeshBasicMaterial({color:16777215}),a=new s.Mesh(t,o);a.name="GlobalOrigin",n.add(a);const l=r("GLOBAL",16777215);return l.position.set(0,0,e+8),n.add(l),n}function a(e=15){const n=i({size:e,showLabels:!0});n.name="VesselCoordinateSystem",n.userData={type:"vesselCoordinates"};const t=new s.SphereGeometry(1,16,16),o=new s.MeshBasicMaterial({color:16776960}),a=new s.Mesh(t,o);a.name="VesselOrigin",n.add(a);const l=r("VESSEL",16776960);return l.position.set(0,0,e+5),n.add(l),n}function r(e,n){const t=document.createElement("canvas"),i=t.getContext("2d");t.width=128,t.height=64,i.clearRect(0,0,t.width,t.height),i.font="Bold 48px Arial",i.textAlign="center",i.textBaseline="middle";const o="#"+n.toString(16).padStart(6,"0");i.fillStyle=o,i.fillText(e,t.width/2,t.height/2);const a=new s.CanvasTexture(t),r=new s.SpriteMaterial({map:a,transparent:!0,depthTest:!1}),l=new s.Sprite(r);return l.scale.set(8,4,1),l.name=`Label-${e}`,l}}}]);
//# sourceMappingURL=858.js.map